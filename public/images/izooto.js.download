!function(o){var i={};function n(e){if(i[e])return i[e].exports;var t=i[e]={i:e,l:!1,exports:{}};return o[e].call(t.exports,t,t.exports,n),t.l=!0,t.exports}n.m=o,n.c=i,n.d=function(e,t,o){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:o})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(t,e){if(1&e&&(t=n(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var o=Object.create(null);if(n.r(o),Object.defineProperty(o,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)n.d(o,i,function(e){return t[e]}.bind(null,i));return o},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=10)}([function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(1),i=o(2),n=o(4),a=o(3),o=(s.setupPath=function(){1!=s.global.deviceType&&""!=s.notification.serviceWorkerNameMob&&(s.notification.serviceWorkerName=s.notification.serviceWorkerNameMob),s.notification.serviceWorkerPath=s.notification.domainRoot+s.notification.serviceWorkerName,s.notification.manifest=s.notification.domainRoot+s.notification.manifestName,1==s.notification.isSdkHttps&&("http:"==s.global.locationProtocol?s.notification.sourceOrigin=s.notification.sourceOrigin+s.notification.domainRoot+s.notification.htmlName:(1==s.notification.httpsNoRoot&&""!=s.notification.domainRoot||0==s.notification.httpsNoRoot)&&(s.notification.sourceOrigin=s.notification.domainRoot+s.notification.htmlName));try{var e;null==window._izootoModule&&1!=window.is_wp||(s.notification.pluginStatus=void 0!==izConfig.pluginStatus?izConfig.pluginStatus:1,1==s.notification.pluginStatus&&(e=JSON.stringify({dtype:s.global.deviceType,btype:r.Helper.getBrowserType()}),i.Storage.setStorage("bddata",e),null!=window._izootoModule&&1==window._izootoModule.isMagento?null!=(e=window._izootoModule).isSdkHttps&&1==e.isSdkHttps&&(s.notification.serviceWorkerPath="/izooto/assets/sw",s.notification.manifest="/izooto/assets/manifest",s.notification.serviceWorkerScope="/",i.Storage.setStorage("evtrk",s.notification.evtTracking)):null!=window._izootoModule&&1==window._izootoModule.isPrestashop||null!=window._izootoModule&&1==window._izootoModule.isOpencart||1==window.is_wp&&(i.Storage.setStorage("evtrk",s.notification.evtTracking),s.notification.serviceWorkerPath=s.notification.domainRoot+"/?izooto=sw",s.notification.manifest=s.notification.domainRoot+"/?izooto=manifest")))}catch(e){}},s.multiMessengerConfigHandler=function(){if(izConfig.messenger&&0<Object.keys(izConfig.messenger).length){var e,t=0;for(e in izConfig.messenger){var o=izConfig.messenger[e],i=r.Helper.stringToRegex(o.regex),n=document.location.pathname;if((0==t&&""==i||i.test(n)&&0==t)&&(s.messenger.status=null!=o.status?o.status:0,s.messenger.pageId=e.toString(),s.messenger.prompt=null!=o.promptDesign?o.promptDesign:{},s.messenger.repeatDelay=null!=o.repeatDelay?o.repeatDelay:0,""!=i))return void(t=1)}}},s.init=function(){s.brandingPartner=void 0!==izConfig.brandingPartner&&""!=izConfig.brandingPartner?izConfig.brandingPartner:s.defaultBrandingPartner,s.client=void 0!==izConfig.client?izConfig.client:r.Helper.throwError(s.brandingPartner+":: Configuration parameter not found (client)"),s.notification.sourceOrigin=void 0!==izConfig.sourceOrigin?izConfig.sourceOrigin:r.Helper.throwError(s.brandingPartner+":: Configuration parameter not found (sourceOrigin)"),s.notification.domainRoot=void 0!==izConfig.domainRoot?izConfig.domainRoot:r.Helper.throwError(s.brandingPartner+":: Configuration parameter not found (domainRoot)"),s.notification.isSdkHttps=void 0!==izConfig.isSdkHttps?izConfig.isSdkHttps:r.Helper.throwError(s.brandingPartner+":: Configuration parameter not found (isSdkHttps)"),s.notification.serviceWorkerName=void 0!==izConfig.serviceWorkerName?izConfig.serviceWorkerName:r.Helper.throwError(s.brandingPartner+":: Configuration parameter not found (serviceWorkerName)"),s.notification.manifestName=void 0!==izConfig.manifestName?izConfig.manifestName:r.Helper.throwError(s.brandingPartner+":: Configuration parameter not found (manifestName)"),s.global.browserName=r.Helper.getBrowserName(),s.global.browserType=r.Helper.getBrowserType(),s.global.deviceType=r.Helper.getDeviceType(),s.global.browserVer=r.Helper.getBrowserVersion(),s.global.browserMajorVersion=r.Helper.getBrowserMajorVersion(),s.global.os=r.Helper.getOS(),s.global.platform=r.Helper.detectPlatform(),s.notification.windowType=n.NotificationHelper.getWindowType(),s.notification.serviceWorkerPath=""+s.notification.domainRoot+s.notification.serviceWorkerName,s.notification.isAddFcm=r.Helper.checkForFcm(),!s.notification.fcmEnable&&1!=s.notification.isAddFcm||(s.notification.subscriptionType=1),void 0!==s.notification.vapidKey&&""!==s.notification.vapidKey&&(s.notification.fcmEnable=0,s.notification.subscriptionType=2),s.global.browserName==a.KeyMapper.BROWSER_SAFARI&&(s.notification.subscriptionType=3),s.ga.id=void 0!==izConfig.gaId?izConfig.gaId:"",s.ga.syncCid=void 0!==izConfig.syncGACid?izConfig.syncGACid:0,s.ga.swEvents=void 0!==izConfig.gaSwEvents?izConfig.gaSwEvents:0,1!=s.global.deviceType&&(s.notification.promptDesign=void 0!==izConfig.mobPromptDesign&&izConfig.mobPromptDesign?izConfig.mobPromptDesign:s.notification.promptDesign,s.notification.promptType=void 0!==izConfig.mobPromptFlow?izConfig.mobPromptFlow:s.notification.promptType,s.notification.optInDesignType=void 0!==izConfig.mobOptInDesignType?izConfig.mobOptInDesignType:s.notification.optInDesignType,s.notification.promptDelay=void 0!==izConfig.mobPromptDelay?izConfig.mobPromptDelay:s.notification.promptDelay,s.notification.repeatPromptDelay=void 0!==izConfig.mobRepeatPromptDelay?izConfig.mobRepeatPromptDelay:s.notification.repeatPromptDelay,s.notification.optInCloseDelay=void 0!==izConfig.mobOptInCloseDelay?izConfig.mobOptInCloseDelay:s.notification.optInCloseDelay,s.notification.promptOnScroll=void 0!==izConfig.mobPromptOnScroll?izConfig.mobPromptOnScroll:0,s.notification.isTriggeredOnScoll=0),s.notification.promptDesign.poweredbysrc="https://www.izooto.com/getting-started-with-izooto?utm_source=referral&utm_medium=PoweredBy&utm_campaign="+encodeURIComponent(s.notification.siteUrl),s.brandingPartner!=s.defaultBrandingPartner&&(s.notification.promptDesign.poweredbysrc="javascript:void(0);"),s.notification.promptDesign.message=s.notification.promptDesign.message?s.notification.promptDesign.message:"Click on allow to subscribe to notifications",s.notification.promptDesign.subMessage=s.notification.promptDesign.subMessage?s.notification.promptDesign.subMessage:"Stay updated with the latest happenings on our site",s.notification.promptDesign.icon=s.notification.promptDesign.icon?s.notification.promptDesign.icon:"https://cdnimg.izooto.com/icons/7/bell-icon.png",s.notification.promptDesign.btn1Txt=s.notification.promptDesign.btn1Txt?s.notification.promptDesign.btn1Txt:"Later",s.notification.promptDesign.btn2Txt=s.notification.promptDesign.btn2Txt?s.notification.promptDesign.btn2Txt:"Allow",s.notification.promptDesign.position=s.notification.promptDesign.position?s.notification.promptDesign.position:"right",s.notification.promptDesign.bgColor=s.notification.promptDesign.bgColor?s.notification.promptDesign.bgColor:"#fff",s.notification.promptDesign.titleForeColor=s.notification.promptDesign.titleForeColor?s.notification.promptDesign.titleForeColor:"#000000",s.notification.promptDesign.messageForeColor=s.notification.promptDesign.messageForeColor?s.notification.promptDesign.messageForeColor:"#999999",s.notification.promptDesign.btn1bgColor=s.notification.promptDesign.btn1bgColor?s.notification.promptDesign.btn1bgColor:"#e4e4e4",s.notification.promptDesign.btn1ForeColor=s.notification.promptDesign.btn1ForeColor?s.notification.promptDesign.btn1ForeColor:"#686868",s.notification.promptDesign.btn2bgColor=s.notification.promptDesign.btn2bgColor?s.notification.promptDesign.btn2bgColor:"#1194ff",s.notification.promptDesign.btn2ForeColor=s.notification.promptDesign.btn2ForeColor?s.notification.promptDesign.btn2ForeColor:"#ffffff",s.notification.httpsOverlay="<style>.iz-branding{color:white;font-size:25px;position:absolute;top:40%;left:28%;z-index:999999!important;width:50%!important}.iz-arrow img{transform:rotate(180deg)}@media screen and (max-width:600px){#izooto_desktop_overlay{display:none;.iz-arrow{width:100%;position:fixed;top:auto;bottom:35%;left:65%;border-radius:0px}.moz-transfer{width:100%;position:fixed;top:auto;bottom:30%;left:65% !important;border-radius:0px}.moz-transfer img{transform:rotate(180deg) !important}.iz-arrow img{transform:rotate(0deg)}.iz-branding{color:white;font-size:larger;position:fixed;top:40%;left:17%;width:100%}}</style><div id='izooto_desktop_overlay' onclick='_izooto.closeHttpsBranding();' style='z-index: 999999999;position: fixed;height: 100%;top: 0px;left: 0px;width: 100%;background: rgba(0, 0, 0, 0.89);'><div class='izoverlay-container'><div class='iz-branding'><div class='iz-text' style='padding-bottom:5px; font-family:Arial; display: -webkit-box; -webkit-line-clamp: 2; text-overflow: ellipsis; overflow: hidden; word-wrap: break-word; -webkit-box-orient: vertical;'>"+s.notification.overlayMessage+"</div><div class='iz-powered-text'><a class='izbranding' href='"+s.notification.promptDesign.poweredbysrc+"' target='_blank' style='cursor: pointer !important;color:#fff!important;font-size: 12px;font-family: Arial;letter-spacing: 0.4px;text-decoration: none;'><span style='color: #9c9c9c;'>Powered by</span> <span>"+s.brandingPartner+"</span></a></div></div></div>",s.notification.httpsBranding="<style>html[dir='rtl'] .iz-branding {direction: ltr;} .iz-branding {z-index: 2147483647;background: #000;opacity: .65;box-shadow: 0px 1px 4px rgba(0, 0, 0, 0.27);border-radius: 2px 0px 0px 2px;letter-spacing: 0.04em;padding: 6px 15px;display: flex;flex-direction: row;align-items: center;justify-content: center;max-width: fit-content;position: fixed;top: 0;right: 0;}.iz-branding .iz-text {font-size: 12px;font-family: Arial;letter-spacing: 0.04em;color: rgb(255 255 255 / 90%);display: flex;flex-direction: row;align-items: center;justify-content: center;}.iz-branding a .iz-brand {font-size: 12px;font-family: Arial;letter-spacing: 0.04em;color: #fff;font-weight:bold;}</style><div class='iz-branding'><div class='iz-text'>Notifications Powered by&nbsp;<a href='"+s.notification.promptDesign.poweredbysrc+"' target='_blank' style='text-decoration: none;color: unset;'><span class='iz-brand'>"+s.brandingPartner+"</span></a></div></div>",s.setupPath(),s.multiMessengerConfigHandler(),s.notification.gdprPromptStatus=void 0!==s.notification.gdprPrompt.status?s.notification.gdprPrompt.status:0,s.notification.manifest=s.notification.domainRoot+s.notification.manifestName;var e=void 0!==izConfig.welcomeNotification&&""!==izConfig.welcomeNotification?izConfig.welcomeNotification:{};s.notification.welcomeNotification.status=void 0!==e.status?e.status:0,s.notification.welcomeNotification.title=void 0!==e.title?e.title:"",s.notification.welcomeNotification.body=void 0!==e.body?e.body:"",s.notification.welcomeNotification.icon=void 0!==e.icon?e.icon:"",s.notification.welcomeNotification.url=void 0!==e.url?e.url:"",s.notification.welcomeNotification.showAfter=void 0!==e.showAfter?e.showAfter:0,s.notification.welcomeNotification.timeout=void 0!==e.clickTimeout?e.clickTimeout:0;e=void 0!==izConfig.videoPlaybook&&""!==izConfig.videoPlaybook?izConfig.videoPlaybook:{};s.videoDropoff.status=void 0!==e.status&&""!==e.status?e.status:0,s.videoDropoff.allowedUrls=void 0!==e.allowedUrls?e.allowedUrls:[];e=void 0!==izConfig.welcomePlaybook&&""!==izConfig.welcomePlaybook?izConfig.welcomePlaybook:{};s.welcomePlaybook.status=void 0!==e.status&&""!==e.status?e.status:0,s.welcomePlaybook.data=void 0!==e.data&&""!==e.data?e.data:{};e=void 0!==izConfig.recommendArticle&&""!==izConfig.recommendArticle?izConfig.recommendArticle:{};s.recommendArticle.status=void 0!==e.status&&""!==e.status?e.status:0,(s.tabAbandonment=void 0!==izConfig.tabAbandonment&&""!==izConfig.tabAbandonment?izConfig.tabAbandonment:{}).status=null!=s.tabAbandonment.status?s.tabAbandonment.status:0,s.tabAbandonment.timeout=null!=s.tabAbandonment.timeout?s.tabAbandonment.timeout:600,s.tabAbandonment.pushTimeout=null!=s.tabAbandonment.pushTimeout?s.tabAbandonment.pushTimeout:3600,s.tabAbandonment.data=void 0!==s.tabAbandonment.data&&""!==s.tabAbandonment.data?s.tabAbandonment.data:{},(!s.notification.mobileAllowed&&1!=s.global.deviceType||!s.notification.desktopAllowed&&1==s.global.deviceType)&&(s.izootoStatus=0),n.NotificationHelper.applyBrowserPatch()},s.izootoStatus=void 0!==izConfig.izootoStatus?izConfig.izootoStatus:1,s.defaultBrandingPartner="iZooto",s.debug=void 0!==izConfig.debug?izConfig.debug:0,s.global={isSessionHandled:!1,locationProtocol:document.location.protocol,msgReceiverExist:0,cookieDomain:void 0!==izConfig.cDomain?izConfig.cDomain:"",cookieExpiryDays:1500,cookieSameSite:"SameSite=Lax;",browserName:"",browserType:0,deviceType:0,browserVer:"",browserMajorVersion:0,os:0,platform:"",isFrame:window.top!=window.self},s.debugger={status:0,err:0,successCode:"color: #228B22",errCode:"color: #FF0000",infoCode:"background: #ffffcc, color: #222",gcmValidator:"https://api.izooto.com/validate-gcm/",host:document.location.protocol+"//"+document.location.hostname},s.store={subscriberId:!1,syncedEventList:[],isNotificationDisabledManually:!1,syncedSegments:[],isSoftSubscribeTriggered:!1,isTriggerPromptWithDelay:!1,subDomainPermissionStatus:void 0,isNotificationCalledManually:!1,isMDSyncingRequired:!1,isSubscriptionLost:!1,subscriptionBasedEventNameList:["event","trigger","userProfile","personalizationProperty","add_property"]},s.notification={tokenExpire:void 0!==izConfig.tokenExpire?izConfig.tokenExpire:86400,repeatPromptDelay:void 0!==izConfig.repeatPromptDelay?izConfig.repeatPromptDelay:0,optInCloseDelay:void 0!==izConfig.optInCloseDelay?izConfig.optInCloseDelay:60,sourceOrigin:"",domainRoot:"",isSdkHttps:void 0,serviceWorkerName:"",htmlName:void 0!==izConfig.htmlName&&""!=izConfig.htmlName?izConfig.htmlName:"/izooto.html",manifestName:"",manifest:"",subscriptionType:0,fcmToken:"",autoPrompt:!0,branding:void 0!==izConfig.branding?izConfig.branding:1,httpsBranding:"",overlay:void 0!==izConfig.overlay?izConfig.overlay:0,overlayMessage:void 0!==izConfig.overlayMessage?izConfig.overlayMessage:"Click on 'allow' to subscribe to notifications",httpsOverlay:"",clickOnAllowMsg:void 0!==izConfig.clickOnAllowMsg&&""!==izConfig.clickOnAllowMsg?izConfig.clickOnAllowMsg:"Click On allow to subscribe to notifications",subscribedMsg:null!=izConfig.subscribedMsg&&""!==izConfig.subscribedMsg?izConfig.subscribedMsg:"Subscribed",alreadySubscribedMsg:void 0!==izConfig.alreadySubscribedMsg&&""!==izConfig.alreadySubscribedMsg?izConfig.alreadySubscribedMsg:"You've already subscribed to notifications.",blockedMsg:void 0!==izConfig.blockedMsg&&""!==izConfig.blockedMsg?izConfig.blockedMsg:"Blocked",alreadyDeniedMsg:void 0!==izConfig.alreadyDeniedMsg&&""!==izConfig.alreadyDeniedMsg?izConfig.alreadyDeniedMsg:"You've blocked notifications from this site.",httpsNoRoot:void 0!==izConfig.httpsNoRoot?izConfig.httpsNoRoot:0,windowType:0,mobileAllowed:void 0!==izConfig.mobileAllowed?izConfig.mobileAllowed:1,desktopAllowed:void 0!==izConfig.desktopAllowed?izConfig.desktopAllowed:1,allowedKeys:["bookingurl","landingurl"],webPushId:void 0!==izConfig.webPushId?izConfig.webPushId:"",webServiceUrl:void 0!==izConfig.webServiceUrl?izConfig.webServiceUrl:"",processPriority:void 0!==izConfig.processPriority?izConfig.processPriority:0,masterDomain:void 0!==izConfig.masterDomain?izConfig.masterDomain:"",masterDomainPath:void 0!==izConfig.masterDomainPath?izConfig.masterDomainPath:"",cdnHost:"cdn.izooto.com",siteUrl:void 0!==izConfig.siteUrl?izConfig.siteUrl:"",promptDelay:void 0!==izConfig.promptDelay?izConfig.promptDelay:0,promptType:void 0!==izConfig.promptFlow?izConfig.promptFlow:0,defaultOptinDesign:"",hidePopup:void 0===izConfig.hidePopup||izConfig.hidePopup,fullPopUp:void 0!==izConfig.fullPopUp?izConfig.fullPopUp:0,promptDesign:void 0!==izConfig.promptDesign?izConfig.promptDesign:{message:void 0,subMessage:void 0,icon:void 0,btn1Txt:void 0,btn2Txt:void 0,position:void 0,bgColor:void 0,titleForeColor:void 0,messageForeColor:void 0,btn1bgColor:void 0,btn1ForeColor:void 0,btn2bgColor:void 0,btn2ForeColor:void 0},optInDesign:void 0!==izConfig.optInDesign&&""!=izConfig.optInDesign?izConfig.optInDesign:"",dialogDesign:"",optInSrc:"https://cdn.izooto.com/optin/",optInDesignType:void 0!==izConfig.optInDesignType?izConfig.optInDesignType:"1",optinModule:{optinType:1,data:""},sourceOriginAlt:void 0!==izConfig.sourceOriginAlt?izConfig.sourceOriginAlt:"",fcmEnable:void 0!==izConfig.fcmEnable?izConfig.fcmEnable:0,isAddFcm:0,allowedDomain:void 0!==izConfig.allowedDomain?izConfig.allowedDomain:"",serviceWorkerPath:"",serviceWorkerScope:void 0!==izConfig.swScope?izConfig.swScope:"",serviceWorkerNameMob:void 0!==izConfig.serviceWorkerNameMob?izConfig.serviceWorkerNameMob:"",vapidKey:void 0!==izConfig.vapidPublicKey&&""!==izConfig.vapidPublicKey?izConfig.vapidPublicKey:"BDOU99-h67HcA6JeFXHbSNMu7e2yNNu3RzoMj8TM4W88jITfq7ZmPvIM1Iv-4_l2LxQcYwhqby2xGpWwzjfAnG4",subscriptionObj:{},pluginStatus:void 0,isShopify:void 0!==izConfig.isShopify?izConfig.isShopify:0,gdprPrompt:void 0!==izConfig.gdprPrompt?izConfig.gdprPrompt:{},gdprPromptStatus:void 0,gdprNotAllowed:["userProfile","personalizationProperty","trigger","event"],isGdprAllowed:1,sysEvents:void 0!==izConfig.sysEvents?izConfig.sysEvents:1,sysEventsFlag:void 0!==izConfig.sysEvents?1:0,propsTracking:void 0!==izConfig.propsTracking?izConfig.propsTracking:1,evtTracking:void 0!==izConfig.evtTracking?izConfig.evtTracking:1,syncLimit:{evtPerDay:void 0!==izConfig.evtPerDay?izConfig.evtPerDay:1e4,propsPerDay:void 0!==izConfig.propsPerDay?izConfig.propsPerDay:1e4,evtPerMonth:void 0!==izConfig.evtPerMonth?izConfig.evtPerMonth:1e4,propsPerMonth:void 0!==izConfig.propsPerMonth?izConfig.propsPerMonth:1e4},isTagsEnabled:void 0!==izConfig.tagsEnabled?izConfig.tagsEnabled:0,utmKeys:["utm_content","utm_medium","utm_source","utm_campaign","utm_term"],shortutmKeys:["uco","ume","uso","uca","ute"],serviceWorkerVersion:void 0,promptOnScroll:void 0!==izConfig.promptOnScroll?izConfig.promptOnScroll:0,isTriggeredOnScoll:0,eventAsTrigger:void 0!==izConfig.eventAsTrigger?izConfig.eventAsTrigger:0,eventsToSync:void 0!==(null===(o=izConfig.webPush)||void 0===o?void 0:o.syncEvent)?izConfig.webPush.syncEvent:[],welcomeNotification:{status:void 0,title:void 0,body:void 0,icon:void 0,url:void 0,showAfter:void 0,timeout:void 0},syncNotificationView:void 0!==izConfig.syncNotificationView?izConfig.syncNotificationView:"",syncNotificationClick:void 0!==izConfig.syncNotificationClick?izConfig.syncNotificationClick:"",syncVisitType:void 0!==izConfig.syncVisitType?izConfig.syncVisitType:0},s.ga={id:"",syncCid:0,swEvents:0,subscriptionCallback:[],promptDisplayCallback:[]},s.messenger={syncPrompt:null!=(null===(o=izConfig.messengerConf)||void 0===o?void 0:o.syncPrompt)?izConfig.messengerConf.syncPrompt:1,status:null!=izConfig.messengerPromptStatus?izConfig.messengerPromptStatus:0,pageId:null!=izConfig.messengerPageId?izConfig.messengerPageId:"",repeatDelay:null!=izConfig.messengerRepeatDelay?izConfig.messengerRepeatDelay:0,prompt:null!=izConfig.messengerPrompt?izConfig.messengerPrompt:{},autoPrompt:!0},s.tabAbandonment={status:void 0,timeout:void 0,pushTimeout:void 0,data:void 0,counter:0},s.welcomePlaybook={status:void 0,data:{}},s.videoDropoff={status:void 0,allowedUrls:[]},s.CRPSPlaybook={isPaidSubscriber:!1,status:null!=izConfig.CRPSPlaybook?izConfig.CRPSPlaybook:0,startTriggerName:"multiple_recent_sessions"},s.recommendArticle={status:void 0},s.autoSegmentStatus=void 0!==izConfig.autoSegment?izConfig.autoSegment:0,s.hashFileName=void 0!==izConfig.hash?izConfig.hash:"",s);function s(){}t.Config=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=o(0),s=o(3),i=o(2),a=o(5),c=o(4),o=(p.checkBrowser=function(){navigator.appVersion;var e,t=navigator.userAgent.toLowerCase(),o=navigator.appName,i=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10),r=0,a="",r=-1!=(e=t.indexOf("opr/"))?(o=s.KeyMapper.BROWSER_OPERA,i=t.substring(e+4),4):-1!=(e=t.indexOf("opera"))?(o=s.KeyMapper.BROWSER_OPERA,i=t.substring(e+6),-1!=(e=t.indexOf("version"))&&(i=t.substring(e+8)),4):-1!=(e=t.indexOf("edge/"))||-1!=(e=t.indexOf("edga/"))?(o=s.KeyMapper.BROWSER_EDGE,i=t.substring(e+5),7):-1!=(e=t.indexOf("edgios/"))?(o="Edge",i=t.substring(e+7),7):-1!=(e=t.indexOf("edg/"))?(o="Edge",i=t.substring(e+4),7):-1!=(e=t.indexOf("ucbrowser"))?(o=s.KeyMapper.BROWSER_UCB,i=t.substring(e+10),6):-1!=(e=t.indexOf("msie"))?(o=s.KeyMapper.BROWSER_IE,i=t.substring(e+5),5):-1!=(e=t.indexOf("crios"))?(o=s.KeyMapper.BROWSER_OTHER,i=t.substring(e+6),i=a="40",5):-1!=(e=t.indexOf("chrome"))?(o=s.KeyMapper.BROWSER_CHROME,i=t.substring(e+7),/(.*?)wv\)/.test(t)&&(o=s.KeyMapper.BROWSER_OTHER,i=a="41"),1):-1!=(e=t.indexOf("safari"))&&(/mac/.test(t)||/ipad|iphone|ipod/.test(t))?(o=s.KeyMapper.BROWSER_SAFARI,i=t.substring(e+7),-1!=(e=t.indexOf("version"))&&(i=t.substring(e+8)),2):-1!=(e=t.indexOf("firefox"))?(o=s.KeyMapper.BROWSER_FIREFOX,i=t.substring(e+8),3):(o=s.KeyMapper.BROWSER_OTHER,i="1",5);return-1!=(e=i.indexOf(";"))&&(i=i.substring(0,e)),-1!=(e=i.indexOf(" "))&&(i=i.substring(0,e)),n=parseInt(""+i,10),isNaN(n)&&(i=""+parseFloat(navigator.appVersion),n=parseInt(navigator.appVersion,10)),"40"!=a&&"41"!=a||(n=a),[o,n,i,r]},p.getBrowserName=function(){return this.checkBrowser()[0]},p.getBrowserVersion=function(){return this.checkBrowser()[2]},p.getBrowserMajorVersion=function(){return this.checkBrowser()[1]},p.getBrowserType=function(){return this.checkBrowser()[3]},p.isTablet=function(e){if(/android/.test(e)){if(!1===/mobile/.test(e))return!0}else if(!0===/ipad/.test(e))return!0;return!1},p.isMobile=function(){return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows (ce|phone)|xda|xiino|android|ipad|playbook|silk/i.test(navigator.userAgent||navigator.vendor||window.opera)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test((navigator.userAgent||navigator.vendor||window.opera).substr(0,4))},p.getDeviceType=function(){var e=(e=navigator.userAgent).toLowerCase();return this.isTablet(e)?2:this.isMobile()?3:1},p.getOS=function(){var e=navigator.userAgent.toLowerCase();return/windows phone/i.test(e)?6:/android/i.test(e)?4:/ipad|iphone|ipod/.test(e)&&!window.MSStream?5:/linux/i.test(e)?2:/macintosh|mac os x/i.test(e)?3:/windows|win32/i.test(e)?1:7},p.detectPlatform=function(){var e="";return 1==window.is_wp?e="wordpress":1==r.Config.notification.isShopify?e="shopify":null!=window._izootoModule&&1==window._izootoModule.isMagento?e="magento":null!=window._izootoModule&&1==window._izootoModule.isOpencart&&(e="opencart"),e},p.getMetaValue=function(e){try{for(var t=document.getElementsByTagName("meta"),o=0;o<t.length;o++)if(t[o].getAttribute("name")===e||t[o].getAttribute("property")===e)return t[o].getAttribute("content")}catch(e){}return""},p.endPointParamExtract=function(e){var t=e,o="";try{o=JSON.parse(t).endpoint}catch(e){}return r.Config.global.browserName==s.KeyMapper.BROWSER_EDGE&&(o=encodeURIComponent(o)),"ep="+o},p.getEndpoint=function(e){var t={SoftUnsubscribe:["usub","sunsub"],SoftSubscribe:["usub","sunsub"],NotImplemented:["ni","nimp"],SegmentEvents:["et","evt"],SegmentProperties:["prp","prp"],TriggerEvent:["trg","trg"],PersonalProperties:["pp","pprp"],CustomerIDSynch:["pp","idsyn"],CustomerIDLogout:["pp","clout"],last_visit:["lvi","lvi"],Visitor:["viz","viz"],ShopifyMapper:["oth","spm"],GDPRConsent:["prv","gdp"],FCMMigration:["enu","enu"],syncAdNetwork:["cs","cs"],syncNotificationView:["imp","wimp"],syncAllSubscribersVisit:["viz","viz"],syncMessenger:["msngenr","msngenr"],getUUIDFromEp:["uuid","uuid"],gdprLocationUrl:["rapi",""],gdprStatusUrl:["prv","gdp"],shopifyAPI:["events","shopifywh1.php"],subscriptionValidator:["ss","ss.php"],supUrl:["evt","sup.php"],messengerPrompted:["msngp","msngp"],notificationSent:["snt","snt"]};return t[s.KeyMapper.IZOOTO_PROMPT_ALLOWED]=["enp","enp"],t[s.KeyMapper.IZOOTO_ALREADY_GRANTED]=["enp","enp"],t[s.KeyMapper.IZOOTO_PROMPT_CLOSED]=["sbp","ncls"],t[s.KeyMapper.IZOOTO_OPTIN_ALLOWED]=["sbp","salw"],t[s.KeyMapper.IZOOTO_PROMPT_DENIED]=["sbp","nblk"],t[s.KeyMapper.IZOOTO_ALREADY_DENIED]=["sbp","nblk"],t[s.KeyMapper.IZOOTO_OPTIN_CLOSED]=["sbp","sblk"],t[s.KeyMapper.IZOOTO_POPUP_CLOSED]=["sbp","swc"],t[s.KeyMapper.IZOOTO_PROMPTED]=["sbpd","npd"],t[s.KeyMapper.IZOOTO_OPTIN_SHOWN]=["sbpd","spd"],t[s.KeyMapper.IZOOTO_BROWSER_UNSUPPORTED]=["na","nsp"],t.hasOwnProperty(e)?"https://"+t[e][0]+".izooto.com/"+t[e][1]:"https://err.izooto.com/err"},p.getTimeDiff=function(e,t){if(!e)return 0;e=(e-(new Date).getTime())/1e3;return null!=t&&0!=t||(e/=60),Math.abs(Math.round(e))},p.urlB64ToUint8Array=function(e){for(var e=(e+"=".repeat((4-e.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),t=window.atob(e),o=new Uint8Array(t.length),i=0;i<t.length;++i)o[i]=t.charCodeAt(i);return o},p.getLanguage=function(){var e=document.documentElement.lang;if(""==e)try{for(var t=document.getElementsByTagName("meta"),o=0;o<t.length;o++)"content-language"==t[o].getAttribute("http-equiv")&&(e=t[o].getAttribute("content"))}catch(e){}return e},p.displayLog=function(e,t){e=window.top!=window.self?r.Config.brandingPartner+" Iframe: => "+e:r.Config.brandingPartner+" => "+e,1===r.Config.debug&&(void 0!==t?console.log(e,t):console.log(e))},p.throwError=function(e){throw new Error(e)},p.getParamFromUrl=function(e,t){return new URL(e).searchParams.get(t)},p.izParseQuery=function(e){for(var t={},o=("?"===e[0]?e.substr(1):e).split("&"),i=0;i<o.length;i++){var n=o[i].split("=");t[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")}return t},p.getUTMParamsOfUrl=function(e){try{void 0===e&&(e=window.location.href);var t=e.indexOf("?");if(0<t){var t=e.substring(t+1),i=p.izParseQuery(t),n={};return 2<r.Config.notification.utmKeys.map(function(e,t){var o=i.hasOwnProperty(e);return o&&(""==e&&null==e||(n[r.Config.notification.shortutmKeys[t]]=i[e])),o}).reduce(function(e,t,o){return t?e+1:e})&&p.getQuerySting(n)}return!1}catch(e){return!1}},p.getQuerySting=function(e){try{var t,o=[];for(t in e)e.hasOwnProperty(t)&&o.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return o.join("&")}catch(e){}},p.objToParam=function(t){var e="";try{e=Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")}catch(e){}return e},p.addMsgReciever=function(t,e){if(void 0===e&&(e=!1),1!=r.Config.global.msgReceiverExist||e){e||(r.Config.global.msgReceiverExist=1);try{p.displayLog("Message Listner Added",e),window.addEventListener("message",function(e){(-1<e.origin.indexOf(window.location.host)||"https://cdn.izooto.com"==e.origin||-1<e.origin.indexOf(r.Config.notification.sourceOrigin)||-1<e.origin.indexOf(r.Config.notification.sourceOriginAlt)||-1<e.origin.indexOf(r.Config.notification.siteUrl)||-1<r.Config.notification.masterDomain.indexOf(e.origin)||3==r.Config.notification.windowType)&&e.data&&t(e)})}catch(e){}}},p.postMessage=function(e,t,o,i){try{var n,r;null!=typeof e&&null!=t&&((n={})[t]=void 0!==o?o:1,null!=i&&p.displayLog("Service Worker Version",i),n.serviceWorkerVersion=i,(r={})[s.KeyMapper.IZOOTO_MESSAGE]=n,p.postToTargetedWindow(e,r),p.postToTargetedWindow(e,{izootoMsg:{k:t,v:void 0!==o?o:1}}))}catch(e){}},p.postToTargetedWindow=function(e,t){p.displayLog("Posting message to "+e+" window : ",t);try{"parent"===e?window.parent.postMessage(JSON.stringify(t),"*"):"opener"===e?window.opener&&window.opener.postMessage(JSON.stringify(t),"*"):e.contentWindow.postMessage(JSON.stringify(t),"*")}catch(e){}},p.addHTML=function(e,t,o){try{var i=document.getElementsByTagName("body")[0],n=document.createElement(e);return n.setAttribute("id",o||""),n.innerHTML=t,i.appendChild(n),!0}catch(e){p.displayLog("Could't add HTML : ",e)}},p.addExternalJS=function(i,n,r){return new Promise(function(e,t){var o=document.createElement("script");o.onload=e,o.onerror=t,o.async=r||!1,o.id=n||"",o.src=i,(document.body?document.body:document.head).appendChild(o)})},p.checkForFcm=function(){var e=p.getBrowserMajorVersion(),t=p.getBrowserName();return t==s.KeyMapper.BROWSER_UCB&&12<=e||t==s.KeyMapper.BROWSER_OPERA&&42<=e||t==s.KeyMapper.BROWSER_EDGE&&17<=e?1:0},p.isJSONString=function(e){try{JSON.parse(e)}catch(e){return!1}return!0},p.parseToJSON=function(e){try{return JSON.parse(e)}catch(e){return!1}},p.stringToRegex=function(e,t){var o="";return"object"==typeof e&&0<Object.keys(e).length&&(o=1<Object.keys(e).length?new RegExp(e[0],e[1]):new RegExp(e[0])),o},p.getParsedMethod=function(e){try{return new Function("return "+atob(e))()}catch(e){p.displayLog("Error while parsing custom module")}},p.getDateDiffrenceFromPresent=function(e){try{var t=new Date(e),o=new Date,t=t.getDate(),o=o.getDate();return Math.abs(t-o)}catch(e){}},p.getUUID=function(){var o,e=i.Storage.getStorage(s.KeyMapper.IZOOTO_UUID);return""==e&&(o=(new Date).getTime(),e="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=(o+16*Math.random())%16|0;return o=Math.floor(o/16),("x"==e?t:3&t|8).toString(16)})),e},p.getCurrentUUID=function(){return r.Config.UUID||i.Storage.getStorage(s.KeyMapper.IZOOTO_UUID)},p.isUUID=function(){return""!=i.Storage.getStorage(s.KeyMapper.IZOOTO_UUID)},p.setUUID=function(){var e=p.getCurrentUUID();p.isUUID()||i.Storage.setStorage(s.KeyMapper.IZOOTO_UUID,e)},p.UUIDMapper=function(e,t){var o=p.getEndpoint("FCMMigration"),t="oBkey="+e+"&bKey="+t;a.HttpRequest.post(o,{data:t},function(){p.displayLog("Old & new UUID mappped successfully")})},p.getUUIDFromEndpoint=function(n){return new Promise(function(t,e){p.displayLog("Fetching lost UUID by endpoint");var o=p.getEndpoint("getUUIDFromEp"),i=c.NotificationHelper.subcriptionToObject(n);2!=r.Config.global.browserType&&(i=i.endpoint),o=o+"?pid="+r.Config.client+"&ep="+i+"&btype="+r.Config.global.browserType,a.HttpRequest.get(o,function(e){e=p.parseToJSON(e);e.hasOwnProperty("id")&&"NULL"!=e.id&&"string"==typeof e.id&&t(e.id),t("")})})},p);function p(){}t.Helper=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=o(1),r=o(0),i=o(11),s=o(27),c=o(3),p=o(8),o=(l.updateLastSync=function(e){l.setConfigLocal(e,Date.now(),c.KeyMapper.IZOOTO_SYNC)},l.setStorage=function(e,t){s.LocalStorage.isLocalStorageSupport()?localStorage.setItem(e,t):i.CookieStorage.setCookie(e,t)},l.getStorage=function(e){var t="";return null!=(t=s.LocalStorage.getLocalStorage(e))?e===c.KeyMapper.IZOOTO_PUSH_TOKEN?decodeURIComponent(t):t:i.CookieStorage.getCookie(e)},l.removeStorage=function(e){i.CookieStorage.removeCookie(e),s.LocalStorage.removeLocalStorage(e)},l.removeConfigLocal=function(e,t){void 0===t&&(t=c.KeyMapper.IZOOTO_CONFIG);var o={},i=s.LocalStorage.getLocalStorage(t);""!=i&&null!=i&&(o=a.Helper.parseToJSON(i)),null!=o.hasOwnProperty(e)&&delete o[e],s.LocalStorage.isLocalStorageSupport()&&s.LocalStorage.setLocalStorage(t,JSON.stringify(o))},l.setConfigLocal=function(e,t,o){void 0===o&&(o=c.KeyMapper.IZOOTO_CONFIG);var i=Math.round((new Date).getTime()/1e3),n={},r=s.LocalStorage.getLocalStorage(o);""!=r&&null!=r&&(n=(n=a.Helper.parseToJSON(r))||{}),n[e]=null!=t&&""!==t?t:i,s.LocalStorage.isLocalStorageSupport()&&s.LocalStorage.setLocalStorage(o,JSON.stringify(n))},l.getConfigLocal=function(e,t){void 0===t&&(t=c.KeyMapper.IZOOTO_CONFIG);var o=s.LocalStorage.getLocalStorage(t),i={},t="";return""!=o&&(i=(i=a.Helper.parseToJSON(o))||{}),null!=i&&null!=i[e]&&(t=i[e]),t},l.legacyStorageMigration=function(){try{if(l.getStorage(c.KeyMapper.IZOOTO_UUID)||(r.Config.store.isMDSyncingRequired=!0),1==l.getConfigLocal("isLegacyStorageMigrated"))return void a.Helper.displayLog("Leagacy storage has already migrated!");var e=l.getStorage("iztoken");e&&(l.setStorage(c.KeyMapper.IZOOTO_PUSH_TOKEN,e),l.updateLastSync(c.KeyMapper.IZOOTO_PUSH_TOKEN));var t=l.getConfigLocal("id","izConf");t&&l.setStorage(c.KeyMapper.IZOOTO_UUID,t);e=l.getStorage("izooto");e&&(r.Config.store.isMDSyncingRequired=!0,e=decodeURIComponent(e),a.Helper.isJSONString(e)&&(e=a.Helper.parseToJSON(e),o={token:JSON.stringify(e["iz_"+r.Config.client].bkey),subscribed_on:e["iz_"+r.Config.client].subscribed_on,uuid:l.getStorage(c.KeyMapper.IZOOTO_UUID)},p.MasterDomain.setMasterStorage(o)));t=l.getStorage("izstatus");t&&(t=decodeURIComponent(t),a.Helper.isJSONString(t)&&(t=a.Helper.parseToJSON(t),l.setConfigLocal(c.KeyMapper.IZOOTO_PERMISSION_STATUS,t.v)));e=l.getConfigLocal("pmtcount","izConf");e&&l.setConfigLocal(c.KeyMapper.IZOOTO_PROMPT_COUNT,e,c.KeyMapper.IZOOTO_STATS);var o=l.getConfigLocal("dscount","izConf");o&&l.setConfigLocal(c.KeyMapper.IZOOTO_OPTIN_SHOWN_COUNT,o,c.KeyMapper.IZOOTO_STATS);t=l.getConfigLocal("IZCID","izConf");t&&(l.setConfigLocal(c.KeyMapper.IZOOTO_IZCID,t),l.updateLastSync(c.KeyMapper.IZOOTO_IZCID));e=l.getStorage("izDl");e&&(e=decodeURIComponent(e),a.Helper.isJSONString(e)&&(e=a.Helper.parseToJSON(e),l.setConfigLocal(c.KeyMapper.IZOOTO_REPEAT_PROMPT_DELAY,e.t)));o=l.getConfigLocal("msngrSubscribed","izConf");o&&l.setConfigLocal(c.KeyMapper.IZOOTO_MSNGR_IS_SUBSCRIBED,o);t=l.getConfigLocal("msngrDl","izSync");t&&(t*=1e3,n=(t=new Date(t)).setTime(t.getTime()+60*r.Config.messenger.repeatDelay*1e3),l.setConfigLocal(c.KeyMapper.IZOOTO_MSNGR_REPEAT_PROMPT_DELAY,n.getTime()));e=l.getStorage("izup");e&&l.setStorage(c.KeyMapper.IZOOTO_USER_PROPERTY,decodeURIComponent(e));o=l.getStorage("izmd");o&&l.setConfigLocal(c.KeyMapper.IZOOTO_ALT_DOMAIN_STATUS,decodeURIComponent(o));t=l.getStorage("izgdpr");t&&l.setConfigLocal(c.KeyMapper.IZOOTO_GDPR_CONSENT,t);var i,n=l.getConfigLocal("iz_apihc","izConf");n&&a.Helper.isJSONString(n)&&(n=a.Helper.parseToJSON(n),e={},o=new Date,!n.hasOwnProperty("evt_pd")||(t=n.evt_pd)&&(t=t.split("#"),e[c.KeyMapper.IZOOTO_EVENT_DAILY]=t[1],o.setDate(t[0])),n.hasOwnProperty("evt_pm")&&((i=n.evt_pm)&&(i=i.split("#"),e[c.KeyMapper.IZOOTO_EVENT_MONTHLY]=i[1],o.setMonth(i[0]-1)),l.setConfigLocal(c.KeyMapper.IZOOTO_LAST_EVENT_SYNC,o.getTime(),c.KeyMapper.IZOOTO_SYNC)),!n.hasOwnProperty("prop_pd")||(i=n.prop_pd)&&(i=i.split("#"),e[c.KeyMapper.IZOOTO_PROPERTY_DAILY]=i[1],o.setDate(i[0])),n.hasOwnProperty("prop_pm")&&((n=n.prop_pm)&&(n=n.split("#"),e[c.KeyMapper.IZOOTO_PROPERTY_MONTHLY]=n[1],o.setMonth(n[0]-1)),l.setConfigLocal(c.KeyMapper.IZOOTO_LAST_PROPERTY_SYNC,o.getTime(),c.KeyMapper.IZOOTO_SYNC)),l.setConfigLocal(c.KeyMapper.IZOOTO_DM_SYNC_COUNT,e,c.KeyMapper.IZOOTO_STATS)),l.setConfigLocal("isLegacyStorageMigrated",1),a.Helper.displayLog("Legacy storage migrated sucessfully")}catch(e){l.setConfigLocal("isLegacyStorageMigrated",1),a.Helper.displayLog("legacy storage partially migrated ! due to : ",e)}},l);function l(){}t.Storage=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.KeyMapper={IZOOTO_OPTIN_SHOWN:"optInShown",IZOOTO_OPTIN_CLOSED:"optInClosed",IZOOTO_OPTIN_ALLOWED:"optInAllowed",IZOOTO_PROMPTED:"prompted",IZOOTO_PROMPT_CLOSED:"promptclose",IZOOTO_PROMPT_DENIED:"denied",IZOOTO_PROMPT_ALLOWED:"allowed",IZOOTO_SUBSCRIBED:"subscribed",IZOOTO_ALREADY_GRANTED:"already_granted",IZOOTO_OLD_SUBSCRIPTION:"old_subscription",IZOOTO_SUBSCRIBER_REGISTRED:"subscriber_registred",IZOOTO_ALREADY_DENIED:"already_denied",IZOOTO_ALREADY_UNSUBSCRIBED:"already_unsubscribed",IZOOTO_UNSUBSCRIBED:"unsubscribed",IZOOTO_POPUP_OPEN:"popupOpened",IZOOTO_POPUP_CLOSED:"popClosed",IZOOTO_BROWSER_UNSUPPORTED:"browserUnsupported",IZOOTO_MESSENGER_PROMPTED:"messengerPrompted",IZOOTO_MESSENGER_SUBSCRIBED:"messengerSubscribed",IZOOTO_UUID:"izootoUID",IZOOTO_PUSH_TOKEN:"izootoPushToken",IZOOTO_STATS:"izootoStats",IZOOTO_SYNC:"izootoSync",IZOOTO_CONFIG:"izootoConfig",IZOOTO_USER_PROPERTY:"izootoUserProp",IZOOTO_MASTER_DOMAIN:"izootoMDConfig",IZOOTO_SESSION:"izootoSession",IZOOTO_RECOMMEND_ARTICLE:"izootoRecommendArticle",IZOOTO_MESSENGER:"izootoMessenger",IZOOTO_PROMPT_COUNT:"promptCount",IZOOTO_OPTIN_SHOWN_COUNT:"optInShownCount",IZOOTO_DM_SYNC_COUNT:"dmSyncCount",IZOOTO_EVENT_DAILY:"eventDaily",IZOOTO_EVENT_MONTHLY:"eventMonthly",IZOOTO_PROPERTY_DAILY:"propDaily",IZOOTO_PROPERTY_MONTHLY:"propMonthly",IZOOTO_PUSH_TOKEN_NOT_SYNCED:"pushTokenNotSynced",IZOOTO_PERMISSION_STATUS:"permissionStatus",IZOOTO_REPEAT_PROMPT_DELAY:"notificationPromptDelay",IZOOTO_GDPR_CONSENT:"gdprStatus",IZOOTO_TAB_ABANDONMENT:"tabAbandonment",IZOOTO_IZCID:"IZCID",IZOOTO_ALT_DOMAIN_STATUS:"altDomainStatus",IZOOTO_TAB_ABANDONMENT_PUSH:"tabAbandonmentPush",IZOOTO_LAST_EVENT_SYNC:"lastEventSync",IZOOTO_LAST_PROPERTY_SYNC:"lastPropSync",IZOOTO_FIRST_SESSION:"firstSession",IZOOTO_CRPS_PLAYBOOK:"crpsPlaybook",IZOOTO_SUBSCRIBED_ON:"subscribedOn",IZOOTO_SESSION_EXPIRY:"expiry",IZOOTO_SESSION_COUNT:"count",IZOOTO_MSNGR_REPEAT_PROMPT_DELAY:"promptDelay",IZOOTO_MSNGR_IS_SUBSCRIBED:"isSubscribed",LAST_SYNC_OF_RECOMMEND_ARTICLE:"recommendArticle",RECOMMEND_ARTICLE_SYNCED_PATH:"syncedPath",IZOOTO_MESSAGE:"izootoMsg",BROWSER_CHROME:"Chrome",BROWSER_SAFARI:"Safari",BROWSER_FIREFOX:"Firefox",BROWSER_OPERA:"Opera",BROWSER_IE:"Microsoft Internet Explorer",BROWSER_OTHER:"Other",BROWSER_UCB:"Ucb",BROWSER_EDGE:"Edge",IZOOTO_MASTER_TO_CHILD:"izMasterToChild",IZOOTO_CHILD_TO_MASTER:"izChildToMaster",IZOOTO_MASTER_AS_FRAME:"izMasterAsFrame",DAILY:"daily",MONTHLY:"monthly"}},function(e,t,o){"use strict";var n=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(o,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function n(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}r((c=c.apply(e,a||[])).next())})},r=this&&this.__generator||function(o,i){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(o,s)}catch(e){t=[6,e],r=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},c=this&&this.__spreadArrays||function(){for(var e=0,t=0,o=arguments.length;t<o;t++)e+=arguments[t].length;for(var i=Array(e),n=0,t=0;t<o;t++)for(var r=arguments[t],a=0,s=r.length;a<s;a++,n++)i[n]=r[a];return i};Object.defineProperty(t,"__esModule",{value:!0});var p=o(1),O=o(0),l=o(2),g=o(5),a=o(6),i=o(13),s=o(14),d=o(15),f=o(16),u=o(17),y=o(9),m=o(28),b=o(3),S=o(7),_=o(18),C=o(8),v=o(19),T=o(21),w=o(22),o=(h.nativeHandler=function(){h.setManifest(),"default"==window.Notification.permission?(h.brandingOverlayHandler(),h.sendEvent(b.KeyMapper.IZOOTO_PROMPTED),window.Notification.requestPermission().then(function(e){h.closeHttpsOverlay(),p.Helper.displayLog("Permission Status : ",e),"granted"==e?h.permissionGrantedCallback():e==b.KeyMapper.IZOOTO_PROMPT_DENIED?h.permissionDeniedCallback():"default"==e&&h.sendEvent(b.KeyMapper.IZOOTO_PROMPT_CLOSED),l.Storage.removeStorage("izootoActivePrompt")})):"granted"==window.Notification.permission?h.permissionAlreadyGrantedCallback():window.Notification.permission==b.KeyMapper.IZOOTO_PROMPT_DENIED&&h.sendEvent(b.KeyMapper.IZOOTO_ALREADY_DENIED)},h.permissionAlreadyGrantedCallback=function(){1!=O.Config.notification.httpsNoRoot?(h.getSubscription().then(function(){C.MasterDomain.masterDomainCallback(!0)}),1==O.Config.notification.isShopify&&d.Shopify.init()):h.addNoRootIframeHandler(b.KeyMapper.IZOOTO_ALREADY_GRANTED)},h.addNoRootIframeHandler=function(e){var t=(t=O.Config.notification.sourceOrigin+"?action=noroot")+"&izpt="+O.Config.notification.promptType+"&status="+e;h.noRootVersionHandler(),O.Config.global.isFrame||window.location.pathname!=O.Config.notification.sourceOrigin?(p.Helper.addMsgReciever(h.msgReciever),h.addIFrame(t,"izSubFrame")):h.noRootHandler(e)},h.permissionGrantedCallback=function(){1!=O.Config.notification.httpsNoRoot?h.registerServiceWorker(O.Config.notification.serviceWorkerPath).then(function(e){p.Helper.displayLog("SW Regsitered ! ",e),h.subscribe(b.KeyMapper.IZOOTO_PROMPT_ALLOWED).then(function(e){C.MasterDomain.masterDomainCallback(!1)})}):h.addNoRootIframeHandler("granted")},h.permissionDeniedCallback=function(){h.sendEvent(b.KeyMapper.IZOOTO_PROMPT_DENIED),p.Helper.displayLog("User denied prompt")},h.promptHandler=function(){var o=O.Config.notification.promptType;"https:"!=O.Config.global.locationProtocol&&1==O.Config.notification.isSdkHttps&&(O.Config.notification.promptType=1),2==O.Config.global.browserType?setTimeout(function(){h.checkSafariPermission()},300):0==O.Config.notification.isSdkHttps||O.Config.notification.isSdkHttps&&"http:"==O.Config.global.locationProtocol?(p.Helper.displayLog("Subdomain Process... "),h.getSubDomainPermissionStatus().then(function(e){var t;p.Helper.displayLog("Current subdomain status : ",e),0==e?2==o?h.triggerEventHandler(i.Notification.openPopup):h.promptEventHandler(h.loadOptin):1==e?(t=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),h.sendEvent(b.KeyMapper.IZOOTO_ALREADY_GRANTED,t)):2==e&&(h.updatePermissionStatus(2),h.sendEvent(b.KeyMapper.IZOOTO_ALREADY_DENIED))})):1==O.Config.notification.isSdkHttps&&("default"==window.Notification.permission?0==o?h.promptEventHandler(h.nativeHandler):1==o?h.promptEventHandler(h.loadOptin):2==o&&h.triggerEventHandler(h.nativeHandler):h.nativeHandler())},h.triggerEventHandler=function(e){O.Config.store.isNotificationCalledManually?(O.Config.store.isTriggerPromptWithDelay||(O.Config.notification.promptDelay=0),h.delayHandler(e)):p.Helper.displayLog("auto prompt false found!")},h.requestSafariPermission=function(){p.Helper.displayLog("Prompted Safari"),h.sendEvent(b.KeyMapper.IZOOTO_PROMPTED),h.brandingOverlayHandler();try{window.safari.pushNotification.requestPermission(O.Config.notification.webServiceUrl,O.Config.notification.webPushId,{url:window.location.href},function(e){var t;"granted"===e.permission?(h.closeHttpsOverlay(),t=e.deviceToken,h.sendEvent(b.KeyMapper.IZOOTO_PROMPT_ALLOWED,t),p.Helper.displayLog("Granted Key= "+t)):e.permission===b.KeyMapper.IZOOTO_PROMPT_DENIED&&(h.closeHttpsOverlay(),h.sendEvent(b.KeyMapper.IZOOTO_PROMPT_DENIED))})}catch(e){h.closeHttpsOverlay()}},h.checkSafariPermission=function(){var e,t,o;""!=O.Config.notification.webPushId&&""!=O.Config.notification.webServiceUrl?(e="","safari"in window&&"pushNotification"in window.safari&&("default"===(t=window.safari.pushNotification.permission(O.Config.notification.webPushId)).permission?0==(o=O.Config.notification.promptType)?h.promptEventHandler(h.requestSafariPermission):1==o?h.promptEventHandler(h.loadOptin):2==o&&h.triggerEventHandler(h.requestSafariPermission):"granted"===t.permission?(e=t.deviceToken,h.sendEvent(b.KeyMapper.IZOOTO_ALREADY_GRANTED,e),p.Helper.displayLog("Already Granted & key= ",e)):t.permission===b.KeyMapper.IZOOTO_PROMPT_DENIED&&(h.sendEvent(b.KeyMapper.IZOOTO_ALREADY_DENIED),p.Helper.displayLog(b.KeyMapper.IZOOTO_PROMPT_DENIED)))):p.Helper.displayLog("Stopped! Safari certificate not found")},h.delayHandler=function(e){O.Config.notification.promptDelay?(p.Helper.displayLog("Triggering prompt delay for : "+O.Config.notification.promptDelay+" ms"),setTimeout(e,O.Config.notification.promptDelay)):e()},h.promptEventHandler=function(e){h.isActivePrompt()?p.Helper.displayLog(O.Config.brandingPartner+" notification off for this device"):h.isRepeatPromptDelay()||(1==O.Config.notification.promptOnScroll&&h.isScreenScrollable()?(p.Helper.displayLog("optIn will be shown on page scroll!"),window.addEventListener("scroll",function(){h.scrollHandler(e)})):h.delayHandler(e))},h.isRepeatPromptDelay=function(){var e,t=!1;return O.Config.notification.windowType||(e=new Date,l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_REPEAT_PROMPT_DELAY)>e.getTime()&&(t=!0,p.Helper.displayLog("Wait until repeat prompt delay expire!"))),t},h.triggerPromptHandler=function(e){void 0===e&&(e=!1),O.Config.store.isNotificationCalledManually||(e&&(O.Config.store.isTriggerPromptWithDelay=!0),O.Config.store.isNotificationCalledManually=!0,h.promptHandler())},h.noRootHandler=function(e){p.Helper.displayLog("No root handler initiated..."),"granted"==(e=e||p.Helper.getParamFromUrl(document.location.href,"status"))?h.registerServiceWorker(O.Config.notification.serviceWorkerPath).then(function(e){h.subscribe(b.KeyMapper.IZOOTO_PROMPT_ALLOWED)}):e==b.KeyMapper.IZOOTO_ALREADY_GRANTED?h.getSubscription():"getOldSubscription"==e&&h.httpsGetOldSubscription(!0)},h.httpsNoRootGetOldSubscription=function(){return n(this,void 0,void 0,function(){return r(this,function(e){return[2,new Promise(function(t,e){var o;window.top==window.self?(o=(o=O.Config.notification.sourceOrigin+"?action=noroot")+"&izpt="+O.Config.notification.promptType+"&status=getOldSubscription",p.Helper.addMsgReciever(function(e){e=p.Helper.parseToJSON(e.data);if(e.hasOwnProperty(b.KeyMapper.IZOOTO_MESSAGE)){e=e[b.KeyMapper.IZOOTO_MESSAGE];if(e.hasOwnProperty(b.KeyMapper.IZOOTO_OLD_SUBSCRIPTION)&&null!=e[b.KeyMapper.IZOOTO_OLD_SUBSCRIPTION])return void t(e[b.KeyMapper.IZOOTO_OLD_SUBSCRIPTION])}},!0),h.addIFrame(o,"izSubFrame")):h.noRootHandler()})]})})},h.httpsGetOldSubscription=function(r){return void 0===r&&(r=!1),new Promise(function(t,e){try{var o=!1,i=!1,n=function(e){0==i&&(i=!0,r&&p.Helper.postMessage("parent",b.KeyMapper.IZOOTO_OLD_SUBSCRIPTION,o),p.Helper.displayLog(e),t(o))};setTimeout(function(){n("SW Registration not found!")},1500),p.Helper.displayLog("Finding SW Registration..."),navigator.serviceWorker.ready.then(function(e){-1==e.scope.indexOf(O.Config.notification.domainRoot)?n(O.Config.brandingPartner+" sw not found found !"):e.pushManager.getSubscription().then(function(e){e&&(o=JSON.stringify(e)),n("SW Registration found!"),p.Helper.displayLog("Recovered Subscription : ",o)}).catch(function(){p.Helper.displayLog("Not Resolved")})})}catch(e){}})},h.noRootVersionHandler=function(){s.IndexedDB.init().then(function(e){s.IndexedDB.addUpdate(e,"noRootAllowed",1).then(function(e){p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)})},h.getResponseCode=function(e){var t={};t[b.KeyMapper.IZOOTO_PROMPT_ALLOWED]={response:"subscribed",statuscode:1},t[b.KeyMapper.IZOOTO_SUBSCRIBED]={response:"subscribed",statuscode:1},t[b.KeyMapper.IZOOTO_ALREADY_GRANTED]={response:"already subscribed",statuscode:2},t[b.KeyMapper.IZOOTO_PROMPT_DENIED]={response:"blocked",statuscode:3},t[b.KeyMapper.IZOOTO_ALREADY_DENIED]={response:"already blocked",statuscode:4},t[b.KeyMapper.IZOOTO_BROWSER_UNSUPPORTED]={response:"browser not supported",statuscode:5},t[b.KeyMapper.IZOOTO_PROMPT_CLOSED]={response:"prompt closed",statuscode:6},t[b.KeyMapper.IZOOTO_UNSUBSCRIBED]={response:"soft unsubscribed",statuscode:7},t[b.KeyMapper.IZOOTO_ALREADY_UNSUBSCRIBED]={response:"already soft unsubscribed",statuscode:8},t[b.KeyMapper.IZOOTO_OPTIN_ALLOWED]={response:"soft subscribed",statuscode:9},t[b.KeyMapper.IZOOTO_SUBSCRIBER_REGISTRED]={response:"subscriber reregistered",statuscode:10};var o={};return o[b.KeyMapper.IZOOTO_OPTIN_SHOWN]={response:"soft prompt displayed",statuscode:1},o[b.KeyMapper.IZOOTO_OPTIN_CLOSED]={response:"soft prompt closed",statuscode:2},o[b.KeyMapper.IZOOTO_PROMPTED]={response:"native prompt displayed",statuscode:3},o[b.KeyMapper.IZOOTO_POPUP_OPEN]={response:"prompt window opened",statuscode:4},o[b.KeyMapper.IZOOTO_POPUP_CLOSED]={response:"prompt window closed",statuscode:5},void 0!==t[e]?t[e]:void 0!==o[e]?o[e]:void 0},h.sendEvent=function(t,o){if(p.Helper.displayLog("Event caught : ",t),1!=O.Config.notification.windowType&&6!=O.Config.notification.windowType){var e,i=[b.KeyMapper.IZOOTO_PROMPT_ALLOWED,b.KeyMapper.IZOOTO_SUBSCRIBED,b.KeyMapper.IZOOTO_ALREADY_GRANTED,b.KeyMapper.IZOOTO_PROMPT_DENIED,b.KeyMapper.IZOOTO_ALREADY_DENIED,b.KeyMapper.IZOOTO_BROWSER_UNSUPPORTED,b.KeyMapper.IZOOTO_PROMPT_CLOSED,b.KeyMapper.IZOOTO_UNSUBSCRIBED,b.KeyMapper.IZOOTO_ALREADY_UNSUBSCRIBED,b.KeyMapper.IZOOTO_OPTIN_ALLOWED],n=[b.KeyMapper.IZOOTO_OPTIN_SHOWN,b.KeyMapper.IZOOTO_OPTIN_CLOSED,b.KeyMapper.IZOOTO_PROMPTED,b.KeyMapper.IZOOTO_POPUP_OPEN,b.KeyMapper.IZOOTO_POPUP_CLOSED],r=c([b.KeyMapper.IZOOTO_PROMPT_ALLOWED,b.KeyMapper.IZOOTO_ALREADY_GRANTED,b.KeyMapper.IZOOTO_PROMPT_DENIED],O.Config.notification.eventsToSync);t!=b.KeyMapper.IZOOTO_PROMPT_ALLOWED&&t!=b.KeyMapper.IZOOTO_ALREADY_GRANTED||(p.Helper.setUUID(),h.setUuidDb(p.Helper.getCurrentUUID()),f.GDPR.init(),h.syncHookInDb("syncNotificationView"),h.syncHookInDb("syncNotificationClick")),t==b.KeyMapper.IZOOTO_PROMPT_ALLOWED&&""!=O.Config.notification.sourceOriginAlt&&h.removeSubsriptionFromAlternateDomain(),t!=b.KeyMapper.IZOOTO_PROMPTED&&t!=b.KeyMapper.IZOOTO_OPTIN_SHOWN||(h.updatePromptCount(t),h.setActivePrompt(5),l.Storage.removeStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),0!=O.Config.notification.repeatPromptDelay&&h.setRepeatPromptDelay(O.Config.notification.repeatPromptDelay)),t==b.KeyMapper.IZOOTO_OPTIN_CLOSED&&0!=O.Config.notification.optInCloseDelay&&h.setRepeatPromptDelay(O.Config.notification.optInCloseDelay),t==b.KeyMapper.IZOOTO_PROMPT_CLOSED&&l.Storage.removeStorage("izootoActivePrompt"),-1!=r.indexOf(t)&&(h.updatePermissionStatus(t),r=m.AdNetwork.getAdNetworkParam(),null!=o?(t==b.KeyMapper.IZOOTO_PROMPT_ALLOWED&&2==O.Config.global.browserType&&h.showWelcomeNotificationOld(o),e+=r,"object"==typeof o&&(o=JSON.stringify(o)),r=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),o!=r&&(p.Helper.displayLog("Current subscription token not matched with saved token! Updating..."),h.updateSubscriptionToken(o)),t==b.KeyMapper.IZOOTO_PROMPT_ALLOWED||t==b.KeyMapper.IZOOTO_ALREADY_GRANTED?h.syncEvent(t,o,e):h.syncEvent(t)):h.syncEvent(t)),-1!=i.indexOf(t)&&(i=h.getResponseCode(t),t==b.KeyMapper.IZOOTO_ALREADY_GRANTED&&(O.Config.store.isSoftSubscribeTriggered&&(i=h.getResponseCode(b.KeyMapper.IZOOTO_SUBSCRIBED)),O.Config.store.isSubscriptionLost&&(i=h.getResponseCode(b.KeyMapper.IZOOTO_SUBSCRIBER_REGISTRED))),h.subscriptionEventsCallback(t,i)),-1!=n.indexOf(t)&&h.promptDisplayCallback(t,h.getResponseCode(t))}else try{var a="parent",s=[b.KeyMapper.IZOOTO_SUBSCRIBED,b.KeyMapper.IZOOTO_ALREADY_GRANTED,b.KeyMapper.IZOOTO_PROMPT_DENIED,b.KeyMapper.IZOOTO_PROMPT_ALLOWED,b.KeyMapper.IZOOTO_PROMPT_CLOSED,b.KeyMapper.IZOOTO_ALREADY_DENIED];O.Config.global.isFrame||(a="opener",h.popupNoticeHandler(t)),h.getswVersion().then(function(e){p.Helper.postMessage(a,t,o,e)}).catch(function(e){p.Helper.postMessage(a,t,o),p.Helper.displayLog("Error while getting sw version")}).finally(function(){t==b.KeyMapper.IZOOTO_PROMPT_ALLOWED&&h.showWelcomeNotification(!1)&&p.Helper.postMessage(a,"syncWelcomeSent",1),-1<s.indexOf(t)&&"opener"==a&&(p.Helper.displayLog("Closing Popup for  : ",t),h.closePopupWindow())})}catch(e){}},h.popupNoticeHandler=function(e){switch(e){case b.KeyMapper.IZOOTO_PROMPTED:h.popupNotice(O.Config.notification.clickOnAllowMsg);break;case b.KeyMapper.IZOOTO_PROMPT_ALLOWED:h.popupNotice(O.Config.notification.subscribedMsg);break;case b.KeyMapper.IZOOTO_ALREADY_GRANTED:h.popupNotice(O.Config.notification.alreadySubscribedMsg);break;case b.KeyMapper.IZOOTO_PROMPT_DENIED:h.popupNotice(O.Config.notification.blockedMsg);break;case b.KeyMapper.IZOOTO_ALREADY_DENIED:h.popupNotice(O.Config.notification.alreadyDeniedMsg)}},h.subscriptionEventsCallback=function(e,t){"function"==typeof a.Queue.subscriptionCallback?a.Queue.subscriptionCallback(t):"function"==typeof a.Queue.userCallback&&(7!=t.statuscode&&8!=t.statuscode||(t={response:"unsubscribed",statuscode:7}),a.Queue.userCallback(t)),y.GoogleAnalytics.isCallbackAllowed(O.Config.ga.subscriptionCallback,t.statuscode)&&y.GoogleAnalytics.process(t.response)},h.promptDisplayCallback=function(e,t){"function"==typeof a.Queue.promptDisplayCallback&&a.Queue.promptDisplayCallback(t),y.GoogleAnalytics.isCallbackAllowed(O.Config.ga.promptDisplayCallback,t.statuscode)&&y.GoogleAnalytics.process(t.response)},h.syncEvent=function(t,e,o){if(0<=O.Config.store.syncedEventList.indexOf(t))p.Helper.displayLog("Abort! This event has been synced already");else{O.Config.store.syncedEventList.push(t),p.Helper.displayLog("Syncing Event : ",t);var i=h.getDeviceParameters();if(void 0!==e){i+=h.getSubscriptionParameters(e),null!=o&&"undefined"!=o&&(i+=o);o=p.Helper.getUTMParamsOfUrl();if(!1!==o&&(i+="&"+o),t!=b.KeyMapper.IZOOTO_PROMPT_ALLOWED&&t!=b.KeyMapper.IZOOTO_ALREADY_GRANTED||(t==b.KeyMapper.IZOOTO_PROMPT_ALLOWED&&O.Config.notification.isSdkHttps&&"https:"==O.Config.global.locationProtocol&&h.showWelcomeNotification(!1),1==O.Config.notification.isShopify&&d.Shopify.init(!0),a.Queue.sync(),u.TabAbandonments.init(),_.VideoDropOff.init(),v.CRPSPlaybook.init(),T.RecommendArticle.init(),h.syncLastVisit(),1==m.AdNetwork.forceSyncAdNetwork&&h.syncAdNetwork(m.AdNetwork.getAdNetworkParam(!0)),w.AutoSegment.init()),""!=l.Storage.getStorage(b.KeyMapper.IZOOTO_UUID)&&!l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PUSH_TOKEN_NOT_SYNCED))return}h.getExtraParameterToSync(t).then(function(e){switch(i+=e,t){case b.KeyMapper.IZOOTO_OPTIN_SHOWN:i+="&divShow=1";break;case b.KeyMapper.IZOOTO_OPTIN_ALLOWED:i+="&divAllowed=1";break;case b.KeyMapper.IZOOTO_OPTIN_CLOSED:i+="&divClosed=1";break;default:i+="&"+t+"=1"}e={data:i};g.HttpRequest.post(p.Helper.getEndpoint(t),e,function(){l.Storage.removeConfigLocal(b.KeyMapper.IZOOTO_PUSH_TOKEN_NOT_SYNCED),p.Helper.displayLog("Event : "+t+" synced successfully with "+O.Config.brandingPartner)})})}},h.updateSubscriptionToken=function(e){3==O.Config.notification.subscriptionType?l.Storage.setStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN,e):2==O.Config.notification.subscriptionType?("object"==typeof e&&(e=JSON.stringify(e)),l.Storage.setStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN,encodeURIComponent(e))):1==O.Config.notification.subscriptionType?l.Storage.setStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN,e):p.Helper.displayLog("No GCM Token"),l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PUSH_TOKEN_NOT_SYNCED,1),l.Storage.updateLastSync(b.KeyMapper.IZOOTO_PUSH_TOKEN);e=l.Storage.getStorage(b.KeyMapper.IZOOTO_USER_PROPERTY);(e=p.Helper.parseToJSON(e))&&h.syncProperties("SegmentProperties","add",e,function(){return p.Helper.displayLog("User property re-synced succesfully")})},h.syncAdNetwork=function(o){var e=p.Helper.getEndpoint("syncAdNetwork"),t="pid="+O.Config.client+"&bkey="+p.Helper.getCurrentUUID()+"&";t+=p.Helper.objToParam(o);g.HttpRequest.post(e,{data:t},function(e,t){200==t&&Object.keys(o).map(function(e){o[e]&&l.Storage.setConfigLocal(e,o[e])})})},h.syncProperties=function(t,i,n,r){var o=p.Helper.getEndpoint(t),a=h.getDeviceParameters(),e="";switch(t){case"SegmentEvents":e="evt";break;case"SegmentProperties":e="userp";break;case"PersonalProperties":e="pers";break;case"TriggerEvent":e="trg"}a+="&et="+e,a=null!=n?(n=encodeURIComponent(JSON.stringify(n)),a+"&act="+i+"&val="+n):a+"&act="+i;var s=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN);if(h.isSegmentSyncAllowed()){try{a+=h.getSubscriptionParameters(s)}catch(e){}var c=function(e,t,o){200==t&&(p.Helper.displayLog(o+" synced successfully"),h.syncUserEventCallback(o,i,n)),null!=r&&"function"==typeof r&&r(e,t,o)};h.getExtraParameterToSync().then(function(e){e={data:a+=e};g.HttpRequest.post(o,e,c,void 0,void 0,t)})}else p.Helper.displayLog(t+" Aborted! No subscription key or UUID found")},h.isSegmentSyncAllowed=function(){return!(!l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN)||!p.Helper.getCurrentUUID)},h.syncUserEventCallback=function(e,t,o){var i,n="";switch(e){case"SegmentEvents":n="User Event";break;case"SegmentProperties":n="User Property";break;case"PersonalProperties":n="Personalization Property";break;case"TriggerEvent":n="Trigger"}try{var r={};r[n]=decodeURIComponent(o),O.Config.store.syncedSegments.push(r)}catch(e){}1==O.Config.debugger.status&&(i=S.Debugger.getMsgSet(),e=n+": "+(o=decodeURIComponent(o))+" "+i.ev,"SegmentEvents"!=n&&"TriggerEvent"!=n||(e=n+": "+t+" "+i.ev,o&&(e+=" with data "+o)),S.Debugger.log(e,O.Config.debugger.successCode))},h.getSyncCount=function(e,t){var o,i=new Date,n=i.getDate(),r=i.getMonth()+1,i=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_DM_SYNC_COUNT,b.KeyMapper.IZOOTO_STATS);if("event"==e){var a=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_LAST_EVENT_SYNC,b.KeyMapper.IZOOTO_SYNC);if(""==a)return 0;var s=(o=new Date(a)).getDate(),a=o.getMonth()+1;if(t==b.KeyMapper.DAILY)return null!=i[b.KeyMapper.IZOOTO_EVENT_DAILY]&&n==s?i[b.KeyMapper.IZOOTO_EVENT_DAILY]:0;if(t==b.KeyMapper.MONTHLY)return null!=i[b.KeyMapper.IZOOTO_EVENT_MONTHLY]&&r==a?i[b.KeyMapper.IZOOTO_EVENT_MONTHLY]:0}else if("userProperty"==e){e=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_LAST_PROPERTY_SYNC,b.KeyMapper.IZOOTO_SYNC);if(""==e)return 0;s=(o=new Date(e)).getDate(),a=o.getMonth()+1;if(t==b.KeyMapper.DAILY)return null!=i[b.KeyMapper.IZOOTO_PROPERTY_DAILY]&&n==s?i[b.KeyMapper.IZOOTO_PROPERTY_DAILY]:0;if(t==b.KeyMapper.MONTHLY)return null!=i[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]&&r==a?i[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]:0}},h.hasSynclimitReached=function(e){return"event"==e?!O.Config.notification.evtTracking||(O.Config.notification.syncLimit.evtPerMonth<=h.getSyncCount("event",b.KeyMapper.MONTHLY)||O.Config.notification.syncLimit.evtPerDay<=h.getSyncCount("event",b.KeyMapper.DAILY)):"userProperty"==e?!O.Config.notification.propsTracking||(O.Config.notification.syncLimit.propsPerMonth<=h.getSyncCount("userProperty",b.KeyMapper.MONTHLY)||O.Config.notification.syncLimit.propsPerDay<=h.getSyncCount("userProperty",b.KeyMapper.DAILY)):void 0},h.userEventProcessor=function(e,t){if(h.hasSynclimitReached("event"))p.Helper.displayLog("Sync aborted! : Daily/monthly limit reached!");else{e=h.parseData(e),e=h.filterData(e);var o;if(h.validateData(e)){if(null!=t&&1<=Object.keys(t).length&&!(o=h.filterProperties(t,{key:32,value:32,object:16},["string","number","boolean"])))return void p.Helper.displayLog("Invalid Json Data");h.syncProperties("SegmentEvents",e,o,function(){h.increaseSyncCount("event")})}}},h.addPropertyProcessorFallback=function(t){var o,i,e;p.Helper.displayLog("Property fallback :",t),"object"!=typeof t||"string"!=typeof t.name||"string"!=typeof t.value&&"number"!=typeof t.value&&"boolean"!=typeof t.value||""===t.value?p.Helper.displayLog("Invalid payload passed in add_property"):("subscriber_id"==t.name&&t.value&&s.IndexedDB.init().then(function(e){s.IndexedDB.addUpdate(e,"subscriberId",t.value).then(function(e){O.Config.store.subscriberId=t.value,p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)}),o=p.Helper.getEndpoint("CustomerIDSynch"),i=h.getDeviceParameters(),e=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),i+=h.getSubscriptionParameters(e),i+="&name="+t.name+"&value="+t.value+"&operation=add_property",h.getExtraParameterToSync().then(function(e){i+=e,g.HttpRequest.post(o,{data:i},function(){})}))},h.increaseSyncCount=function(e){var t,o,i,n=new Date,r=n.getDate(),a=n.getMonth()+1,s=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_DM_SYNC_COUNT,b.KeyMapper.IZOOTO_STATS),c=""!=s?s:{};"event"==e?(""==(n=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_LAST_EVENT_SYNC,b.KeyMapper.IZOOTO_SYNC))?(c[b.KeyMapper.IZOOTO_EVENT_DAILY]=1,c[b.KeyMapper.IZOOTO_EVENT_MONTHLY]=1):(o=(t=new Date(n)).getDate(),i=t.getMonth()+1,null!=s[b.KeyMapper.IZOOTO_EVENT_DAILY]&&r==o?c[b.KeyMapper.IZOOTO_EVENT_DAILY]=s[b.KeyMapper.IZOOTO_EVENT_DAILY]+1:c[b.KeyMapper.IZOOTO_EVENT_DAILY]=1,null!=s[b.KeyMapper.IZOOTO_EVENT_MONTHLY]&&a==i?c[b.KeyMapper.IZOOTO_EVENT_MONTHLY]=s[b.KeyMapper.IZOOTO_EVENT_MONTHLY]+1:c[b.KeyMapper.IZOOTO_EVENT_MONTHLY]=1),l.Storage.updateLastSync(b.KeyMapper.IZOOTO_LAST_EVENT_SYNC)):"userProperty"==e&&(""==(e=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_LAST_PROPERTY_SYNC,b.KeyMapper.IZOOTO_SYNC))?(c[b.KeyMapper.IZOOTO_PROPERTY_DAILY]=1,c[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]=1):(o=(t=new Date(e)).getDate(),i=t.getMonth()+1,null!=s[b.KeyMapper.IZOOTO_PROPERTY_DAILY]&&r==o?c[b.KeyMapper.IZOOTO_PROPERTY_DAILY]=s[b.KeyMapper.IZOOTO_PROPERTY_DAILY]+1:c[b.KeyMapper.IZOOTO_PROPERTY_DAILY]=1,null!=s[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]&&a==i?c[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]=s[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]+1:c[b.KeyMapper.IZOOTO_PROPERTY_MONTHLY]=1),l.Storage.updateLastSync(b.KeyMapper.IZOOTO_LAST_PROPERTY_SYNC)),l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_DM_SYNC_COUNT,c,b.KeyMapper.IZOOTO_STATS)},h.toTriggerData=function(e,t){var o={},i={},n={collection_viewed:["collection_viewed",{collection_title:"collection_name",collection_link:"collection_url"}],product_viewed:["product_viewed",{product_title:"product_name",product_link:"product_url"}],added_to_cart:["added_to_cart",{product_title:"product_name"}],add_to_cart:["added_to_cart",{product_title:"product_name"}],order_placed:["order_placed",{}],purchased:["order_placed",{}]};if(n.hasOwnProperty(e)&&(o=n[e=n[e][0]][1]),null!=t)for(var r in t)o.hasOwnProperty(r)?i[o[r]]=t[r]:i[r]=t[r];return[e,i]},h.syncAsTrigger=function(e,t){e=h.parseData(e),e=h.filterData(e);var o={product_viewed:["product_browsed"],added_to_cart:["product_addedtocart","product_browsed"],order_placed:["product_addedtocart","product_browsed"]};if(1==O.Config.notification.eventAsTrigger&&0<=["collection_viewed","product_viewed","added_to_cart","add_to_cart","order_placed","purchased"].indexOf(e)){t=h.toTriggerData(e,t);if(0<Object.keys(t[1]).length?h.triggerProcessor(t[0],t[1]):h.triggerProcessor(t[0]),o.hasOwnProperty(t[0])){var i,n=o[t[0]];for(i in n)h.triggerProcessor(n[i])}}},h.triggerProcessor=function(e,t,o){e=h.parseData(e),e=h.filterData(e);var i;if(h.validateData(e)){if(null!=t&&1<=Object.keys(t).length&&!(i=h.filterProperties(t,{key:32,value:512,object:16},["string"])))return void p.Helper.displayLog("Invalid Json Data");h.syncProperties("TriggerEvent",e,i,o)}},h.personalizationProcessor=function(e){if(null!=e&&1<=Object.keys(e).length){if(!(e=h.filterProperties(e.add,{key:32,value:32,object:1},["number","string"])))return void p.Helper.displayLog("Invalid Json Data");h.syncProperties("PersonalProperties","",e)}},h.userProfileProcessor=function(e){var o,i="",t={key:32,value:32,object:64};if(h.hasSynclimitReached("userProperty"))p.Helper.displayLog("Sync aborted! : Daily/monthly limit reached!");else if(null!=e&&1<=Object.keys(e).length){if(void 0!==e.add&&1<=Object.keys(e.add).length)o=h.filterProperties(e.add,t),i="add";else{if(!(void 0!==e.remove&&1<=Object.keys(e.remove).length))return void p.Helper.displayLog("Invalid JSON format");o=h.filterProperties(e.remove,t),i="remove"}if(!o)return void p.Helper.displayLog("Invalid Json Data");if(h.isPropertySynced(o,i))return p.Helper.displayLog("This property already synced : ",o),void(1==O.Config.debugger.status&&(t="User Property: Already Sent to "+O.Config.brandingPartner,S.Debugger.log(t+" "+JSON.stringify(o),O.Config.debugger.successCode)));h.syncProperties("SegmentProperties",i,o,function(e,t){200==t&&(h.increaseSyncCount("userProperty"),h.propertySynced("userProperty",o,i))})}},h.propertySynced=function(e,o,i){var n;void 0===i&&(i="add"),"userProperty"==e&&(n=l.Storage.getStorage(b.KeyMapper.IZOOTO_USER_PROPERTY),(n=p.Helper.parseToJSON(n))&&"object"==typeof n?Object.keys(o).forEach(function(t){Array.isArray(o[t])?"add"==i?(0==Array.isArray(n[t])&&(n[t]=[]),o[t].forEach(function(e){-1<n[t].indexOf(e)==0&&n[t].push(e)})):"remove"==i&&Array.isArray(n[t])&&(o[t].forEach(function(e){e=n[t].indexOf(e);-1<e&&n[t].splice(e,1)}),0==n[t].length&&delete n[t]):"remove"==i?delete n[t]:n[t]=o[t]}):n=o,l.Storage.setStorage(b.KeyMapper.IZOOTO_USER_PROPERTY,JSON.stringify(n)))},h.isPropertySynced=function(e,t){void 0===t&&(t="add");var o=l.Storage.getStorage(b.KeyMapper.IZOOTO_USER_PROPERTY);if(!(o=p.Helper.parseToJSON(o))||"remove"==t)return!1;if(o&&"object"==typeof o){var t=Object.keys(e),i=Object.keys(o);if(0==t.every(function(e){return-1<i.indexOf(e)}))return!1;for(var n=!1,r=0,a=t;r<a.length;r++){if("break"===function(t){if(Array.isArray(e[t])){if(0==e[t].every(function(e){return-1<o[t].indexOf(e)}))return n=!0,"break"}else if(o.hasOwnProperty(t)&&o[t]!=e[t])return n=!0,"break"}(a[r]))break}if(n)return!1}return!0},h.filterData=function(e){if("string"==typeof e)return e},h.parseData=function(e){return"string"==typeof e?e.trim():"number"==typeof e?e.toString().trim():e},h.validateData=function(e){if(e.length<=32&&e.length)return!0},h.filterProperties=function(l,g,d){void 0===d&&(d=["number","string","boolean","object"]);try{var f={},u=0;if("object"==typeof l)return Object.keys(l).map(function(e){var t=e;if(e=e.substring(0,g.key),u<g.object&&""!=e.trim()&&e.length<=g.key){var o=(o=e.toLowerCase()).trim(),i=l[t];if("string"==typeof i&&""!=i&&-1<d.indexOf(typeof i)){e=(i=i.trim()).substring(0,g.value),t=new RegExp("^(https?)://");""!=i&&(i.length<=g.value||t.test(i))?f[o]=i:f[o]=e,u++}else if("object"==typeof i&&-1<d.indexOf(typeof i)){if(i instanceof Array&&1<=i.length){var n,r=i,a=[],s=0;for(n in r){var c,p=r[n];"number"==typeof(p=p.substring(0,g.value))&&null!=p&&s<=g.object&&p.toString().length<=g.value?(c=p,a.push(c),s++):"string"==typeof p&&""!=p.trim()&&s<=g.object&&p.trim().length<=g.value&&(c=p.trim(),a.push(c),s++)}1<=a.length&&(f[o]=a,u++)}}else("boolean"==typeof i&&-1<d.indexOf(typeof i)||"number"==typeof i&&-1<d.indexOf(typeof i)&&(i.toString().length<=g.value&&null!=i||-1<O.Config.notification.allowedKeys.indexOf(o)))&&(f[o]=i,u++)}}),f}catch(e){}return!1},h.setUuidDb=function(t){s.IndexedDB.init().then(function(e){s.IndexedDB.addUpdate(e,"uid",t).then(function(e){p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)})},h.setIzcidDb=function(t){s.IndexedDB.init().then(function(e){s.IndexedDB.addUpdate(e,"IZCID",t).then(function(e){p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)})},h.getIzCidPromise=function(){return new Promise(function(e,t){var o,i=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_IZCID),n=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_IZCID,b.KeyMapper.IZOOTO_SYNC);""==i||""==n?(p.Helper.addMsgReciever(h.msgReciever),h.setCookieGlobalID(),""!=(o=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_IZCID))?e(o):setTimeout(function(){e(o),o&&"undefined"!=o&&h.setIzcidDb(o)},2500)):(e(i),i&&"undefined"!=i&&h.setIzcidDb(i))}).catch(function(e){p.Helper.displayLog(e)})},h.setSubscriberIdFromDb=function(){return new Promise(function(t,e){s.IndexedDB.init().then(function(e){p.Helper.displayLog("Getting subscriberId from Db"),s.IndexedDB.getIndexDBData(e,"options","subscriberId").then(function(e){e?(p.Helper.displayLog("Subscriber id found from db: ",e.val),O.Config.store.subscriberId=e.val,t(O.Config.store.subscriberId)):(p.Helper.displayLog("Subscriber id not found "),t(!1))}).catch(function(e){p.Helper.displayLog("Error in getting subscriber id",e)})}).catch(function(e){p.Helper.displayLog(e)})})},h.setCookieGlobalID=function(){var e;1==O.Config.izootoStatus&&(e=h.addIFrame("https://cdn.izooto.com/scripts/sak/iz_setcid.html","izsetcgid"),setTimeout(function(){try{document.body.removeChild(e)}catch(e){p.Helper.displayLog("Unable to set cookieGlobalID : ",e)}},2500))},h.isIncognitoMode=function(){return new Promise(function(e,t){if(1==O.Config.global.browserType||4==O.Config.global.browserType){var o=window.RequestFileSystem||window.webkitRequestFileSystem;return o?o(window.TEMPORARY,100,function(){e(!1)},function(){e(!0)}):void e(!1)}7==O.Config.global.browserType?window.indexedDB||!window.PointerEvent&&!window.MSPointerEvent?e(!1):e(!0):3==O.Config.global.browserType?((o=indexedDB.open("test")).onsuccess=function(){e(!1)},o.onerror=function(){e(!0)}):e(!1)})},h.updatePromptCount=function(e){var t=0;e==b.KeyMapper.IZOOTO_PROMPTED?(t=""!=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PROMPT_COUNT,b.KeyMapper.IZOOTO_STATS)?l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PROMPT_COUNT,b.KeyMapper.IZOOTO_STATS)+1:1,l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PROMPT_COUNT,t,b.KeyMapper.IZOOTO_STATS)):e==b.KeyMapper.IZOOTO_OPTIN_SHOWN&&(t=""!=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_OPTIN_SHOWN_COUNT,b.KeyMapper.IZOOTO_STATS)?l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_OPTIN_SHOWN_COUNT,b.KeyMapper.IZOOTO_STATS)+1:1,l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_OPTIN_SHOWN_COUNT,t,b.KeyMapper.IZOOTO_STATS))},h.getSubscriptionKey=function(e){if(!e)return"";if("string"==typeof(e=h.subcriptionToObject(e)))return e;var t=e.endpoint,e=O.Config.global.browserName;return e==b.KeyMapper.BROWSER_FIREFOX?t.substring(48):(e==b.KeyMapper.BROWSER_OPERA||e==b.KeyMapper.BROWSER_CHROME)&&null!=t&&0<=t.indexOf("fcm.googleapis.com")?t.substring(36):e==b.KeyMapper.BROWSER_EDGE?encodeURIComponent(t.substring(41)):e==b.KeyMapper.BROWSER_UCB?t.substring(36):t.substring(40)},h.getSubscriptionParameters=function(e){try{return 3==O.Config.notification.subscriptionType?"&bKey="+p.Helper.getCurrentUUID()+"&st="+e:2==O.Config.notification.subscriptionType?(e=h.subcriptionToObject(e),("&ep="+(7==O.Config.global.browserType?encodeURIComponent(e.endpoint):e.endpoint)+"\n\t\t\t\t&bKey="+p.Helper.getCurrentUUID()+"\n\t\t\t\t&auth="+e.keys.auth+"\n\t\t\t\t&pk="+e.keys.p256dh+"\n\t\t\t\t&vpk="+O.Config.notification.vapidKey+"\n\t\t\t   ").replace(/^\s+|\s+$/gm,"").split("\n").join("")):1==O.Config.notification.subscriptionType?"&bKey="+p.Helper.getCurrentUUID()+"&fe=1&ft="+e:""}catch(e){return p.Helper.displayLog("Error in getSubscriptionParameters",e),""}},h.getExtraParameterToSync=function(i){var e=(new Date).getTimezoneOffset(),n=("&tz="+(e+=330)+"\n\t\t\t\t\t\t\t&pt="+O.Config.notification.promptType+"\n\t\t\t\t\t\t\t&pte="+O.Config.notification.subscriptionType+" \n\t\t\t\t\t\t\t&ge="+O.Config.notification.gdprPromptStatus+"\n\t\t\t\t\t\t\t&ndc="+l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PROMPT_COUNT,b.KeyMapper.IZOOTO_STATS)).replace(/^\s+|\s+$/gm,"").split("\n").join(""),e=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PROMPT_COUNT,b.KeyMapper.IZOOTO_STATS);return e&&(n+="&sdc="+e),""!=O.Config.notification.optInDesignType&&(0==O.Config.notification.promptType?n+="&optin=0":n+="&optin="+O.Config.notification.optInDesignType),new Promise(function(t,e){var o;i==b.KeyMapper.IZOOTO_PROMPT_ALLOWED||i==b.KeyMapper.IZOOTO_ALREADY_GRANTED?((o=O.Config.notification.serviceWorkerVersion)&&"undefined"!=o&&t(n+"&sw="+O.Config.notification.serviceWorkerVersion),h.getswVersion().then(function(e){t(e&&"undefined"!=e?(n+"&sw="+e).replace(/^\s+|\s+$/gm,"").split("\n").join(""):n)}).catch(function(e){t(n),p.Helper.displayLog("Error while getting sw version")})):t(n)}).catch(function(e){p.Helper.displayLog(e)})},h.getswVersion=function(){return new Promise(function(o,i){s.IndexedDB.init().then(function(e){s.IndexedDB.getIndexDBData(e,"options","swVer").then(function(e){var t=e.val;e.hasOwnProperty("key")?o(t):i(!1)}).catch(function(e){p.Helper.displayLog(e),i(!1)})}).catch(function(e){p.Helper.displayLog(e),i(!1)})}).catch(function(e){p.Helper.displayLog(e)})},h.getDeviceParameters=function(){return("pid="+O.Config.client+"\n\t\t&izcid="+l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_IZCID)+"\n\t\t&ht="+("https:"==O.Config.global.locationProtocol?1:0)+"\n\t\t&btype="+O.Config.global.browserType+"\n\t\t&dtype="+O.Config.global.deviceType+"\n\t\t&bver="+O.Config.global.browserVer+"\n\t\t&os="+O.Config.global.os).replace(/^\s+|\s+$/gm,"").split("\n").join("")},h.createWelcomeNotification=function(){var e;1===O.Config.notification.welcomeNotification.status&&""!=O.Config.notification.welcomeNotification.icon&&""!=O.Config.notification.welcomeNotification.title&&""!=O.Config.notification.welcomeNotification.body&&((e=new window.Notification(O.Config.notification.welcomeNotification.title,{icon:O.Config.notification.welcomeNotification.icon,body:O.Config.notification.welcomeNotification.body,tag:"welcome"})).addEventListener("click",function(){""!=O.Config.notification.welcomeNotification.url?(e.close(),window.open(O.Config.notification.welcomeNotification.url,"_blank")):e.close()}),0<O.Config.notification.welcomeNotification.timeout&&setTimeout(function(){e.close()},O.Config.notification.welcomeNotification.timeout))},h.showWelcomeNotificationOld=function(e){p.Helper.displayLog("Welcome notification initiated..."),1===O.Config.notification.welcomeNotification.status&&""!=O.Config.notification.welcomeNotification.icon&&""!=O.Config.notification.welcomeNotification.title&&""!=O.Config.notification.welcomeNotification.body&&1==O.Config.notification.isSdkHttps&&h.createWelcomeNotification()},h.sendLocalNotification=function(a){return navigator.serviceWorker.ready.then(function(e){var t={},o={};o.pid=a.key,o.link=a.link,o.cid=a.id,o.rid=a.rid,o.viewFlag=a.viewFlag,o.clickFlag=a.clickFlag,o.sysEvents=a.sysEvents,o.domainNum=a.domainNum;var i={body:a.message,icon:a.icon,requireInteraction:a.reqInt,tag:a.tag,image:a.banner,data:o};if(0<a.act_num&&a.act1name&&a.act1link){var n,r={action:"action1",title:a.act1name};return a.hasOwnProperty("act1icon")&&""!=a.act1icon&&(r.icon=a.act1icon),o.act1link=a.act1link,t=[r],2==a.act_num&&a.act2name&&a.act2link&&(n={action:"action2",title:a.act2name},a.hasOwnProperty("act2icon")&&""!=a.act2icon&&(n.icon=a.act2icon),o.act2link=a.act2link,t=[r,n]),i.actions=t,e.showNotification(a.title,i)}return e.showNotification(a.title,i)})},h.customizeOptInPrompt=function(e){var t={title:50,message:100,allowButton:10,laterButton:10};try{for(var o in e)""!=e[o]&&(e[o]=e[o].trim(),"title"==o?O.Config.notification.promptDesign.message=e[o].substring(0,t[o]):"message"==o?O.Config.notification.promptDesign.subMessage=e[o].substring(0,t[o]):"icon"!=o||!e[o].startsWith("http://")&&!e[o].startsWith("https://")||e[o].includes("panel.izooto")?"allowButton"==o?O.Config.notification.promptDesign.btn2Txt=e[o].substring(0,t[o]):"laterButton"==o&&(O.Config.notification.promptDesign.btn1Txt=e[o].substring(0,t[o])):O.Config.notification.promptDesign.icon=e[o])}catch(e){p.Helper.displayLog(e)}},h.registerServiceWorker=function(i){return new Promise(function(e,t){var o;"serviceWorker"in navigator?(o=(o=O.Config.notification.serviceWorkerScope)?{scope:o}:void 0,navigator.serviceWorker.register(i,o).then(function(){O.Config.notification.windowType||(s.IndexedDB.setIndexedDb("gaId"),s.IndexedDB.setIndexedDb("sysEvents")),e(!0)}).catch(function(e){t(e),p.Helper.displayLog(e)})):(p.Helper.displayLog("Service workers are not supported in this browser."),t("Service workers are not supported in this browser."))}).catch(function(e){p.Helper.displayLog(e)})},h.getSubscription=function(){var i=this;return new Promise(function(t,o){h.registerServiceWorker(O.Config.notification.serviceWorkerPath).then(function(e){navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){p.Helper.displayLog("Get Subscription found : ",JSON.stringify(e)),e||(p.Helper.displayLog("Re-subscribing"),O.Config.store.isSubscriptionLost=!0),i.subscribe(b.KeyMapper.IZOOTO_ALREADY_GRANTED).then(function(){t(!0)})}).catch(function(e){p.Helper.displayLog("Error during getSubscription()",e),o("Error during getSubscription()")})})})}).catch(function(e){p.Helper.displayLog(e)})},h.subscribe=function(i){return n(this,void 0,void 0,function(){return r(this,function(e){O.Config.notification.subscriptionObj={userVisibleOnly:!0,applicationServerKey:p.Helper.urlB64ToUint8Array(O.Config.notification.vapidKey)};try{return[2,new Promise(function(o,e){p.Helper.displayLog("Subscription initiated..."),navigator.serviceWorker.ready.then(function(t){t.pushManager.subscribe(O.Config.notification.subscriptionObj).then(function(e){p.Helper.displayLog("Subscrption : ",JSON.stringify(e)),h.sendEvent(i,JSON.stringify(e)),o(!0)}).catch(function(e){p.Helper.displayLog("Unable to subscribe due to error : ",e),t.unregister().then(function(){h.registerServiceWorker(O.Config.notification.serviceWorkerPath).then(function(){p.Helper.displayLog("Re-subscribing..."),O.Config.store.isSubscriptionLost=!0,h.subscribe(i).then(function(){o(!0)})})})})})})]}catch(e){p.Helper.displayLog(e)}return[2]})})},h.unsubscribeNotification=function(){p.Helper.displayLog("Notification unsubscribe is initiated..."),navigator.serviceWorker.ready.then(function(e){e.pushManager.getSubscription().then(function(e){e&&e.unsubscribe().then(function(e){p.Helper.displayLog("Unsubscribed : ",e)}).catch(function(e){p.Helper.displayLog("Unsubscription failed : ",e)})}).catch(function(e){p.Helper.displayLog("Get subscription failed : ",e)})}).catch(function(e){})},h.closePopupWindow=function(){if(self==top&&O.Config.notification.windowType)try{setTimeout(function(){var e={};e[b.KeyMapper.IZOOTO_POPUP_CLOSED]=1;var t={};t[b.KeyMapper.IZOOTO_MESSAGE]=e,null!==(e=window.opener)&&void 0!==e&&e.postMessage(JSON.stringify(t),"*"),window.close()},1e3)}catch(e){p.Helper.displayLog("Unable to close popup",e)}},h.removeSubsriptionFromAlternateDomain=function(){var t=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_ALT_DOMAIN_STATUS);if(""!=t)try{t=JSON.parse(t),h.alternateDomainJson=t}catch(e){t=""}if("object"==typeof O.Config.notification.sourceOriginAlt&&1<O.Config.notification.sourceOriginAlt.length){var e=O.Config.notification.sourceOriginAlt.length;h.alternateDomainPermissionHandler(0,e-1,h.alternateDomainJson)}else{e="object"==typeof O.Config.notification.sourceOriginAlt?O.Config.notification.sourceOriginAlt[0]:O.Config.notification.sourceOriginAlt,e=h.getAlternateDomainConfig(h.alternateDomainJson,h.permissionDomain=e);if(3==e||2==e)return;p.Helper.addMsgReciever(h.msgReciever),"https:"==O.Config.global.locationProtocol?h.addIFrame(h.permissionDomain+"?action=izrmsubs&izHardUnsub=1","izAltSubFrame"):h.addIFrame(h.permissionDomain+"?action=izrmsubs","izAltSubFrame")}},h.removeSubscriptionReceiver=function(e){3==e&&(h.setAlternateDomainConfig(h.alternateDomainJson,h.permissionDomain,e),"object"==typeof O.Config.notification.sourceOriginAlt&&h.alternateDomainIndex<O.Config.notification.sourceOriginAlt.length&&h.alternateDomainPermissionHandler(h.sourceOriginIndex,O.Config.notification.sourceOriginAlt.length-1,h.alternateDomainJson))},h.alternateDomainPermissionHandler=function(e,t,o){for(var i=e;i<=t;i++){h.permissionDomain=O.Config.notification.sourceOriginAlt[i];var n=h.getAlternateDomainConfig(o,h.permissionDomain);if(h.sourceOriginIndex=i+1,3!=n&&2!=n){p.Helper.addMsgReciever(h.msgReciever),"https:"==O.Config.global.locationProtocol?h.addIFrame(h.permissionDomain+"?action=izrmsubs&izHardUnsub=1","izAltSubFrame"+i):h.addIFrame(h.permissionDomain+"?action=izrmsubs","izAltSubFrame"+i);break}if(i==t)return}},h.getAlternateDomainConfig=function(e,t){return null!=e[t]?e[t]:""},h.setAlternateDomainConfig=function(e,t,o){e=""!=e?e:{};e[t]=o,h.alternateDomainJson=e,e=JSON.stringify(e),l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_ALT_DOMAIN_STATUS,e)},h.removeSubscriptionInFrame=function(){var e="rmSubToParent",t={izrmstatus:3},o=document.location.href,i=p.Helper.getParamFromUrl(o,"izHardUnsub");try{var n=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN);1==i?(h.unsubscribeNotification(),p.Helper.postMessage("parent",e,t)):""!=n?(n=p.Helper.getCurrentUUID(),h.sendSubscriptionUpdate(n,2,function(){p.Helper.postMessage("parent",e,t)})):p.Helper.postMessage("parent",e,t)}catch(e){}},h.syncLastVisit=function(){var e=p.Helper.getLanguage(),t=p.Helper.getMetaValue("keywords"),o={last_website_visit:!0};""!=e&&(o.lang=e),""!=t&&(o.keywords=t);var i=new Date,e=l.Storage.getConfigLocal("lastVisit",b.KeyMapper.IZOOTO_SYNC),t=!1;e&&(t=new Date(e).getDate()),h.syncAllSubscribersVisit(),""!=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN)&&i.getDate()!==t?(i=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),i=p.Helper.isJSONString(i)?p.Helper.parseToJSON(i):i,t="pid="+O.Config.client,t+=h.getSubscriptionParameters(i),t+="&et=userp&act=add",t+="&val="+JSON.stringify(o),g.HttpRequest.post(p.Helper.getEndpoint("last_visit"),{data:t},function(){l.Storage.updateLastSync("lastVisit"),p.Helper.displayLog("Last visit sync successfully")})):p.Helper.displayLog("Sync last Visit Blocked")},h.syncAllSubscribersVisit=function(){var e,t,o,i,n;1==O.Config.notification.syncVisitType&&(e=p.Helper.getEndpoint("syncAllSubscribersVisit"),t=p.Helper.getLanguage(),o=p.Helper.getMetaValue("keywords"),i=encodeURIComponent([window.location.protocol,"//",window.location.host,window.location.pathname].join("")),n="pid="+O.Config.client,n+="&bkey="+p.Helper.getCurrentUUID(),n+="&url="+i,""!=o&&(n+="&keywords="+o),""!=t&&(n+="&lang="+t),g.HttpRequest.post(e,{data:n},function(){}))},h.applyBrowserPatch=function(){1==O.Config.global.browserType&&0==O.Config.notification.promptType&&(61<parseInt(O.Config.global.browserVer)||60<parseInt(O.Config.global.browserVer)&&1!=O.Config.global.deviceType)&&(!O.Config.notification.isSdkHttps||O.Config.notification.isSdkHttps&&"http:"==O.Config.global.locationProtocol)&&(O.Config.notification.promptType=1,O.Config.notification.optInDesignType||(O.Config.notification.optInDesignType=1)),2==O.Config.global.browserType&&0==O.Config.notification.promptType&&12.1<=parseFloat(O.Config.global.browserVer)&&(O.Config.notification.promptType=1,O.Config.notification.optInDesignType||(O.Config.notification.optInDesignType=1)),3==O.Config.global.browserType&&0==O.Config.notification.promptType&&72<=O.Config.global.browserMajorVersion&&(O.Config.notification.promptType=1,O.Config.notification.optInDesignType||(O.Config.notification.optInDesignType=1))},h.isSupported=function(){return n(this,void 0,void 0,function(){var t,o,i,n;return r(this,function(e){switch(e.label){case 0:return(t=O.Config.global.browserName)==b.KeyMapper.BROWSER_FIREFOX&&"http:"==O.Config.global.locationProtocol?(p.Helper.displayLog("Firefox http detected!"),h.sendEvent(b.KeyMapper.IZOOTO_BROWSER_UNSUPPORTED),[2,!1]):(i=(o=p.Helper).displayLog,n=["Checking incognito : "],[4,h.isIncognitoMode()]);case 1:return i.apply(o,n.concat([e.sent()])),[4,h.isIncognitoMode()];case 2:if(e.sent())return p.Helper.displayLog("Incognito mode detected!"),h.sendEvent(b.KeyMapper.IZOOTO_BROWSER_UNSUPPORTED),[2,!1];if(h.checkVersionSuppport())if(t==b.KeyMapper.BROWSER_CHROME||t==b.KeyMapper.BROWSER_OPERA||t==b.KeyMapper.BROWSER_UCB||t==b.KeyMapper.BROWSER_FIREFOX||t==b.KeyMapper.BROWSER_EDGE){if("https:"!=O.Config.global.locationProtocol||!(O.Config.notification.isSdkHttps||1==O.Config.notification.windowType&&0==O.Config.notification.isSdkHttps))return[2,!0];if("Notification"in window&&"serviceWorker"in navigator)return[2,!0]}else if(t==b.KeyMapper.BROWSER_SAFARI&&"safari"in window&&"pushNotification"in window.safari)return[2,!0];return h.sendEvent(b.KeyMapper.IZOOTO_BROWSER_UNSUPPORTED),[2,!1]}})})},h.checkVersionSuppport=function(){var e=O.Config.global.browserName,t=O.Config.global.browserMajorVersion,o=O.Config.global.deviceType;switch(e){case b.KeyMapper.BROWSER_CHROME:if(42<=t)return!0;break;case b.KeyMapper.BROWSER_SAFARI:if(7<=t&&1==o)return!0;break;case b.KeyMapper.BROWSER_FIREFOX:if(48<=t&&1!=o)return!0;if(44<=t)return!0;break;case b.KeyMapper.BROWSER_UCB:case b.KeyMapper.BROWSER_OPERA:case b.KeyMapper.BROWSER_EDGE:return!0;default:p.Helper.displayLog("Browser not supported for Notification!")}return!1},h.loadOptin=function(){var e=O.Config.notification.optInSrc+""+O.Config.notification.optInDesignType+".js?v=3";""!=O.Config.notification.optInDesign?(O.Config.notification.dialogDesign=O.Config.notification.optInDesign,h.showOptin()):null!=window.izOptinDesign&&""!=window.izOptinDesign?(O.Config.notification.dialogDesign=window.izOptinDesign,h.showOptin()):p.Helper.addExternalJS(e,"izOptin",!0)},h.showOptin=function(){var e;if(null!=window.izOptinDesign&&(O.Config.notification.dialogDesign=window.izOptinDesign),O.Config.notification.dialogDesign=h.loadDesign(O.Config.notification.promptDesign,O.Config.notification.dialogDesign),O.Config.notification.dialogDesign=h.dynamicBrandingPartnerHandler(O.Config.notification.dialogDesign),p.Helper.addHTML("div",O.Config.notification.dialogDesign,"izmiddle-box"))try{O.Config.brandingPartner!=O.Config.defaultBrandingPartner&&null!==(e=window.document.querySelector("#izmiddle-box a"))&&void 0!==e&&e.setAttribute("onclick","return false;")}catch(e){}h.izootoBrandingHandler(),h.sendEvent(b.KeyMapper.IZOOTO_OPTIN_SHOWN)},h.dynamicBrandingPartnerHandler=function(e){return O.Config.brandingPartner!=O.Config.defaultBrandingPartner&&(e=O.Config.notification.dialogDesign.replace("iZooto",O.Config.brandingPartner)),e},h.loadDesign=function(e,t){try{if("object"!=typeof e)return"";for(var o in e){var i;e.hasOwnProperty(o)&&(i=new RegExp("{{--"+o+"--}}","g"),t=t.replace(i,e[o]))}}catch(e){}return t},h.addIFrame=function(e,t,o){try{var i=document.createElement("IFRAME");return i.setAttribute("src",e),i.setAttribute("id",t),i.style.width="0px",i.style.height="0px",i.style.border="0px",i.setAttribute("visibility","hidden"),i.style.display="none",(null!=document.body?document.body:document.head).appendChild(i),p.Helper.displayLog("Set : ",t),i}catch(e){p.Helper.displayLog("Unable to subFrame : ",e)}},h.getPermissionStatusFromFrame=function(){return new Promise(function(t,e){p.Helper.addMsgReciever(function(e){e=p.Helper.parseToJSON(e.data);!e.hasOwnProperty(b.KeyMapper.IZOOTO_MESSAGE)||(e=e[b.KeyMapper.IZOOTO_MESSAGE]).hasOwnProperty("izPermsStatus")&&null!=e.izPermsStatus&&t(e.izPermsStatus)},!0);var o=O.Config.notification.sourceOrigin+"?action=izcheckperms";h.addIFrame(o,"izPermsFrame")})},h.getSubDomainPermissionStatus=function(){return new Promise(function(t,e){var o=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),i=l.Storage.getStorage(b.KeyMapper.IZOOTO_PERMISSION_STATUS),n=h.getPermissionStatusFromStorage();0!=n||2==i?t(n):"https:"==O.Config.global.locationProtocol?h.getPermissionStatusFromFrame().then(function(e){1==e&&""!=o&&(e=0),h.updatePermissionStatus(e),t(e)}):""!=o?h.tokenValidator(function(e){h.updatePermissionStatus(e),t(e)}):t(n)}).catch(function(e){p.Helper.displayLog(e)})},h.setRepeatPromptDelay=function(e){var t;0!==e&&(t=(t=new Date).setTime(t.getTime()+60*e*1e3),p.Helper.displayLog("Setting repeat prompt delay for "+e+" minutes"),l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_REPEAT_PROMPT_DELAY,t))},h.setActivePrompt=function(e){var t;("https:"===O.Config.global.locationProtocol&&0==O.Config.notification.windowType||"http:"===O.Config.global.locationProtocol)&&(window.addEventListener("beforeunload",function(){l.Storage.removeStorage("izootoActivePrompt")}),t=(t=new Date).setTime(t.getTime()+60*e*1e3),l.Storage.setStorage("izootoActivePrompt",t))},h.isActivePrompt=function(){var e=new Date;return l.Storage.getStorage("izootoActivePrompt")>e.getTime()&&(p.Helper.displayLog("Notification prompt is already opened in another tab!"),!0)},h.updatePermissionStatus=function(e){e===b.KeyMapper.IZOOTO_PROMPT_ALLOWED||e===b.KeyMapper.IZOOTO_ALREADY_GRANTED||1===e?l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS,1):e===b.KeyMapper.IZOOTO_PROMPT_DENIED||e===b.KeyMapper.IZOOTO_ALREADY_DENIED||2==e?l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS,2):l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS,0),l.Storage.updateLastSync(b.KeyMapper.IZOOTO_PERMISSION_STATUS)},h.sendPermissionStatusFromFrame=function(){var e=0;"Notification"in window&&"granted"==window.Notification.permission&&(e=1),p.Helper.postMessage("parent","izPermsStatus",e)},h.updateSubscriptionProcessor=function(e,t){var o=p.Helper.getCurrentUUID(),i=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS);t=l.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN);t=h.getSubscriptionKey(t);"subscribe"==e?O.Config.store.isSoftSubscribeTriggered||(""!=t&&""!=o&&h.sendSubscriptionUpdate(o,0,function(){p.Helper.displayLog("Re-Subscribing")}),O.Config.store.isSoftSubscribeTriggered=!0,3==i&&l.Storage.removeConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS),h.triggerPromptHandler()):"unsubscribe"==e&&""!=t&&""!=o&&h.sendSubscriptionUpdate(o,2,function(){l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS,3),h.sendEvent(b.KeyMapper.IZOOTO_UNSUBSCRIBED)})},h.sendSubscriptionUpdate=function(e,t,o){var i=0==t?p.Helper.getEndpoint("SoftSubscribe"):2==t?p.Helper.getEndpoint("SoftUnsubscribe"):p.Helper.getEndpoint("supUrl"),t={data:h.getDeviceParameters()+"&bKey="+e+"&action="+t};g.HttpRequest.post(i,t,o)},h.isScreenScrollable=function(){try{var e=document.body,t=e.parentNode,e=e.scrollHeight-e.clientHeight;if("CSS1Compat"==document.compatMode&&(e=t.scrollHeight-t.clientHeight),2<=e/window.screen.availHeight)return!0}catch(e){}return p.Helper.displayLog("This page is not scrollable!"),!1},h.scrollHandler=function(e){var t=window.screen.availHeight,o=window.scrollY;1!=O.Config.notification.isTriggeredOnScoll&&(t<=o||document.documentElement.scrollTop>=t)&&(p.Helper.displayLog("Trigger on scroll called"),O.Config.notification.isTriggeredOnScoll=1,e())},h.brandingOverlayHandler=function(){1==O.Config.notification.overlay?h.openHttpsOverlay():1==O.Config.notification.branding&&(p.Helper.displayLog("Enabling branding"),h.openHttpsBranding())},h.izootoBrandingHandler=function(){if(0==O.Config.notification.branding)try{var e,t=document.getElementsByClassName("izbranding");for(e in t)t[e].style.display="none",p.Helper.displayLog("Branding Disabled")}catch(e){}},h.openHttpsBranding=function(){var e;if(!(0<O.Config.notification.windowType)&&0!=O.Config.notification.branding){if(1!=p.Helper.getDeviceType())try{window.addEventListener("scroll",h.brandingScroll)}catch(e){}if(p.Helper.addHTML("div",O.Config.notification.httpsBranding,"izooto-branding"))try{O.Config.brandingPartner!=O.Config.defaultBrandingPartner&&null!==(e=window.document.querySelector("#izooto-branding a"))&&void 0!==e&&e.setAttribute("onclick","return false;")}catch(e){}h.izootoBrandingHandler()}},h.openHttpsOverlay=function(){var e;if(!(0<O.Config.notification.windowType)&&0!=O.Config.notification.overlay){if(1!=p.Helper.getDeviceType())try{window.addEventListener("scroll",h.brandingScroll)}catch(e){}if((O.Config.global.browserName=b.KeyMapper.BROWSER_CHROME)&&62<parseInt(p.Helper.getBrowserVersion())&&3==p.Helper.getDeviceType()&&(O.Config.notification.httpsOverlay=""),p.Helper.addHTML("div",O.Config.notification.httpsOverlay,"izooto-branding"))try{O.Config.brandingPartner!=O.Config.defaultBrandingPartner&&null!==(e=window.document.querySelector("#izooto-branding a"))&&void 0!==e&&e.setAttribute("onclick","return false;")}catch(e){}h.izootoBrandingHandler()}},h.brandingScroll=function(){null!=document.getElementById("izooto-branding")&&(30<window.pageYOffset||30<document.body.scrollTop)&&h.closeHttpsOverlay()},h.closeHttpsOverlay=function(){var e;if(!(0<O.Config.notification.windowType)){try{null!==(e=document.getElementById("izooto-branding"))&&void 0!==e&&e.remove()}catch(e){p.Helper.displayLog("Error-Removing-Div"+e)}if(1!=p.Helper.getDeviceType())try{window.removeEventListener("scroll",h.brandingScroll)}catch(e){}}},h.popupNotice=function(e){try{document.getElementById("dynamic_iz").innerHTML="<center>"+e+"</center>"}catch(e){}},h.setManifest=function(){try{if(1!=O.Config.global.browserType||0!=O.Config.notification.subscriptionType)return;var e=document.getElementsByTagName("head")[0],t=document.createElement("link");t.rel="manifest",t.href=O.Config.notification.manifest,e.appendChild(t),p.Helper.displayLog("Manifest setup done!")}catch(e){}},h.tokenValidator=function(i,e){p.Helper.displayLog("Validating token..."),null==e&&(e=p.Helper.getCurrentUUID());e=p.Helper.getEndpoint("subscriptionValidator")+"?s=1&bkey="+e+"&pid="+O.Config.client;g.HttpRequest.get(e,function(e,t){var o=1;if(200==t&&(p.Helper.displayLog("Response : ",e),e=p.Helper.parseToJSON(e),null!=i))return e.hasOwnProperty("status")&&0==e.status&&(o=0),void i(o)})},h.checkAlternates=function(){"object"==typeof window._izAlternate?(null!=window._izAlternate.initAlt&&"function"==typeof window._izAlternate.initAlt&&window._izAlternate.initAlt(),Object.keys(window._izAlternate).map(function(o,e){Object.keys(window._izooto).map(function(e,t){e===o&&(window._izooto[e]=window._izAlternate[o])})})):p.Helper.displayLog("No alternate implementations found")},h.subcriptionToObject=function(e){return"string"==typeof e&&p.Helper.isJSONString(e)&&(e=p.Helper.parseToJSON(e)),e},h.isCurrentTokenExpired=function(e,t){var o=l.Storage.getConfigLocal(t,b.KeyMapper.IZOOTO_SYNC),t=new Date;return!(t.getTime()<t.setTime(o+1e3*e))},h.isPermissionStatusExpired=function(e){return 1==e&&h.isCurrentTokenExpired(O.Config.notification.tokenExpire,b.KeyMapper.IZOOTO_PERMISSION_STATUS)},h.getPermissionStatusFromStorage=function(){var e=0,t=l.Storage.getConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS);return""==t||this.isPermissionStatusExpired(t)||(e=t),e},h.isHttpsSitePermissionAlreadyGranted=function(){var t=this;return new Promise(function(o,e){return n(t,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return(t=O.Config.notification.isSdkHttps)?[4,h.isSupported()]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t&&"granted"==window.Notification.permission&&2!=O.Config.global.browserType?o(!0):o(!1),[2]}})})})},h.getWindowType=function(){var e=window.location.href,t="";return-1!==(t=e.substr(e.lastIndexOf("?")+1)).indexOf("action=prompt")?1:-1!==t.indexOf("action=izrmsubs")?2:-1!==t.indexOf("action=izcheckmaster")?3:"action=izcheckperms"==t?4:-1!==t.indexOf("action=izvalidator&izObj=")?5:-1!==t.indexOf("action=noroot")?6:0},h.msgReciever=function(e){var t=p.Helper.parseToJSON(e.data);t.hasOwnProperty(b.KeyMapper.IZOOTO_MESSAGE)&&(e=t[b.KeyMapper.IZOOTO_MESSAGE],p.Helper.displayLog("Received event : ",e),"izCidToParent"==(null==e?void 0:e.k)?(h.setIzcidDb(e.v),l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_IZCID,e.v),l.Storage.updateLastSync("IZCID")):e.hasOwnProperty("rmSubToParent")&&void 0!==e.rmSubToParent?h.removeSubscriptionReceiver(e.rmSubToParent.izrmstatus):e.hasOwnProperty(b.KeyMapper.IZOOTO_MASTER_TO_CHILD)&&void 0!==e[b.KeyMapper.IZOOTO_MASTER_TO_CHILD]?C.MasterDomain.masterConfigReciver(e[b.KeyMapper.IZOOTO_MASTER_TO_CHILD]):e.hasOwnProperty(b.KeyMapper.IZOOTO_CHILD_TO_MASTER)&&void 0!==e[b.KeyMapper.IZOOTO_CHILD_TO_MASTER]?C.MasterDomain.setMasterStorage(e[b.KeyMapper.IZOOTO_CHILD_TO_MASTER]):e.hasOwnProperty("izPermsStatus")?(l.Storage.setConfigLocal(b.KeyMapper.IZOOTO_PERMISSION_STATUS,e.izPermsStatus),l.Storage.updateLastSync(b.KeyMapper.IZOOTO_PERMISSION_STATUS)):e.hasOwnProperty("syncWelcomeSent")?h.showWelcomeNotification(!0):0<(t=Object.keys(e)).length&&(e.hasOwnProperty("serviceWorkerVersion")&&null!=e.serviceWorkerVersion&&(O.Config.notification.serviceWorkerVersion=e.serviceWorkerVersion),h.sendEvent(t[0],e[t[0]])))},h.syncHookInDb=function(o){var i;"syncNotificationClick"!=o&&"syncNotificationView"!=o||(null!=O.Config.notification.syncNotificationClick||null!=O.Config.notification.syncNotificationView?(i=O.Config.notification[o],s.IndexedDB.init().then(function(t){s.IndexedDB.getData(t,"options",o).then(function(e){(e&&e.hasOwnProperty("val")?e.val:"")!=i&&s.IndexedDB.addUpdate(t,o,i).then(function(e){p.Helper.displayLog(e)}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)})}).catch(function(e){p.Helper.displayLog(e)})):p.Helper.displayLog("Invalid Hook Request"))},h.syncNotificationSent=function(e){var t="pid="+O.Config.client+"&bkey="+p.Helper.getCurrentUUID()+"&btype="+O.Config.global.browserType+"&dtype="+O.Config.global.deviceType+"&rid="+e.rid,e=p.Helper.getEndpoint("notificationSent");g.HttpRequest.post(e,{data:t},function(){p.Helper.displayLog("sent Api synced successfully with "+O.Config.brandingPartner)})},h.syncNotificationView=function(e){var t={pid:O.Config.client,bkey:p.Helper.getCurrentUUID(),cid:e.id,rid:e.rid,op:"view",pl:1};1==e.viewFlag&&(e=p.Helper.getEndpoint("syncNotificationView"),g.HttpRequest.post(e,{data:Object.keys(t).map(function(e){return e+"="+t[e]}).join("&")},function(){}))},h.showWelcomeNotification=function(e){try{var t=O.Config.welcomePlaybook,o=t.data;if(0==t.status)return;return(o.viewFlag=1,o.clickFlag=1,o.sysEvents=0,o.domainNum=0,h.getPayloadVerification(o))?e?(h.syncNotificationSent(o),void h.syncNotificationView(o)):h.sendLocalNotification(o).then(function(){return O.Config.notification.isSdkHttps&&!O.Config.notification.httpsNoRoot&&(h.syncNotificationSent(o),h.syncNotificationView(o)),!0}):void p.Helper.displayLog("Welcome playbook payload verification failed")}catch(e){}},h.getPayloadVerification=function(e){return!!(e.title&&e.message&&e.icon&&e.rid&&e.key&&e.id)},h.alternateDomainJson="",h.alternateDomainIndex=0,h.permissionDomain="",h.syncableEvents=[,b.KeyMapper.IZOOTO_PROMPTED,b.KeyMapper.IZOOTO_OPTIN_SHOWN,b.KeyMapper.IZOOTO_OPTIN_ALLOWED,b.KeyMapper.IZOOTO_OPTIN_CLOSED,b.KeyMapper.IZOOTO_ALREADY_DENIED],h);function h(){}t.NotificationHelper=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var p=o(0),l=o(1),o=(g.create=function(e,t,o,i,n,r,a){var s="",c=new XMLHttpRequest;if(c.onreadystatechange=function(){4==this.readyState&&200==this.status?"function"==typeof o&&o(this.responseText,this.status,a):4==this.readyState&&200!=this.status&&o(this.responseText,this.status,a)},c.open(t,e,!0),"POST"==t&&(c.setRequestHeader("Content-type","application/x-www-form-urlencoded; charset=UTF-8"),"object"==typeof i&&0<Object.keys(i).length&&null!=i.data&&""!=i.data&&(s=i.data)),"object"==typeof n&&0<Object.keys(n).length)for(var p in n)l.Helper.displayLog("Header name"+p),c.setRequestHeader(p,n[p]);l.Helper.displayLog(e),""!=s?c.send(s):c.send()},g.get=function(e,t,o,i){""!=o&&null!=o&&null!=o.data&&""!=o.data&&0!=p.Config.notification.processPriority&&(o.data=o.data+"&pp="+p.Config.notification.processPriority),g.create(e,"GET",t,o,i)},g.post=function(i,n,r,a,e,t){var s=e||10;""!=n&&null!=n&&null!=n.data&&""!=n.data&&0!=p.Config.notification.processPriority&&(n.data=n.data+"&pp="+p.Config.notification.processPriority);var c=function(e,t,o){r(e,t,o),200!=t&&0<s&&setTimeout(function(){l.Helper.displayLog("Retrying to post request again..."),g.create(i,"POST",c,n,a,s,o),s--},2500)};g.create(i,"POST",c,n,a,void 0,t)},g);function g(){}t.HttpRequest=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(4),n=o(0),r=o(1),a=o(7),s=o(9),c=o(2),p=o(3),l=o(12),o=(g.init=function(){"[object Array]"==Object.prototype.toString.call(window._izq)?g.readSavedPreferences():window._izq=[],window._izq.push=function(e){if(null!=e[0])return g.process(e)},this.sync(!1)},g.sync=function(e){if(void 0===e&&(e=!0),r.Helper.displayLog("Syncing queue.."),!(window._izq.length<1)){for(var t=[],o=0;o<window._izq.length;o++)t.push(window._izq[o]);if(0<t.length)if(e)for(o=t.length-1;0<=o;o--)null!=t[o]&&(r.Helper.displayLog("Processing from queue",t[o][0]),this.process(t[o]),window._izq.splice(o,1));else for(o=t.length-1;0<=o;o--)null!=t[o]&&-1==n.Config.store.subscriptionBasedEventNameList.indexOf(t[o][0])?(r.Helper.displayLog("Processing from queue",t[o][0]),this.process(t[o]),window._izq.splice(o,1)):r.Helper.displayLog("Sync later queue item",t[o][0])}},g.process=function(e){try{if("debug"===e[0]&&1==e[1])return void a.Debugger.init();if(1==n.Config.izootoStatus){if(1==n.Config.notification.gdprPromptStatus&&0==n.Config.notification.isGdprAllowed&&this.isValidQueueForGdpr(e[0]))return void r.Helper.displayLog("Blocked due to GDPR is disallowed : ",e[0]);if(3==i.NotificationHelper.getPermissionStatusFromStorage()&&-1<n.Config.store.subscriptionBasedEventNameList.indexOf(e[0]))return void r.Helper.displayLog("Blocked due to soft unsubscribe : ",e[0]);if("event"===e[0]&&void 0!==e[1]&&"string"==typeof e[1]&&""!==e[1])i.NotificationHelper.userEventProcessor(e[1],e[2]),i.NotificationHelper.syncAsTrigger(e[1],e[2]);else if("triggerPromptWithDelay"==e[0])i.NotificationHelper.triggerPromptHandler(!0);else if("triggerPrompt"==e[0])i.NotificationHelper.triggerPromptHandler();else{if("customizeOptInPrompt"===e[0]&&"object"==typeof e[1])return void i.NotificationHelper.customizeOptInPrompt(e[1]);if("syncFCMToken"===e[0])"string"==typeof e[1]&&""!=e[1]&&(n.Config.notification.subscriptionType=1,n.Config.notification.fcmToken=e[1],i.NotificationHelper.sendEvent(p.KeyMapper.IZOOTO_PROMPT_ALLOWED,e[1]));else if("updateSubscription"===e[0])"subscribe"!=e[1]&&"unsubscribe"!=e[1]||i.NotificationHelper.updateSubscriptionProcessor(e[1]);else{if("getSubscriberId"===e[0])return n.Config.store.subscriberId||c.Storage.getStorage(p.KeyMapper.IZOOTO_UUID);if("getSubscriptionObject"===e[0])return c.Storage.getStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN);"userProfile"===e[0]&&(void 0!==e[1]||""!==e[1])||"personalizationProperty"===e[0]?i.NotificationHelper.userProfileProcessor(e[1]):"trigger"!==e[0]||void 0===e[1]&&""===e[1]?"gaId"===e[0]&&"string"==typeof e[1]&&"object"==typeof e[2]?s.GoogleAnalytics.init(e):"registerPromptDisplayCallback"===e[0]&&"function"==typeof e[1]?this.promptDisplayCallback=e[1]:"registerSubscriptionCallback"===e[0]&&"function"==typeof e[1]?this.subscriptionCallback=e[1]:"register_callback"===e[0]&&"function"==typeof e[1]&&(this.userCallback=e[1]):i.NotificationHelper.triggerProcessor(e[1],e[2],e[3])}}n.Config.notification.isTagsEnabled&&("add_tag"===e[0]||"remove_tag"===e[0]?console.warn(n.Config.brandingPartner+" :: Tags are no longer supported. See https://help.izooto.com/article/segementation/ "):"add_property"===e[0]&&void 0!==e[1]&&""!==e[1]&&i.NotificationHelper.addPropertyProcessorFallback(e[1]))}else r.Helper.displayLog("Sync action aborted! due to notification module disable");if("triggerMessengerPrompt"===e[0])return n.Config.messenger.autoPrompt=!0,void l.Messenger.init(!0)}catch(e){r.Helper.displayLog("Queue error :",e)}},g.readSavedPreferences=function(){r.Helper.displayLog("Saved Preferences : ",window._izq),window._izq.forEach(function(e){"subscriberProfile"==e[0]&&null!=e[1]&&"object"==typeof e[1]&&e[1].hasOwnProperty("isPaid")&&(n.Config.CRPSPlaybook.isPaidSubscriber=e[1].isPaid,r.Helper.displayLog("Paid subscriber is set to : ",e[1].isPaid)),"init"==e[0]&&null!=e[1]&&"object"==typeof e[1]?((e[1].hasOwnProperty("auto_prompt")||e[1].hasOwnProperty("notificationAutoPrompt")||e[1].hasOwnProperty("autoPrompt"))&&(n.Config.notification.autoPrompt=null!=e[1].auto_prompt?e[1].auto_prompt:null!=e[1].autoPrompt?e[1].autoPrompt:e[1].notificationAutoPrompt,r.Helper.displayLog("Notification auto prompt set to : ",e[1].auto_prompt),0==n.Config.notification.autoPrompt&&(n.Config.notification.promptType=2)),e[1].hasOwnProperty("messengerAutoPrompt")&&(n.Config.messenger.autoPrompt=e[1].messengerAutoPrompt,r.Helper.displayLog("Messenger auto prompt set to : ",e[1].messengerAutoPrompt))):"epSyncState"==e[0]&&1==e[1]&&(r.Helper.displayLog("Custom subscription found! waiting for for FCM Token sync command!"),n.Config.store.isNotificationDisabledManually=!0,g.sync())})},g.isValidQueueForGdpr=function(e){return-1<n.Config.notification.gdprNotAllowed.indexOf(e)},g);function g(){}t.Queue=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(0),c=o(1),n=o(5),o=(p.init=function(e){p.msg=p.getMsgSet(),s.Config.debugger.err=0,console.clear(),p.log(p.dash.repeat(20)+(s.Config.brandingPartner+" Debug Mode")+p.dash.repeat(20)),s.Config.debugger.status=1,p.log("Verifying "+s.Config.brandingPartner+" integration on your website",s.Config.debugger.infoCode);function t(){1==s.Config.debugger.err?p.log(p.msg.integration_f,s.Config.debugger.errCode):p.log(p.msg.integration,s.Config.debugger.successCode),e&&e(p.debuggerObj)}var o=s.Config.global.platform;p.debuggerObj.plugin=o,p.debugger.rcvObj={};var i=document.location.href,i=c.Helper.getParamFromUrl(i,"izObj");(i=c.Helper.parseToJSON(i))&&null!=i.domainRoot&&(s.Config.notification.domainRoot=i.domainRoot,s.Config.notification.httpsNoRoot=""!=s.Config.notification.domainRoot?1:0,s.Config.setupPath()),i&&null!=i.cdnHost&&""!=i.cdnHost&&(s.Config.notification.cdnHost=i.cdnHost),""!=o&&p.log(p.msg.plugin.replace("{plg}",o),s.Config.debugger.successCode);o=p.getScript();null!=o?(p.debuggerObj.scriptSrc=o,p.log(p.msg.code_t+p.msg.code_f+"("+o+")",s.Config.debugger.successCode),1==s.Config.notification.isSdkHttps?p.validateSw(function(){t()}):t()):(s.Config.debugger.err=1,p.log(p.msg.code_t+p.msg.code_nf,s.Config.debugger.errCode),t())},p.log=function(e,t){t=t||"",console.info("%c"+e,t)},p.getMsgSet=function(){var e=s.Config.brandingPartner,t="support@"+e.toLowerCase()+".com";return{code_t:e+" JS code: ",code_f:"found",code_nf:"missing. Learn more here: http://bit.ly/2WHcP4a",sw_t:"Service Worker JS: ",sw_f:"found at {sw}",sw_nf:"missing from {sw} , Learn more here: http://bit.ly/2K0yGSs",sw_ct:"Service Worker JS: Invalid Content-Type found ",html_f:e+" Html: found",html_nf:e+" Html: not found ",html_ct:e+" Html: Invalid Content-Type found ",mfst_t:"Manifest file: ",mfst_f:"found at {m}",mfst_nf:"missing form {m} , Learn more here: http://bit.ly/2K0yGSs",multi_mfst:"multiple manifest files found. Learn more here: http://bit.ly/2WCd2FC",gcm_t:"gcm_sender_id: ",gcm_nf:"missing in the manifest file. Learn more here: http://bit.ly/2WCd2FC",fallback:"FCM project: issue with your FCM project.",integration:e+" integration is working fine on your website.",integration_f:e+" integration is incomplete. Contact "+t+" to get assistance.",plugin:"You have integrated "+e+" using the {plg} plugin.",ev:"sent to "+e}},p.requestFile=function(e,o,i){var n=new XMLHttpRequest,t=Math.random();e+=e.includes("?")?"&":"?",e+=t,n.onreadystatechange=function(){var e,t;4==this.readyState&&(e=n.responseText,t="",n.getResponseHeader("Content-Type")?t=n.getResponseHeader("Content-Type"):n.getResponseHeader("content-type")&&(t=n.getResponseHeader("content-type")),200==this.status?o(this.status,e,t):i(this.status,e))},n.open("GET",e,!0),n.send()},p.getFileInfo=function(e,i){var n={};p.requestFile(e,function(e,t,o){n.status=!0,n.contentType=o,n.body=t,i(n)},function(e,t){n.status=!1,i(n)})},p.contentTypeValidator=function(e,t){var o=!0;return t=t.toLowerCase(),1==e?t.indexOf("application")<0&&t.indexOf("javascript")<0&&(o=!1):2==e&&t.indexOf("html")<0&&(o=!1),o},p.validateIzootoHtml=function(t){p.debuggerObj.plugin&&t();var o=this.getMsgSet();s.Config.debugger.host;p.getFileInfo(s.Config.notification.sourceOrigin,function(e){1==(p.debuggerObj.izootoHtml=e).status?(p.log(o.html_f,s.Config.debugger.successCode),p.contentTypeValidator(2,e.contentType)||(p.log(o.html_ct+e.contentType,s.Config.debugger.errCode),s.Config.debugger.err=1)):(p.log(o.html_nf,s.Config.debugger.errCode),s.Config.debugger.err=1),t()})},p.validateSw=function(t){var o=this.getMsgSet(),i=s.Config.debugger.host;p.getFileInfo(s.Config.notification.serviceWorkerPath,function(e){if(1==(p.debuggerObj.sw=e).status){if(p.log(o.sw_t+o.sw_f.replace("{sw}",i+s.Config.notification.serviceWorkerPath),s.Config.debugger.successCode),!p.contentTypeValidator(1,e.contentType))return p.log(o.sw_ct+e.contentType,s.Config.debugger.errCode),s.Config.debugger.err=1,void t();p.validateIzootoHtml(t)}else p.log(o.sw_t+o.sw_nf.replace("{sw}",i+s.Config.notification.serviceWorkerPath),s.Config.debugger.errCode),s.Config.debugger.err=1,t()})},p.validateGCM=function(e,i){var t="pid="+s.Config.client;t+="&gcm="+e,n.HttpRequest.post(s.Config.debugger.gcmValidator,{data:t},function(e){var t="fail",o=(e=c.Helper.parseToJSON(e)).response?e.response:"Something went wrong";"success"==e.status?(t=e.status,p.log("GCM Sender ID Validation "+t,s.Config.debugger.successCode),i(!0)):(p.log("GCM Sender ID Validation "+t+" , "+o,s.Config.debugger.errCode),i(!1))})},p.validateManifest=function(i){for(var n=p.getMsgSet(),r=s.Config.debugger.host,e=document.getElementsByTagName("link"),t=0;t<e.length;t++){var o=e[t],a=o.getAttribute("href"),o=o.getAttribute("rel");null!=o&&"manifest"==o&&a!=s.Config.notification.manifest&&(p.log(n.mfst_t+n.multi_mfst,s.Config.debugger.errCode),s.Config.debugger.err=1)}p.requestFile(s.Config.notification.manifest,function(e,t){p.log(n.mfst_t+n.mfst_f.replace("{m}",r+s.Config.notification.manifest),s.Config.debugger.successCode);try{var o=c.Helper.parseToJSON(t);if(""==(o=o.gcm_sender_id?o.gcm_sender_id:""))return p.log(n.gcm_t+n.gcm_nf,s.Config.debugger.errCode),void i(!1);p.validateGCM(o,i)}catch(e){p.log(n.gcm_t+n.gcm_nf.replace("{m}",r+s.Config.notification.manifest),s.Config.debugger.errCode)}},function(e,t){p.log(n.mfst_t+n.mfst_nf.replace("{m}",r+s.Config.notification.manifest),s.Config.debugger.errCode),i(!1)})},p.getScript=function(){for(var e=document.getElementsByTagName("script"),t=new RegExp(s.Config.notification.cdnHost+"/scripts/[^/]*.js"),o=0;o<e.length;o++){var i=e[o];if(null!=(i=i.getAttribute("src"))&&t.test(i))return i.startsWith("//")&&(i="https:"+i),i}return null},p.showMsgOverlay=function(){var e='<div class="iz-verification-overlay" style="width: 100%;position: fixed;top: 0;left:0;z-index: 9999999999;text-align: center;background: rgba(0,0,0,0.6);height: 100%;color: #fff;display: flex;justify-content: center;align-items: center;overflow-y: hidden;"><div class="inner-content" style="font-size: 2em;"><span style="line-height: 2;">Please wait while we are verifying '+s.Config.brandingPartner+" integration on your website. <br>This window will close automatically.</span></div></div>";c.Helper.addHTML("div",e,"iz-integration-overlay")},p.verifyIzootoIntegration=function(){p.showMsgOverlay(),p.init(function(e){c.Helper.postMessage("opener","integrationObj",e)})},p.dash="-",p.debuggerObj={sw:{},izootoHtml:{}},p.debugger={rcvObj:{}},p);function p(){}t.Debugger=o},function(e,t,o){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(o,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function n(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}r((c=c.apply(e,a||[])).next())})},s=this&&this.__generator||function(o,i){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(o,s)}catch(e){t=[6,e],r=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var c=o(0),p=o(3),l=o(2),g=o(4),d=o(1),f=o(6),u=o(10),o=(O.init=function(){return i(this,void 0,void 0,function(){var t,o,i,n,r,a;return s(this,function(e){switch(e.label){case 0:return(t=c.Config.UUID=d.Helper.getCurrentUUID(),3!=c.Config.notification.windowType||window.self==window.top)?[3,4]:(o={token:"",subscribed_on:"",uuid:t},l.Storage.getStorage(p.KeyMapper.IZOOTO_MASTER_DOMAIN)?(i=O.getMasterStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN),r=O.getMasterStorage(p.KeyMapper.IZOOTO_SUBSCRIBED_ON),""!=t||""==i?[3,2]:[4,d.Helper.getUUIDFromEndpoint(i)]):[3,3]);case 1:""!=(n=e.sent())&&(t=n,l.Storage.setStorage(p.KeyMapper.IZOOTO_UUID,t)),e.label=2;case 2:o={token:i,subscribed_on:r,uuid:t},e.label=3;case 3:return d.Helper.postMessage("parent",p.KeyMapper.IZOOTO_MASTER_TO_CHILD,o),d.Helper.addMsgReciever(g.NotificationHelper.msgReciever),[3,10];case 4:return window.location.origin!=c.Config.notification.masterDomain?[3,9]:""==(i=O.getMasterStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN))?[3,7]:""!=t?[3,6]:[4,d.Helper.getUUIDFromEndpoint(i)];case 5:""!=(n=e.sent())&&(t=n,l.Storage.setStorage(p.KeyMapper.IZOOTO_UUID,t)),e.label=6;case 6:return(r=O.getMasterStorage(p.KeyMapper.IZOOTO_SUBSCRIBED_ON))==c.Config.notification.masterDomain?(u.Main.moduleInitializer(),[2]):(1==g.NotificationHelper.getPermissionStatusFromStorage()?f.Queue.sync():g.NotificationHelper.tokenValidator(function(e){1==e?(g.NotificationHelper.updatePermissionStatus(1),f.Queue.sync()):u.Main.moduleInitializer()}),[3,8]);case 7:u.Main.moduleInitializer(),e.label=8;case 8:return[3,10];case 9:c.Config.store.isMDSyncingRequired&&(d.Helper.addMsgReciever(g.NotificationHelper.msgReciever),a=c.Config.notification.masterDomain+c.Config.notification.masterDomainPath+"?action=izcheckmaster&domain="+window.location.origin,g.NotificationHelper.addIFrame(a,p.KeyMapper.IZOOTO_MASTER_AS_FRAME)),1==g.NotificationHelper.getPermissionStatusFromStorage()?(g.NotificationHelper.sendEvent(p.KeyMapper.IZOOTO_ALREADY_GRANTED,O.getMasterStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN)),f.Queue.sync()):c.Config.store.isMDSyncingRequired||(d.Helper.addMsgReciever(g.NotificationHelper.msgReciever),a=c.Config.notification.masterDomain+c.Config.notification.masterDomainPath+"?action=izcheckmaster&domain="+window.location.origin,g.NotificationHelper.addIFrame(a,p.KeyMapper.IZOOTO_MASTER_AS_FRAME)),e.label=10;case 10:return[2]}})})},O.masterDomainCallback=function(e){var t,o,i=!0;""!=c.Config.notification.masterDomain&&(e&&(i=!1,e=O.getMasterStorage(p.KeyMapper.IZOOTO_MASTER_DOMAIN),t=l.Storage.getStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN),t=d.Helper.parseToJSON(t),e=""!=e?g.NotificationHelper.getSubscriptionKey(e):"",t=g.NotificationHelper.getSubscriptionKey(t),""!=e&&e==t||(i=!0)),i&&(window.location.origin==c.Config.notification.masterDomain?(o='{"iz_'+c.Config.client+'":{"'+p.KeyMapper.IZOOTO_PUSH_TOKEN+'":'+l.Storage.getStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN)+',"'+p.KeyMapper.IZOOTO_SUBSCRIBED_ON+'":"'+c.Config.notification.masterDomain+'","user_properties":{}}}',l.Storage.setStorage(p.KeyMapper.IZOOTO_MASTER_DOMAIN,o)):self==top&&(t={token:l.Storage.getStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN),subscribed_on:window.location.origin,uuid:d.Helper.getCurrentUUID()},i=document.getElementById(p.KeyMapper.IZOOTO_MASTER_AS_FRAME),d.Helper.postMessage(i,p.KeyMapper.IZOOTO_CHILD_TO_MASTER,t),o='{"iz_'+c.Config.client+'":{"'+p.KeyMapper.IZOOTO_PUSH_TOKEN+'":'+l.Storage.getStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN)+',"'+p.KeyMapper.IZOOTO_SUBSCRIBED_ON+'":"'+window.location.origin+'","user_properties":{}}}',l.Storage.setStorage(p.KeyMapper.IZOOTO_MASTER_DOMAIN,o)),window._izq=window._izq||[],window._izq.push(["userProfile",{add:{subscribed_on_url:window.location.origin}}])))},O.setMasterStorage=function(e){var t="";e.hasOwnProperty("uuid")&&e.uuid&&(t=e.uuid);var o='{"iz_'+c.Config.client+'":{"'+p.KeyMapper.IZOOTO_PUSH_TOKEN+'":'+e.token+',"'+p.KeyMapper.IZOOTO_SUBSCRIBED_ON+'":"'+e.subscribed_on+'","user_properties":{}}}';l.Storage.setStorage(p.KeyMapper.IZOOTO_MASTER_DOMAIN,o),l.Storage.setStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN,encodeURIComponent(e.token)),t&&l.Storage.setStorage(p.KeyMapper.IZOOTO_UUID,t)},O.getMasterStorage=function(e){var t="iz_"+c.Config.client,o="",t=(o=d.Helper.parseToJSON(l.Storage.getStorage(p.KeyMapper.IZOOTO_MASTER_DOMAIN)))[t];return""!=o&&null!=t&&null!=t[e]?t[e]:""},O.masterConfigReciver=function(e){var t=l.Storage.getStorage(p.KeyMapper.IZOOTO_UUID),o=e.token,i=e.subscribed_on,e=e.uuid,n={token:JSON.stringify(o),subscribed_on:i,uuid:e};if(e||(l.Storage.setStorage(p.KeyMapper.IZOOTO_UUID,e),t&&t!=e&&d.Helper.UUIDMapper(t,e)),""!=o){if(!e)return void u.Main.moduleInitializer();g.NotificationHelper.tokenValidator(function(e){return 1==e?(g.NotificationHelper.updatePermissionStatus(p.KeyMapper.IZOOTO_PROMPT_ALLOWED),O.setMasterStorage(n),g.NotificationHelper.sendEvent(p.KeyMapper.IZOOTO_ALREADY_GRANTED,O.getMasterStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN)),void f.Queue.sync()):0==e?(l.Storage.removeConfigLocal(p.KeyMapper.IZOOTO_PERMISSION_STATUS),void u.Main.moduleInitializer()):void 0},e)}else u.Main.moduleInitializer()},O);function O(){}t.MasterDomain=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(1),n=o(0),o=(r.init=function(e){n.Config.ga.id=e[1];e=e[2];e.subscriptionCallback&&"object"==typeof e.subscriptionCallback&&(n.Config.ga.subscriptionCallback=e.subscriptionCallback),e.promptDisplayCallback&&"object"==typeof e.promptDisplayCallback&&(n.Config.ga.promptDisplayCallback=e.promptDisplayCallback)},r.process=function(e){if(""!=n.Config.ga.id)try{window.ga=window.ga||function(){(window.ga.q=window.ga.q||[]).push(arguments)},window.ga.l=+new Date;var t=""!=n.Config.global.platform?n.Config.global.platform:"custom";window.ga("create",n.Config.ga.id,"auto"),window.ga("send","event","izooto",e,t,{nonInteraction:!0}),i.Helper.displayLog("Sending response : ",e)}catch(e){}},r.isCallbackAllowed=function(e,t){for(var o in e){var i=e[o];if("string"==typeof i&&"all"==i.toLowerCase()||i==t)return!0}return!1},r.initUsingConfig=function(){""!==n.Config.ga.id&&n.Config.ga.subscriptionCallback.push(1,2)},r);function r(){}t.GoogleAnalytics=o},function(e,t,o){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(o,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function n(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}r((c=c.apply(e,a||[])).next())})},r=this&&this.__generator||function(o,i){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(o,s)}catch(e){t=[6,e],r=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}},n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),n(o(23)).default.polyfill();var a=o(1),s=o(0),c=o(16),p=o(13),l=o(4),g=o(6),d=o(2),f=o(7),u=o(14),O=o(17),y=o(18),m=o(15),b=o(3),S=o(12),_=o(8),C=o(20),v=o(19),T=o(21),w=o(22),o=(h.init=function(){if(void 0!==window._izooto)throw new Error("Duplicate Pixel Found !!");window._izooto={},1==s.Config.izootoStatus?"undefined"==typeof Promise?h.initIzooto():l.NotificationHelper.getIzCidPromise().then(function(){h.initIzooto()}):a.Helper.displayLog(s.Config.brandingPartner+" has been disabled for this site!")},h.initIzooto=function(){return i(this,void 0,void 0,function(){var t;return r(this,function(e){switch(e.label){case 0:return h.referenceHolder(),h.izootoFallbackHandler(),s.Config.init(),C.Session.init(),window._izooto.client=s.Config.client,d.Storage.legacyStorageMigration(),g.Queue.init(),(t=""!=s.Config.notification.masterDomain)?[4,l.NotificationHelper.isSupported()]:[3,2];case 1:t=e.sent(),e.label=2;case 2:return t?_.MasterDomain.init():h.moduleInitializer(),[2]}})})},h.referenceHolder=function(){window._izooto=s.Config,window._izooto.helperClass=a.Helper,window._izooto.gdprClass=c.GDPR,window._izooto.queueClass=g.Queue,window._izooto.notificationClass=p.Notification,window._izooto.notificationHelperClass=l.NotificationHelper,window._izooto.storageClass=d.Storage,window._izooto.debuggerClass=f.Debugger,window._izooto.indexedDBClass=u.IndexedDB,window._izooto.videoDropOffClass=y.VideoDropOff,window._izooto.tabAbandonmentClass=O.TabAbandonments,window._izooto.shopifyClass=m.Shopify,window._izooto.masterDomainClass=_.MasterDomain,window._izooto.messengerClass=S.Messenger,window._izooto.sessionClass=C.Session,window._izooto.crpsPlaybookClass=v.CRPSPlaybook,window._izooto.recommendArticleClass=T.RecommendArticle,window._izooto.autoSegmentClass=w.AutoSegment},h.moduleInitializer=function(){return i(this,void 0,void 0,function(){return r(this,function(e){switch(e.label){case 0:return[4,h.UUIDHandler()];case 1:return e.sent(),p.Notification.init(),S.Messenger.init(),[2]}})})},h.UUIDHandler=function(){return i(this,void 0,void 0,function(){var t,o,i,n;return r(this,function(e){switch(e.label){case 0:return(t=d.Storage.getStorage(b.KeyMapper.IZOOTO_PUSH_TOKEN),o=l.NotificationHelper.getSubscriptionKey(t),a.Helper.isUUID())?(s.Config.UUID=a.Helper.getUUID(),[3,10]):[3,1];case 1:return o?[4,a.Helper.getUUIDFromEndpoint(t)]:[3,3];case 2:return i=e.sent(),s.Config.UUID=""==i?o:i,a.Helper.setUUID(),[3,10];case 3:return[4,l.NotificationHelper.isHttpsSitePermissionAlreadyGranted()];case 4:return e.sent()?(n="",a.Helper.displayLog("Recovering Old Subscription..."),1!=s.Config.notification.httpsNoRoot?[3,6]:(a.Helper.displayLog("No root flow..."),[4,l.NotificationHelper.httpsNoRootGetOldSubscription()])):[3,10];case 5:return n=e.sent(),[3,8];case 6:return[4,l.NotificationHelper.httpsGetOldSubscription()];case 7:n=e.sent(),e.label=8;case 8:return n?[4,a.Helper.getUUIDFromEndpoint(n)]:[3,10];case 9:""==(i=e.sent())?(n=l.NotificationHelper.getSubscriptionKey(n),s.Config.UUID=n):s.Config.UUID=i,a.Helper.setUUID(),e.label=10;case 10:return a.Helper.getCurrentUUID()||(a.Helper.displayLog("Assining new uuid..."),s.Config.UUID=a.Helper.getUUID()),[2]}})})},h.izootoFallbackHandler=function(){window._izooto.optinCallback=function(e){p.Notification.optinCallback(e)},window._izooto.closeDialog=function(e){p.Notification.closeDialog(e)},window._izooto.openPopup=function(e){p.Notification.openPopup(!0)},window._izooto.closeHttpsBranding=function(){l.NotificationHelper.closeHttpsOverlay()},window._izooto.gdprAllow=function(){c.GDPR.gdprAllow()},window._izooto.gdprDisallow=function(){c.GDPR.gdprDisallow()},window._izooto.syncHookInDb=function(){return l.NotificationHelper.syncHookInDb("syncNotificationView")},window._izooto.syncHookInDb=function(){return l.NotificationHelper.syncHookInDb("syncNotificationClick")},window._izooto.getStorage=function(e){return"iztoken"==e?e=b.KeyMapper.IZOOTO_PUSH_TOKEN:"uid"==e&&(e=b.KeyMapper.IZOOTO_UUID),d.Storage.getStorage(e)},window._izooto.getBrowserKeyFromToken=function(e){return l.NotificationHelper.getSubscriptionKey(e)}},h);function h(){}(t.Main=o).init()},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(0),o=(i.setCookie=function(e,t,o){void 0===o&&(o=n.Config.global.cookieExpiryDays);var i=new Date;i.setTime(i.getTime()+24*o*60*60*1e3);i="expires="+i.toUTCString();document.cookie=e+"="+t+";path=/;"+n.Config.global.cookieDomain+i+";"+n.Config.global.cookieSameSite},i.getCookie=function(e){try{for(var t=e+"=",o=document.cookie.split(";"),i=0;i<o.length;i++){for(var n=o[i];" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return decodeURIComponent(n.substring(t.length,n.length))}}catch(e){}return""},i.removeCookie=function(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT; "+n.Config.global.cookieSameSite},i);function i(){}t.CookieStorage=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),n=o(1),r=o(4),a=o(2),s=o(5),c=o(3),o=(p.init=function(e){if("http:"!=i.Config.global.locationProtocol&&0==i.Config.notification.windowType){if(0!=i.Config.messenger.status&&""!=i.Config.messenger.pageId){try{null==(p.messengerPrompt=i.Config.messenger.prompt).title&&(p.messengerPrompt.title="Connect with us for exclusive deals and offers!"),p.messengerPrompt.poweredbysrc=i.Config.notification.promptDesign.poweredbysrc}catch(e){}if(p.htmlContainer=r.NotificationHelper.loadDesign(p.messengerPrompt,p.getHtmlContainer()),1!=e){if(!i.Config.messenger.autoPrompt)return;if(p.isDelayed())return}p.triggered||(p.triggered=!0,window.fbAsyncInitIzooto=function(){window.FB.init({appId:p.appId,autoLogAppEvents:!0,xfbml:!0,version:"v7.0"}),window.FB.Event.subscribe("send_to_messenger",function(e){"rendered"==e.event&&0==e.is_after_optin&&setTimeout(function(){var e=document.getElementById("izootoFbMessengerMainContainer");e&&(e.style.display="block",p.sendEvent(c.KeyMapper.IZOOTO_MESSENGER_PROMPTED),p.setRepeatPromptDelay(i.Config.messenger.repeatDelay))},400),"opt_in"==e.event&&(p.setMultiMessengerStorage(c.KeyMapper.IZOOTO_MSNGR_IS_SUBSCRIBED,1),p.sendEvent(c.KeyMapper.IZOOTO_MESSENGER_SUBSCRIBED),setTimeout(function(){p.htmlContainerClose()},1e3))})},n.Helper.addExternalJS("https://connect.facebook.net/en_US/sdk.js").then(function(){window.fbAsyncInitIzooto(),p.addHtmlContainer(i.Config.messenger.pageId)}).catch(function(e){n.Helper.displayLog("Error while adding fb messenger scring",e)}))}}else n.Helper.displayLog("Messenger is disabled for this device!")},p.htmlContainerClose=function(){var e=document.getElementById("izootoFbMessengerMainContainer");e&&(e.style.display="none")},p.getHtmlContainer=function(){return'<style>#izFbContainer .fb_iframe_widget {display: -webkit-box;}.izooto-widget-overlay {background: transparent;width: unset;height: unset;position: unset;top: unset;left: unset;z-index: 2147483647;}.izooto-widget-position{position: fixed;right: 10px;bottom: 10px;z-index: 2147483647;}.izooto-fb-widget{background: #fff; box-shadow: 0px 3px 5px -1px rgba(0, 0, 0, 0.2), 0px 6px 10px 0px rgba(0, 0, 0, 0.01), 0px 1px 18px 0px rgba(0, 0, 0, 0.03); border-radius: 4px; font-family: "sans-serif",Helvetica,Arial,Helvetica Neue; font-size: 15px; letter-spacing: 0.4px; width: 285px; position: relative;}.izooto-fb-close{background: transparent; border: none; font-size: 22px; position: absolute; top: 2px; right: 5px; cursor: pointer; color: grey;}.izooto-fb-top{padding: 24px; border-radius: 4px 4px 0 0; background: #dfeeff; padding-bottom: 10px;}.izooto-fb-title{line-height: 20px; font-weight: 500; color: #000; padding-bottom: 6px;}a.izooto-fb-branding{display: block; padding-top: 6px; font-size: 11px; color: #1f82f7; font-family: "sans-serif",Helvetica,Arial,Helvetica Neue; text-decoration: none; letter-spacing: 0.8px;}a:hover.izooto-fb-branding{display: block; padding-top: 6px; font-size: 11px; color: #1f82f7; font-family: "sans-serif",Helvetica,Arial,Helvetica Neue; text-decoration: none; letter-spacing: 0.8px;}.izooto-fb-bottom{background: white; border-radius: 0 0 4px 4px; padding: 24px; background: #fff;}@media  screen and (max-width:600px){.izooto-widget-overlay {background: #00000070;width: 100%;height: 100%;position: fixed;top: 0;left: 0;z-index: 2147483647;}.izooto-widget-position {position: absolute;left: 50%;top: 50%;right: unset;bottom: unset;z-index: 2147483647;transform: translate(-50%, -50%);}.izooto-fb-close{background: #195086;border: none;font-size: 22px;position: absolute;top: -10px;right: -10px;cursor: pointer;color: white;border-radius: 50px;width: 28px;height: 28px;text-align: center;vertical-align: middle;display: unset;padding: 0 0;line-height: 0;}}</style><div class="izooto-widget-overlay"><div class="izooto-widget-position"> <div class="izooto-fb-widget"> <div class="izooto-fb-top"> <button type="button" class="izooto-fb-close" onclick="_izooto.messengerClass.htmlContainerClose();">&times;</button> <div class="izooto-fb-title">{{--title--}}</div><a target="_blank" href="{{--poweredbysrc--}}" class="izooto-fb-branding"><span style="color:grey;">Powered by</span> '+i.Config.brandingPartner+'</a> </div><div class="izooto-fb-bottom"> <div id="izFbContainer" style="margin-left:42px;"></div></div></div></div>'},p.addHtmlContainer=function(e){var t=p.htmlContainer,o=document.createElement("div");o.setAttribute("id","izootoFbMessengerMainContainer"),o.style.display="none",o.innerHTML=t,(document.body?document.body:document.head).appendChild(o);var t=n.Helper.getCurrentUUID(),o=i.Config.client+"=/="+t+"=/="+i.Config.global.os+"=/="+i.Config.global.browserVer+"=/="+i.Config.global.deviceType+"=/="+i.Config.global.browserType,t=document.createElement("div");t.setAttribute("class","fb-send-to-messenger"),t.setAttribute("messenger_app_id",p.appId),t.setAttribute("page_id",e),t.setAttribute("color","blue"),t.setAttribute("size","large"),t.setAttribute("data-ref",o),null!==(o=document.getElementById("izFbContainer"))&&void 0!==o&&o.appendChild(t)},p.isDelayed=function(){return n.Helper.displayLog("Messenger delay"),1==p.getMultiMessengerStorage(c.KeyMapper.IZOOTO_MSNGR_IS_SUBSCRIBED)||p.getMultiMessengerStorage(c.KeyMapper.IZOOTO_MSNGR_REPEAT_PROMPT_DELAY)>Date.now()},p.syncEvent=function(e){var t="",t=e==c.KeyMapper.IZOOTO_MESSENGER_SUBSCRIBED?(n.Helper.setUUID(),n.Helper.getEndpoint("syncMessenger")):n.Helper.getEndpoint(e),e=p.getParameterToSync(e);s.HttpRequest.post(t,{data:e},function(){n.Helper.displayLog("Messenger Event Synced on: ",t)})},p.setRepeatPromptDelay=function(e){var t;0!==e&&(t=(t=new Date).setTime(t.getTime()+60*e*1e3),n.Helper.displayLog("Messenger: Setting repeat prompt delay for "+e+" minutes"),p.setMultiMessengerStorage(c.KeyMapper.IZOOTO_MSNGR_REPEAT_PROMPT_DELAY,t))},p.setMultiMessengerStorage=function(e,t){var o=a.Storage.getConfigLocal(i.Config.messenger.pageId,c.KeyMapper.IZOOTO_MESSENGER);(o=o?n.Helper.parseToJSON(o):{})[e]=t;o=JSON.stringify(o);a.Storage.setConfigLocal(i.Config.messenger.pageId,o,c.KeyMapper.IZOOTO_MESSENGER)},p.getMultiMessengerStorage=function(e){var t=a.Storage.getConfigLocal(i.Config.messenger.pageId,c.KeyMapper.IZOOTO_MESSENGER);return t&&null!=(t=n.Helper.parseToJSON(t))[e]?t[e]:""},p.sendEvent=function(e){var t=[c.KeyMapper.IZOOTO_MESSENGER_SUBSCRIBED];i.Config.messenger.syncPrompt&&t.push(c.KeyMapper.IZOOTO_MESSENGER_PROMPTED),-1!=t.indexOf(e)&&p.syncEvent(e)},p.getParameterToSync=function(e){var t=("pid="+i.Config.client+"\n\t\t\t\t\t\t\t&btype="+i.Config.global.browserType+"\n\t\t\t\t\t\t\t&dtype="+i.Config.global.deviceType+" \n\t\t\t\t\t\t\t&os="+i.Config.global.os+"\n                            &page_id="+i.Config.messenger.pageId+"\n\t\t\t\t\t\t\t&bKey="+n.Helper.getCurrentUUID()).replace(/^\s+|\s+$/gm,"").split("\n").join("");switch(e){case c.KeyMapper.IZOOTO_MESSENGER_SUBSCRIBED:t+="&ms=1";break;case c.KeyMapper.IZOOTO_MESSENGER_PROMPTED:t+="&msp=1";break;default:t+="&"+e+"=1"}return t},p.triggered=!1,p.appId="1061905150807841",p);function p(){}t.Messenger=o},function(e,t,o){"use strict";var i=this&&this.__awaiter||function(e,a,s,c){return new(s=s||Promise)(function(o,t){function i(e){try{r(c.next(e))}catch(e){t(e)}}function n(e){try{r(c.throw(e))}catch(e){t(e)}}function r(e){var t;e.done?o(e.value):((t=e.value)instanceof s?t:new s(function(e){e(t)})).then(i,n)}r((c=c.apply(e,a||[])).next())})},n=this&&this.__generator||function(o,i){var n,r,a,s={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]},e={next:t(0),throw:t(1),return:t(2)};return"function"==typeof Symbol&&(e[Symbol.iterator]=function(){return this}),e;function t(t){return function(e){return function(t){if(n)throw new TypeError("Generator is already executing.");for(;s;)try{if(n=1,r&&(a=2&t[0]?r.return:t[0]?r.throw||((a=r.return)&&a.call(r),0):r.next)&&!(a=a.call(r,t[1])).done)return a;switch(r=0,a&&(t=[2&t[0],a.value]),t[0]){case 0:case 1:a=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,r=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(!(a=0<(a=s.trys).length&&a[a.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!a||t[1]>a[0]&&t[1]<a[3])){s.label=t[1];break}if(6===t[0]&&s.label<a[1]){s.label=a[1],a=t;break}if(a&&s.label<a[2]){s.label=a[2],s.ops.push(t);break}a[2]&&s.ops.pop(),s.trys.pop();continue}t=i.call(o,s)}catch(e){t=[6,e],r=0}finally{n=a=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}([t,e])}}};Object.defineProperty(t,"__esModule",{value:!0});var s=o(4),c=o(1),p=o(0),r=o(7),a=o(2),l=o(6),g=o(3),d=o(9),o=(f.init=function(){return i(this,void 0,void 0,function(){var t,o;return n(this,function(e){switch(e.label){case 0:return c.Helper.displayLog("Initializing notification module..."),p.Config.notification.eventsToSync=p.Config.notification.eventsToSync.map(function(e){return s.NotificationHelper.syncableEvents[e]}),t=p.Config.notification.windowType,(o=0==p.Config.izootoStatus)?[3,2]:[4,s.NotificationHelper.isSupported()];case 1:o=!e.sent(),e.label=2;case 2:return o?(c.Helper.displayLog(p.Config.brandingPartner+" notification disabled!"),[2]):[3,3];case 3:return[4,s.NotificationHelper.setSubscriberIdFromDb()];case 4:if(e.sent(),6==t){if(window.top!=window.self)return s.NotificationHelper.noRootHandler(),[2]}else{if(5==t)return r.Debugger.verifyIzootoIntegration(),[2];if(4==t&&self!=top)return s.NotificationHelper.sendPermissionStatusFromFrame(),[2];if(2==t&&self!=top)return s.NotificationHelper.removeSubscriptionInFrame(),[2];if(1==t)return s.NotificationHelper.nativeHandler(),[2]}if(!t){if(window.self!=window.top)return l.Queue.sync(),[2];if(""!=p.Config.notification.allowedDomain&&(o=p.Config.global.locationProtocol+"//"+document.location.hostname,p.Config.notification.allowedDomain.indexOf(o)<0&&!t))return[2];d.GoogleAnalytics.initUsingConfig()}if(p.Config.store.isNotificationDisabledManually)return c.Helper.displayLog("Notfication prompt handled by site developer!"),[2];if(3==s.NotificationHelper.getPermissionStatusFromStorage())return s.NotificationHelper.sendEvent(g.KeyMapper.IZOOTO_ALREADY_UNSUBSCRIBED),[2];s.NotificationHelper.promptHandler(),e.label=5;case 5:return[2]}})})},f.optinCallback=function(e){try{"function"==typeof e&&(p.Config.notification.optinModule=new e,null!=p.Config.notification.optinModule.data&&(window.izOptinDesign=p.Config.notification.optinModule.data),s.NotificationHelper.showOptin())}catch(e){}},f.closeDialog=function(e){var t;try{a.Storage.removeStorage("izootoActivePrompt"),e=1===e?g.KeyMapper.IZOOTO_OPTIN_ALLOWED:g.KeyMapper.IZOOTO_OPTIN_CLOSED,s.NotificationHelper.sendEvent(e),null!==(t=document.getElementById("izmiddle-box"))&&void 0!==t&&t.remove()}catch(e){c.Helper.displayLog("Error removing div : ",e)}},f.openPopup=function(e){var t,o,i,n,r,a;void 0===e&&(e=!1),e&&this.closeDialog(1),2!=p.Config.global.browserType?p.Config.notification.isSdkHttps&&"https:"==p.Config.global.locationProtocol?s.NotificationHelper.nativeHandler():(c.Helper.addMsgReciever(s.NotificationHelper.msgReciever),r=null!=window.screenLeft?window.screenLeft:screen.left,a=null!=window.screenTop?window.screenTop:screen.top,t=window.innerWidth?window.innerWidth:document.documentElement.clientWidth?document.documentElement.clientWidth:screen.width,o=window.innerHeight?window.innerHeight:document.documentElement.clientHeight?document.documentElement.clientHeight:screen.height,n=i=200,e=p.Config.notification.promptType,1!==p.Config.notification.promptType&&2!=p.Config.notification.promptType||(e=1,n=i=500),r=t/2-i/2+r,a=o/2-n/2+a,p.Config.notification.hidePopup&&0===p.Config.notification.promptType&&(n=i=100,r=a=1e4),e=p.Config.notification.sourceOrigin+"?action=prompt&izpt="+e,1!=p.Config.notification.fullPopUp||0==p.Config.notification.promptType?(window.open(e,p.Config.brandingPartner+" Subscription","scrollbars=yes, width="+i+", height="+n+", top="+a+", left="+r),s.NotificationHelper.sendEvent(g.KeyMapper.IZOOTO_POPUP_OPEN)):window.open(e,p.Config.brandingPartner+" Subscription")):s.NotificationHelper.requestSafariPermission()},f);function f(){}t.Notification=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var s=o(1),i=o(0),o=(n.init=function(e){return new Promise(function(t,o){"undefined"==typeof indexedDB&&o("DB not supported"),""!=n.instance&&t(n.instance);var i=indexedDB.open("izooto",3);i.onerror=function(e){o("DB not load")},i.onsuccess=function(e){n.instance=i.result,s.Helper.displayLog("Success : IndexedDB Instance"),t(n.instance)},i.onupgradeneeded=function(e){var t=e.target.result,e=e.oldVersion;e<2&&(t.createObjectStore("swEvents",{keyPath:"eventName"}),t.createObjectStore("options",{keyPath:"key"})),e<3&&t.createObjectStore("notificationLog",{keyPath:"key"})}}).catch(function(e){s.Helper.displayLog(e)})},n.addUpdate=function(i,n,r){return new Promise(function(t,o){var e=i.transaction(["options"],"readwrite").objectStore("options").put({key:n,val:r});e.onsuccess=function(e){t(n+" added to db.")},e.onerror=function(e){o("Unable to add data in db!")}}).catch(function(e){s.Helper.displayLog(e)})},n.getData=function(e,n,r){return new Promise(function(o,t){var i=e.transaction([n]).objectStore(n).get(r);i.onerror=function(e){t("Unable to retrieve data from db!")},i.onsuccess=function(e){var t="";i.result?t=i.result:s.Helper.displayLog("Not found in db!"),o(t)}}).catch(function(e){s.Helper.displayLog(e)})},n.getIndexDBData=function(t,r,a){return new Promise(function(o,i){var e=t.transaction([r]).objectStore(r),n="all"==a?e.getAll():e.get(a);n.onerror=function(e){i("Unable to retrieve data from db!")},n.onsuccess=function(e){var t="";n.result?t=n.result:i("Not found in db! "+r+"::"+a),o(t)}}).catch(function(e){s.Helper.displayLog(e)})},n.setIndexedDb=function(o){window._izooto.sysEvents=i.Config.notification.sysEvents,"gaId"==o&&1!=i.Config.ga.swEvents||"sysEvents"==o&&1!=i.Config.notification.sysEventsFlag?s.Helper.displayLog("Not saved : ",o):n.init().then(function(t){n.getData(t,"options",o).then(function(e){(e&&!e.hasOwnProperty("val")||e.val!=window._izooto[o])&&n.addUpdate(t,o,window._izooto[o]).then(function(e){s.Helper.displayLog(e)}).catch(function(e){s.Helper.displayLog(e)})}).catch(function(e){s.Helper.displayLog(e)})}).catch(function(e){s.Helper.displayLog(e)})},n.instance="",n);function n(){}t.IndexedDB=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=o(0),d=o(1),f=o(2),u=o(5),O=o(4),a=o(11),y=o(3),o=(m.init=function(e){window._izooto[m._izLastVariantCookieName]="";var t,o=null!=e?e:!1;if(2==g.Config.notification.isShopify)return m.shopifyCart(),void d.Helper.displayLog("Old Shopify");1==g.Config.notification.isShopify&&(d.Helper.displayLog("New Shopify"),e=5*Math.random(),(t=new XMLHttpRequest).addEventListener("load",function(e){m.shopifyCartTracker(t,o)}),t.open("GET","/cart.js?"+e),t.send()),m.resetProductCookie(),m.checkAndSendShopifyEvents(!0)},m.shopifyCartTracker=function(e,t){var o,i="iz_sh_cart_v2";d.Helper.displayLog(e),d.Helper.displayLog("Purge :"+t),n=d.Helper.parseToJSON(e.responseText),d.Helper.displayLog(n),n.items,o=n.token;var n,r=f.Storage.getStorage(i);null!=o&&""!=o&&((e=new Date).setTime(e.getTime()+864e5),e.toUTCString(),o==r&&!t||(n=f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN),e=0,n=d.Helper.parseToJSON(n),1<Object.keys(n).length&&(e=1),d.Helper.displayLog("[Mapper hit]"),r=d.Helper.getEndpoint("ShopifyMapper"),t=f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN),t=d.Helper.parseToJSON(t),t="bkey="+d.Helper.getCurrentUUID(),1==e&&(t=t+"&auth="+n.keys.auth+"&pk="+n.keys.p256dh),t+="&btype="+d.Helper.getBrowserType(),t+="&dtype="+d.Helper.getDeviceType(),t+="&pid="+g.Config.client,t+="&shopify_token="+o,g.Config.global.browserName!=y.KeyMapper.BROWSER_SAFARI&&(t+="&"+d.Helper.endPointParamExtract(f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN))),t+="&pte="+g.Config.notification.subscriptionType,t+="&custom_topic=custom-js-mapper",u.HttpRequest.post(r,{data:t},function(){}),a.CookieStorage.setCookie(i,o,1)))},m.shopifyFix=function(){try{var e=document.createElement("img");e.style.width="0px",e.style.height="0px",e.src=document.location.protocol+"//"+document.location.hostname+g.Config.notification.manifest}catch(e){}},m.shopifyCart=function(){var e=f.Storage.getStorage("cart");if(void 0!==e&&""!==e&&(-1!=e.indexOf("=")&&(e=e.split("=")[1]),e!==f.Storage.getStorage("iz_sh_cart"))){if("ckout="==e)return;a.CookieStorage.setCookie("iz_sh_cart",e),window._izq.push(["event","add_to_cart",{cart_id:e}]),d.Helper.displayLog("Sent add to cart event : "+e)}},m.resetProductCookie=function(){window._izooto[m._izLastVariantCookieName]="",a.CookieStorage.setCookie(m._izLastVariantCookieName,"")},m.checkIfVariantChanged=function(){var e=""==window._izooto[m._izLastVariantCookieName]?a.CookieStorage.getCookie(m._izLastVariantCookieName):window._izooto[m._izLastVariantCookieName],t=window.ShopifyAnalytics.meta.selectedVariantId;return d.Helper.displayLog("Product heartbeat"),1!=m.sentShopifyProduct&&(void 0===t?(m.sentShopifyProduct=1,!0):t!=e&&(d.Helper.displayLog("Set cookie of iz_last_sh_variant"),window._izooto[m._izLastVariantCookieName]=t,a.CookieStorage.setCookie(m._izLastVariantCookieName,t),!0))},m.listenToProductVariant=function(e){m.checkIfVariantChanged()&&(d.Helper.displayLog("Variant modified"),e()),setTimeout(function(){m.listenToProductVariant(e)},m._izProductVariantModifiedCheckInterval)},m.getShopifyModule=function(){var e;try{if(e=window.ShopifyAnalytics.meta.page.pageType)return e}catch(e){g.Config.debug&&console.warn("ShopifyAnalytics not available, parsing URL")}var t=location.hostname,o=location.pathname.split("/"),i=o[1],o=o[2];if(d.Helper.displayLog("PartOne :"+o+", PartZero:"+i),""===i)return m._izShopifyModules.storeSections.home;if(i===m._izShopifyModules.storeRoots.cart)return m._izShopifyModules.storeRoots.cart;if(i===m._izShopifyModules.storeRoots.account&&o===m._izShopifyModules.storeRoots.orders)return m._izShopifyModules.storeRoots.orders;if("account"===i&&!i)return m._izShopifyModules.storeSections.orders;if("checkout.shopify.com"===t||"checkouts"===o)return m._izShopifyModules.storeSections.checkout;if(void 0!==window.__st&&window.__st.s){o=window.__st.partZero.split("-")[0];if("collections"===o)return m._izShopifyModules.storeSections.collection;if("products"===o)return m._izShopifyModules.storeSections.product}},m.sendShopifyProductViewEvent=function(){var e=location.pathname,p=window.ShopifyAnalytics.meta.selectedVariantId,e=e.split("/"),l=e[e.length-1],e=m._izAjaxApi.products+l;e+="?izreq=product";u.HttpRequest.get(e,function(e){try{var t=JSON.parse(e)}catch(e){d.Helper.displayLog("Could not fetch data from product API")}if("object"==typeof t&&""!=f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN)){var o,i=t.product,n=i.variants,r=f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN),a=d.Helper.getEndpoint("shopifyAPI")+"?p=p",s="pid="+g.Config.client;for(o in s+=O.NotificationHelper.getSubscriptionParameters(r),s+="&btype="+d.Helper.getBrowserType(),s+="&pte="+g.Config.notification.subscriptionType,s+="&custom_topic="+m._izShopifyTopics.productView,s+="&product_id="+i.id.toString(),s+="&product_title="+encodeURIComponent(i.title),s+="&product_handle="+encodeURIComponent(l),s+="&product_page="+encodeURIComponent(window.location.href),s+="&product_type="+i.product_type,d.Helper.displayLog(i),null!=i.image&&null!=i.image.src&&(s+="&product_image="+i.image.src),n){var c=n[o];if(c.id==p){s+="&product_price="+c.price;break}}u.HttpRequest.post(a,{data:s},function(e){d.Helper.displayLog(e)}),d.Helper.displayLog("Shopify product view event attempted successfully.")}},void 0,{Accept:"application/json"})},m.sendShopifyCollectionViewEvent=function(){var e=m._izShopifyModules.storeSections.collection+"s",t=location.pathname.split("/"),e=t.indexOf(e);if(-1==e)d.Helper.displayLog("Unable to identify collection");else{var a=t[e+1];if(m._izEventNames.collectionAll==a)return void d.Helper.displayLog("Ignoring collection view event for:"+m._izEventNames.collectionAll);e=m._izAjaxApi.collections+a;e+="?izreq=collections";u.HttpRequest.get(e,function(e){var t,o,i,n,r;try{t=JSON.parse(e)}catch(e){d.Helper.displayLog("Could not fetch data from collection API")}"object"==typeof t&&""!=f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN)&&(o=t.collection,i=d.Helper.getEndpoint("shopifyAPI")+"?p=p",n=f.Storage.getStorage(y.KeyMapper.IZOOTO_PUSH_TOKEN),r="pid="+g.Config.client,r+=O.NotificationHelper.getSubscriptionParameters(n),r+="&btype="+d.Helper.getBrowserType(),r+="&pte="+g.Config.notification.subscriptionType,r+="&custom_topic="+m._izShopifyTopics.collectionView,r+="&collection_id="+o.id.toString(),r+="&collection_handle="+encodeURIComponent(a),r+="&collection_title="+encodeURIComponent(o.title),r+="&collection_page="+encodeURIComponent(window.location.href),null!=o.image&&null!=o.image.src&&(r+="&collection_image="+o.image.src),u.HttpRequest.post(i,{data:r},function(e){d.Helper.displayLog(e)}),d.Helper.displayLog("Shopify collection view event attempted successfully."))},void 0,{Accept:"application/json"})}},m.checkAndSendShopifyEvents=function(e){var t=m.getShopifyModule();switch(d.Helper.displayLog("Detected shopify module : ",t),t){case m._izShopifyModules.storeSections.collection:d.Helper.displayLog("Inside collection view case"),m.sendShopifyCollectionViewEvent();break;case m._izShopifyModules.storeSections.product:d.Helper.displayLog("Inside product view case"),null!=e&&e?(d.Helper.displayLog("Now listening to product view event"),m.listenToProductVariant(m.sendShopifyProductViewEvent)):m.sendShopifyProductViewEvent()}},m._izShopifyModules={storeSections:{home:"home",collection:"collection",product:"product",cart:"cart",checkout:"checkout",order:"order",orders:"orders"},storeRoots:{cart:"cart",account:"account",orders:"orders"}},m._izEventNames={productView:"product_viewed",collectionView:"collection_viewed",collectionAll:"all"},m._izAjaxApi={products:"/products/",collections:"/collections/"},m._izShopifyTopics={productView:"product/view",collectionView:"collection/view"},m._izLastVariantCookieName="iz_last_sh_variant",m._izProductVariantModifiedCheckInterval=5e3,m.sentShopifyProduct=0,m);function m(){}t.Shopify=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),n=o(1),r=o(4),a=o(5),s=o(2),c=o(6),p=o(3),o=(l.init=function(){try{null!=i.Config.notification.gdprPrompt&&self==top&&null!=i.Config.notification.gdprPrompt.template&&""!=i.Config.notification.gdprPrompt.template&&(i.Config.notification.gdprPrompt.title=null!=i.Config.notification.gdprPrompt.title&&""!=i.Config.notification.gdprPrompt.title?i.Config.notification.gdprPrompt.title:"In order to send relevant and personalized notifications to you, we would like to capture your location and website activity.",i.Config.notification.gdprPrompt.btn2Txt=null!=i.Config.notification.gdprPrompt.btn2Txt&&""!=i.Config.notification.gdprPrompt.btn2Txt?i.Config.notification.gdprPrompt.btn2Txt:"Agree",i.Config.notification.gdprPrompt.btn1Txt=null!=i.Config.notification.gdprPrompt.btn1Txt&&""!=i.Config.notification.gdprPrompt.btn1Txt?i.Config.notification.gdprPrompt.btn1Txt:"Not Now",i.Config.notification.gdprPrompt.template=r.NotificationHelper.loadDesign(i.Config.notification.gdprPrompt,i.Config.notification.gdprPrompt.template))}catch(e){}var e=s.Storage.getConfigLocal(p.KeyMapper.IZOOTO_GDPR_CONSENT);return 1==e||3==e?(n.Helper.displayLog("GDPR prompt is already allowed by the user"),void(i.Config.notification.isGdprAllowed=1)):2==e?(n.Helper.displayLog("GDPR prompt is already denied by the user"),void(i.Config.notification.isGdprAllowed=0)):void(1==i.Config.notification.gdprPromptStatus&&l.getGdprLocation())},l.closeGdprDialog=function(e){var t;try{null!==(t=document.getElementById("izgdpr-box"))&&void 0!==t&&t.remove()}catch(e){n.Helper.displayLog("Error Removing GDPR : ",e)}},l.gdprAllow=function(){l.closeGdprDialog(),s.Storage.setConfigLocal(p.KeyMapper.IZOOTO_GDPR_CONSENT,1),i.Config.notification.isGdprAllowed=1,c.Queue.sync(),l.sendGdprStatus(1)},l.sendGdprStatus=function(e){try{var t=n.Helper.getEndpoint("gdprStatusUrl"),o=r.NotificationHelper.getDeviceParameters(),i=s.Storage.getStorage(p.KeyMapper.IZOOTO_PUSH_TOKEN);o+=r.NotificationHelper.getSubscriptionParameters(i),o+="&gs="+e,r.NotificationHelper.getExtraParameterToSync().then(function(e){o+=e,a.HttpRequest.post(t,{data:o},function(){n.Helper.displayLog("GDPR Status sent")})})}catch(e){}},l.getGdprLocation=function(){a.HttpRequest.get(n.Helper.getEndpoint("gdprLocationUrl"),function(e,t){200==t&&(n.Helper.displayLog("GDPR Location: ",e),1==(e=n.Helper.parseToJSON(e)).status?l.openGdprDialog():s.Storage.setConfigLocal(p.KeyMapper.IZOOTO_GDPR_CONSENT,3))})},l.openGdprDialog=function(){n.Helper.addHTML("div",i.Config.notification.gdprPrompt.template,"izgdpr-box")},l.gdprDisallow=function(){l.closeGdprDialog(),s.Storage.setConfigLocal(p.KeyMapper.IZOOTO_GDPR_CONSENT,2),l.sendGdprStatus(2)},l);function l(){}t.GDPR=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=o(4),a=o(1),r=o(0),s=o(2),c=o(3),o=(p.init=function(){a.Helper.displayLog("Tab Abandonment"),p.timerInstance=0,p.focused=!0,1==r.Config.tabAbandonment.status&&(p.interval=setInterval(function(){document.hasFocus()?p.focused||p.onFocus():p.focused&&p.onBlur()},1e3))},p.run=function(){p.reset(),a.Helper.displayLog("Tab Abandonment : Initialized");var e={url:window.location.href};s.Storage.setConfigLocal(c.KeyMapper.IZOOTO_TAB_ABANDONMENT,JSON.stringify(e))},p.onBlur=function(){p.focused=!1,p.run(),p.timerInstance=setInterval(function(){var t=s.Storage.getConfigLocal(c.KeyMapper.IZOOTO_TAB_ABANDONMENT);r.Config.tabAbandonment.counter++;try{t=JSON.parse(t)}catch(e){t={}}a.Helper.displayLog("TabAbandonment counter : ",r.Config.tabAbandonment.counter),t.url!=window.location.href?p.reset():r.Config.tabAbandonment.counter==r.Config.tabAbandonment.timeout&&(p.pushNotification(),p.reset())},1e3),a.Helper.displayLog("Ta : blurred")},p.onFocus=function(){p.focused=!0,p.reset(),a.Helper.displayLog("Ta : focused")},p.reset=function(){a.Helper.displayLog("Tab Abandonment : timer reset"),r.Config.tabAbandonment.counter=0,clearInterval(p.timerInstance)},p.pushNotification=function(){var e,t,o=r.Config.tabAbandonment.pushTimeout,i=p.getPayload();""!=i.id&&""!=i.rid&&(e=s.Storage.getConfigLocal(c.KeyMapper.IZOOTO_TAB_ABANDONMENT_PUSH,c.KeyMapper.IZOOTO_SYNC),t=a.Helper.getTimeDiff(e,!0),""!=e&&t<o?p.reset():n.NotificationHelper.sendLocalNotification(i).then(function(){s.Storage.updateLastSync(c.KeyMapper.IZOOTO_TAB_ABANDONMENT_PUSH),n.NotificationHelper.syncNotificationView(i),n.NotificationHelper.syncNotificationSent(i)}))},p.getPayload=function(){var e={};e.key=r.Config.client,e.title="You were reading <~[@article_title]~>",e.message="Pick up where you left off",e.icon="https://cdnimg.izooto.com/icons/4/JD-12-128.png",e.banner="<~[@featured_image]~>",e.link="<~[@last_visited_url]~>",e.tag="tabAbandonment",e.reqInt=!0,e.id="",e.rid="",e.viewFlag=1,e.clickFlag=1,e.sysEvents=0,e.domainNum=0;var t=window.location.href;t.indexOf("utm_campaign=")<0&&(e.link+=t.includes("?")?"&":"?",e.link+="utm_source=izooto&utm_medium=push_notifications&utm_campaign=recover_abandoned_tab&utm_term=notification1");var o,i=r.Config.tabAbandonment.data;for(o in e)i.hasOwnProperty(o)||(i[o]=e[o]);return i=p.getFilterData(i)},p.urlUtmHandler=function(e,t){var o,i,n=t.split("&"),r={};for(o in n){var a=n[o].split("=");r[a[0]]=a[1]}for(i in e=new URL(e),r)e.searchParams.set(i,r[i]);return e.href},p.getFilterData=function(e){var t,o,i,n={},r=window.location.href;for(t in n.article_title=""!=a.Helper.getMetaValue("og:title")?a.Helper.getMetaValue("og:title"):a.Helper.getMetaValue("title"),n.featured_image=a.Helper.getMetaValue("og:image"),n.last_visited_url=r,e){"string"==typeof e[t]&&0<=e[t].indexOf("<~[@")&&(o=e[t].indexOf("<~[@"),i=e[t].indexOf("]~>"),"last_visited_url"==(o=e[t].substring(o+4,i))&&0<e[t].indexOf("utm_campaign")?(i=e[t].split("?"),e[t]=i[0],i=i[1],e[t]=e[t].replace("<~[@"+o+"]~>",n[o]),e[t]=p.urlUtmHandler(r,i)):e[t]=e[t].replace("<~[@"+o+"]~>",n[o]))}return e},p);function p(){}t.TabAbandonments=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),r=o(1),o=(a.init=function(){i.Config.videoDropoff.status&&a.isCurrentUrlMatchingWith(i.Config.videoDropoff.allowedUrls)&&(r.Helper.displayLog("Initializing recover video watchtime playbook..."),a.detectPlayer())},a.syncTrigger=function(e,t){window._izq.push(["trigger",e,t])},a.sendToApi=function(e){var t=0,o=a.playerState;if(0==o.length)o.push(e);else{for(var i=0;i<o.length;i++)if(o[i].playerId==e.playerId){if(o[i].status==e.status)return;o[i]=e,t=1;break}t||o.push(e)}var n={player_id:e.playerId,title:e.title,url:e.url,player:e.player_type,duration:e.duration.toString()};e.hasOwnProperty("thumbnail")&&(n.thumbnail=e.thumbnail);try{"started"==e.status?a.syncTrigger("video_started",n):"ended"==e.status&&a.syncTrigger("video_completed",{playerid:e.playerId})}catch(e){}r.Helper.displayLog("Video Payload : ",n)},a.html5Payload=function(e,t){void 0===e&&(e="started");var o=[];o.status=e,o.playerId=t.id,o.title=document.title,o.url=location.href,o.player_type="html5",o.duration=t.duration,a.sendToApi(o)},a.html5Handler=function(){var e=document.querySelectorAll("video");e&&e.forEach(function(e){var t;e.id||(t=a.generateRandomString("iz-video-",7),e.setAttribute("id",t)),e.onplaying=function(){r.Helper.displayLog("Playing html 5 video!");a.html5Payload("started",e)},e.onended=function(){a.html5Payload("ended",e)}})},a.ytPayload=function(e,t){void 0===e&&(e="started");var o=[];o.status=e,o.playerId=t.getIframe().id,o.title=t.playerInfo.videoData.title||document.title;e="https://img.youtube.com/vi/"+t.playerInfo.videoData.video_id+"/0.jpg";o.thumbnail=e,o.url=location.href,o.player_type="youtube",o.duration=t.playerInfo.duration,a.sendToApi(o)},a.isValidYtUrl=function(e){return new RegExp("^https://(?:www.)?youtube.com/embed/[A-z0-9]+").test(e)},a.initYtPlayer=function(e){if(window.YT,0,window.YT.get(e)){var t=window.YT.get(e);return t.addEventListener("onStateChange",a.onYtPlayerStateChange),t}return new window.YT.Player(e,{events:{onStateChange:a.onYtPlayerStateChange}})},a.onYtPlayerStateChange=function(e){switch(e.data){case window.YT.PlayerState.PLAYING:a.ytPayload("started",e.target);break;case window.YT.PlayerState.ENDED:a.ytPayload("ended",e.target)}},a.fixPlayerReference=function(i){setInterval(function(){for(var e=0;e<i.length;e++){var t=i[e].getIframe(),o=a.getClosureKeyName(i[e]);i[e][o]!==window.YT.get(t.id)[o]&&(i[e]=window.YT.get(t.id),i[e].addEventListener("onStateChange",a.onYtPlayerStateChange))}},1e3)},a.fixYtEnableJsApi=function(e){var t=new URL(e.src);""==r.Helper.getParamFromUrl(e.src,"enablejsapi")?(t.searchParams.set("enablejsapi","1"),e.setAttribute("src",t)):null==r.Helper.getParamFromUrl(e.src,"enablejsapi")&&(t.searchParams.append("enablejsapi","1"),e.setAttribute("src",t))},a.fixYtOrigin=function(e){var t=new URL(e.src);""==r.Helper.getParamFromUrl(e.src,"origin")?(t.searchParams.set("origin",window.location.origin),e.setAttribute("src",t)):null==r.Helper.getParamFromUrl(e.src,"origin")&&(t.searchParams.append("origin",window.location.origin),e.setAttribute("src",t))},a.isJsApiEnabled=function(e){return null!=r.Helper.getParamFromUrl(e,"enablejsapi")},a.addYTApiScirptPromise=function(){return new Promise(function(e,t){var o,i,n=setInterval(function(){"object"==typeof window.YT&&"function"==typeof window.YT.get&&(clearInterval(n),e(!0))},1e3);void 0!==window.YT?e(!0):((o=document.createElement("script")).src="//www.youtube.com/player_api",(i=document.getElementsByTagName("script")[0]).parentNode.insertBefore(o,i))}).catch(function(e){r.Helper.displayLog(e)})},a.ytHandler=function(){setInterval(function(){for(var e,t,i=document.querySelectorAll("iframe[src*='https://www.youtube.com/embed/']"),o=0;o<i.length;o++){a.isValidYtUrl(i[o].src)&&(i[o].hasAttribute("izplayer")||(i[o].setAttribute("izplayer","1"),i[o].id||(e=a.generateRandomString("iz-video-",7),i[o].setAttribute("id",e)),a.fixYtOrigin(i[o]),a.isJsApiEnabled(i[o].src)?function(t){var o=setInterval(function(){try{var e=window.YT.get(i[t].id);e&&(clearInterval(o),e.addEventListener("onStateChange",a.onYtPlayerStateChange),a.ytPlayerReference.push(e))}catch(e){}},1e3)}(o):(t=i[o],a.fixYtEnableJsApi(t),a.addYTApiScirptPromise().then(function(){var e=a.initYtPlayer(t.id);a.ytPlayerReference.push(e)}))))}a.fixPlayerReference(a.ytPlayerReference)},1e3)},a.detectPlayer=function(){a.html5Handler(),a.ytHandler()},a.isCurrentUrlMatchingWith=function(e){if(0==e.length)return 1;for(var t=0;t<e.length;t++)if(-1!=document.location.href.search(e[t]))return r.Helper.displayLog("Matched with :",e[t]),1;return 0},a.ytPlayerReference=[],a.playerState=[],a.generateRandomString=function(e,t){return void 0===e&&(e=""),void 0===t&&(t=7),e+Math.random().toString(36).substring(t)},a.getClosureKeyName=function(e){try{for(var t in e){if(-1!=t.search("closure_"))return t.toString()}}catch(e){throw new Error("Please update keyName of player")}},a);function a(){}t.VideoDropOff=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),n=o(1),r=o(20),a=o(2),s=o(3),o=(c.init=function(){n.Helper.displayLog("Paid Subscriber status:",i.Config.CRPSPlaybook.isPaidSubscriber),i.Config.CRPSPlaybook.status&&c.isSyncAllowed()&&c.sendStartTrigger()},c.isSyncAllowed=function(){if(3<r.Session.getSessionCount()&&!i.Config.notification.windowType&&!i.Config.CRPSPlaybook.isPaidSubscriber){var e=a.Storage.getConfigLocal(s.KeyMapper.IZOOTO_CRPS_PLAYBOOK,s.KeyMapper.IZOOTO_SYNC);return e&&n.Helper.getDateDiffrenceFromPresent(e)<=c.reSendTriggerDays?(n.Helper.displayLog("Abort! Reader to paid subscriber last sync not expired!"),!1):!0}return!1},c.sendStartTrigger=function(){window._izq.push(["trigger",i.Config.CRPSPlaybook.startTriggerName],void 0,function(e,t){200==t&&(a.Storage.updateLastSync(s.KeyMapper.IZOOTO_CRPS_PLAYBOOK),n.Helper.displayLog("ReadersToPaidSubscribers Start Trigger sent  sucessfully!"))})},c.reSendTriggerDays=30,c);function c(){}t.CRPSPlaybook=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),n=o(1),r=o(2),a=o(3),o=(s.init=function(){i.Config.global.isSessionHandled||(s.sessionHandler(),i.Config.global.isSessionHandled=!0)},s.sessionHandler=function(){var e;n.Helper.displayLog("Session handler initiated..."),s.isSessionExpired()&&(t=r.Storage.getConfigLocal(a.KeyMapper.IZOOTO_SESSION_COUNT,a.KeyMapper.IZOOTO_SESSION),e=r.Storage.getConfigLocal(a.KeyMapper.IZOOTO_FIRST_SESSION,a.KeyMapper.IZOOTO_SYNC),t&&e&&n.Helper.getDateDiffrenceFromPresent(e)<=s.visitWithinDays?r.Storage.setConfigLocal(a.KeyMapper.IZOOTO_SESSION_COUNT,t+1,a.KeyMapper.IZOOTO_SESSION):(r.Storage.setConfigLocal(a.KeyMapper.IZOOTO_SESSION_COUNT,1,a.KeyMapper.IZOOTO_SESSION),r.Storage.updateLastSync(a.KeyMapper.IZOOTO_FIRST_SESSION)));var t=(t=new Date).setTime(t.getTime()+60*s.sessionExpiryMinute*1e3);n.Helper.displayLog("if inactivity detected session will expired at : ",new Date(t)),r.Storage.setConfigLocal(a.KeyMapper.IZOOTO_SESSION_EXPIRY,t,a.KeyMapper.IZOOTO_SESSION)},s.isSessionExpired=function(){var e=r.Storage.getConfigLocal(a.KeyMapper.IZOOTO_SESSION_EXPIRY,a.KeyMapper.IZOOTO_SESSION),t=new Date;return!(""!=e&&e>t.getTime())&&(n.Helper.displayLog("Session expired detected!"),!0)},s.getSessionCount=function(){return r.Storage.getConfigLocal(a.KeyMapper.IZOOTO_SESSION_COUNT,a.KeyMapper.IZOOTO_SESSION)||0},s.sessionExpiryMinute=30,s.visitWithinDays=7,s);function s(){}t.Session=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(2),n=o(3),r=o(0),a=o(1),o=(s.init=function(){r.Config.recommendArticle.status&&"/"!=s.currentArticlePath&&(a.Helper.displayLog("Recommend Article initilalized!"),s.isSyncAllowed()&&s.sync())},s.isSyncAllowed=function(){var e=new Date,t=i.Storage.getConfigLocal(n.KeyMapper.LAST_SYNC_OF_RECOMMEND_ARTICLE,n.KeyMapper.IZOOTO_SYNC);if(!t)return!0;var o=new Date(t);if(e.getDate()!=o.getDate())return i.Storage.removeConfigLocal(n.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,n.KeyMapper.IZOOTO_RECOMMEND_ARTICLE),!0;if(e.getTime()<e.setTime(t+1e3*s.recommendArticleExpire))return a.Helper.displayLog("Recommend Article wait till time expire!"),!1;t=i.Storage.getConfigLocal(n.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,n.KeyMapper.IZOOTO_RECOMMEND_ARTICLE);return(t=a.Helper.parseToJSON(t)||[]).length<s.dailyArticleSyncLimit&&-1==t.indexOf(s.currentArticlePath)||(a.Helper.displayLog("Recommend Article Aborted: same url already synced! or  daily limit reached"),!1)},s.sync=function(){var o=i.Storage.getConfigLocal(n.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,n.KeyMapper.IZOOTO_RECOMMEND_ARTICLE);(o=a.Helper.parseToJSON(o)||[]).push(s.currentArticlePath);var e=[window.location.protocol,"//",window.location.host,window.location.pathname].join("");window._izq.push(["trigger",s.triggerName,{article_url:e},function(e,t){200==t&&(i.Storage.setConfigLocal(n.KeyMapper.RECOMMEND_ARTICLE_SYNCED_PATH,JSON.stringify(o),n.KeyMapper.IZOOTO_RECOMMEND_ARTICLE),i.Storage.updateLastSync(n.KeyMapper.LAST_SYNC_OF_RECOMMEND_ARTICLE),a.Helper.displayLog("Recommend Article synced sucessfully!"))}])},s.currentArticlePath=window.document.location.pathname,s.dailyArticleSyncLimit=2,s.triggerName="_article_read",s.recommendArticleExpire=7200,s);function s(){}t.RecommendArticle=o},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=o(0),n=o(1),o=(r.init=function(){1==i.Config.autoSegmentStatus&&r.addCustomModuleConfig()},r.addCustomModuleConfig=function(){var e=i.Config.hashFileName;e?(e="https://cdn.izooto.com/scripts/custom/"+e+".js",n.Helper.addExternalJS(e,"izCustomModule",!0).then(r.customModuleHandler).catch(function(e){n.Helper.displayLog("Failed to add custom module script")})):n.Helper.displayLog(i.Config.brandingPartner+" hash file name not found!")},r.customModuleHandler=function(){try{var e=window._izootoCustomeModuleConfig?window._izootoCustomeModuleConfig:void 0;if(e){if(e.hasOwnProperty("autoSegmentMethod")&&1==i.Config.autoSegmentStatus)try{window._izootoCustomeModuleConfig.autoSegmentMethod=n.Helper.getParsedMethod(e.autoSegmentMethod),r.autoSegmentHandler(e.autoSegmentMethod)}catch(e){}}else n.Helper.displayLog("No any custom module found!")}catch(e){}},r.autoSegmentHandler=function(e){var t,o;"function"==typeof e&&(t=[],"string"==typeof(e=e())&&""!=e?t.push(e):t=e,Array.isArray(t)&&t.length?(o={},t.forEach(function(e){o[e]=!0}),n.Helper.displayLog("Pushing user profile :",o),window._izq.push(["userProfile",{add:o}])):n.Helper.displayLog("No segment found to sycn!"))},r);function r(){}t.AutoSegment=o},function(e,t,ge){(function(ce,pe){var le;e.exports=function(){"use strict";function o(e){return typeof e==="function"||typeof e==="object"&&e!==null}function p(e){return typeof e==="function"}var e=undefined;if(!Array.isArray){e=function(e){return Object.prototype.toString.call(e)==="[object Array]"}}else{e=Array.isArray}var i=e,n=0,r=undefined,a=undefined,s=function e(t,o){_[n]=t;_[n+1]=o;n+=2;if(n===2){if(a){a(C)}else{T()}}};function t(e){a=e}function c(e){s=e}var l=typeof window!=="undefined"?window:undefined,g=l||{},d=g.MutationObserver||g.WebKitMutationObserver,f=typeof self==="undefined"&&typeof ce!=="undefined"&&{}.toString.call(ce)==="[object process]",u=typeof Uint8ClampedArray!=="undefined"&&typeof importScripts!=="undefined"&&typeof MessageChannel!=="undefined";function O(){return function(){return ce.nextTick(C)}}function y(){return function(){r(C)}}function m(){var e=0;var t=new d(C);var o=document.createTextNode("");t.observe(o,{characterData:true});return function(){o.data=e=++e%2}}function b(){var e=new MessageChannel;e.port1.onmessage=C;return function(){return e.port2.postMessage(0)}}function S(){var e=setTimeout;return function(){return e(C,1)}}var _=new Array(1e3);function C(){for(var e=0;e<n;e+=2){var t=_[e];var o=_[e+1];t(o);_[e]=undefined;_[e+1]=undefined}n=0}function v(){try{var e=le;var t=ge(26);r=t.runOnLoop||t.runOnContext;return y()}catch(e){return S()}}var T=undefined;if(f){T=O()}else if(d){T=m()}else if(u){T=b()}else if(l===undefined&&"function"==="function"){T=v()}else{T=S()}function w(e,t){var o=arguments;var i=this;var n=new this.constructor(I);if(n[P]===undefined){X(n)}var r=i._state;if(r){(function(){var e=o[r-1];s(function(){return G(r,n,e,i._result)})})()}else{Y(i,n,e,t)}return n}function h(e){var t=this;if(e&&typeof e==="object"&&e.constructor===t){return e}var o=new t(I);Z(o,e);return o}var P=Math.random().toString(36).substring(16);function I(){}var M=void 0,E=1,D=2,N=new F;function H(){return new TypeError("You cannot resolve a promise with itself")}function R(){return new TypeError("A promises callback cannot return that same promise.")}function L(e){try{return e.then}catch(e){N.error=e;return N}}function A(e,t,o,i){try{e.call(t,o,i)}catch(e){return e}}function z(e,i,n){s(function(t){var o=false;var e=A(n,i,function(e){if(o){return}o=true;if(i!==e){Z(t,e)}else{x(t,e)}},function(e){if(o){return}o=true;B(t,e)},"Settle: "+(t._label||" unknown promise"));if(!o&&e){o=true;B(t,e)}},e)}function k(t,e){if(e._state===E){x(t,e._result)}else if(e._state===D){B(t,e._result)}else{Y(e,undefined,function(e){return Z(t,e)},function(e){return B(t,e)})}}function K(e,t,o){if(t.constructor===e.constructor&&o===w&&t.constructor.resolve===h){k(e,t)}else{if(o===N){B(e,N.error)}else if(o===undefined){x(e,t)}else if(p(o)){z(e,t,o)}else{x(e,t)}}}function Z(e,t){if(e===t){B(e,H())}else if(o(t)){K(e,t,L(t))}else{x(e,t)}}function U(e){if(e._onerror){e._onerror(e._result)}W(e)}function x(e,t){if(e._state!==M){return}e._result=t;e._state=E;if(e._subscribers.length!==0){s(W,e)}}function B(e,t){if(e._state!==M){return}e._state=D;e._result=t;s(U,e)}function Y(e,t,o,i){var n=e._subscribers;var r=n.length;e._onerror=null;n[r]=t;n[r+E]=o;n[r+D]=i;if(r===0&&e._state){s(W,e)}}function W(e){var t=e._subscribers;var o=e._state;if(t.length===0){return}var i=undefined,n=undefined,r=e._result;for(var a=0;a<t.length;a+=3){i=t[a];n=t[a+o];if(i){G(o,i,n,r)}else{n(r)}}e._subscribers.length=0}function F(){this.error=null}var j=new F;function V(e,t){try{return e(t)}catch(e){j.error=e;return j}}function G(e,t,o,i){var n=p(o),r=undefined,a=undefined,s=undefined,c=undefined;if(n){r=V(o,i);if(r===j){c=true;a=r.error;r=null}else{s=true}if(t===r){B(t,R());return}}else{r=i;s=true}if(t._state!==M){}else if(n&&s){Z(t,r)}else if(c){B(t,a)}else if(e===E){x(t,r)}else if(e===D){B(t,r)}}function J(o,e){try{e(function e(t){Z(o,t)},function e(t){B(o,t)})}catch(e){B(o,e)}}var q=0;function Q(){return q++}function X(e){e[P]=q++;e._state=undefined;e._result=undefined;e._subscribers=[]}function $(e,t){this._instanceConstructor=e;this.promise=new e(I);if(!this.promise[P]){X(this.promise)}if(i(t)){this._input=t;this.length=t.length;this._remaining=t.length;this._result=new Array(this.length);if(this.length===0){x(this.promise,this._result)}else{this.length=this.length||0;this._enumerate();if(this._remaining===0){x(this.promise,this._result)}}}else{B(this.promise,ee())}}function ee(){return new Error("Array Methods must be provided an Array")}function te(e){return new $(this,e).promise}function oe(n){var r=this;if(i(n))return new r(function(e,t){for(var o=n.length,i=0;i<o;i++)r.resolve(n[i]).then(e,t)});else return new r(function(e,t){return t(new TypeError("You must pass an array to race."))})}function ie(e){var t=new this(I);return B(t,e),t}function ne(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function re(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function ae(e){this[P]=Q();this._result=this._state=undefined;this._subscribers=[];if(I!==e){typeof e!=="function"&&ne();this instanceof ae?J(this,e):re()}}function se(){var e=undefined;if(typeof pe!=="undefined"){e=pe}else if(typeof self!=="undefined"){e=self}else{try{e=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}}var t=e.Promise;if(t){var o=null;try{o=Object.prototype.toString.call(t.resolve())}catch(e){}if(o==="[object Promise]"&&!t.cast){return}}e.Promise=ae}return $.prototype._enumerate=function(){for(var e=this.length,t=this._input,o=0;this._state===M&&o<e;o++)this._eachEntry(t[o],o)},$.prototype._eachEntry=function(t,e){var o,i,n=this._instanceConstructor,r=n.resolve;r===h?(o=L(t))===w&&t._state!==M?this._settledAt(t._state,e,t._result):"function"!=typeof o?(this._remaining--,this._result[e]=t):n===ae?(K(i=new n(I),t,o),this._willSettleAt(i,e)):this._willSettleAt(new n(function(e){return e(t)}),e):this._willSettleAt(r(t),e)},$.prototype._settledAt=function(e,t,o){var i=this.promise;i._state===M&&(this._remaining--,e===D?B(i,o):this._result[t]=o),0===this._remaining&&x(i,this._result)},$.prototype._willSettleAt=function(e,t){var o=this;Y(e,void 0,function(e){return o._settledAt(E,t,e)},function(e){return o._settledAt(D,t,e)})},ae.all=function(e){return new $(this,e).promise},ae.race=function(n){var r=this;return i(n)?new r(function(e,t){for(var o=n.length,i=0;i<o;i++)r.resolve(n[i]).then(e,t)}):new r(function(e,t){return t(new TypeError("You must pass an array to race."))})},ae.resolve=h,ae.reject=function(e){var t=new this(I);return B(t,e),t},ae._setScheduler=function(e){a=e},ae._setAsap=function(e){s=e},ae._asap=s,ae.prototype={constructor:ae,then:w,catch:function(e){return this.then(null,e)}},se(),ae.polyfill=se,ae.Promise=ae}()}).call(this,ge(24),ge(25))},function(e,t){var o,i,e=e.exports={};function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function a(t){if(o===setTimeout)return setTimeout(t,0);if((o===n||!o)&&setTimeout)return o=setTimeout,setTimeout(t,0);try{return o(t,0)}catch(e){try{return o.call(null,t,0)}catch(e){return o.call(this,t,0)}}}!function(){try{o="function"==typeof setTimeout?setTimeout:n}catch(e){o=n}try{i="function"==typeof clearTimeout?clearTimeout:r}catch(e){i=r}}();var s,c=[],p=!1,l=-1;function g(){p&&s&&(p=!1,s.length?c=s.concat(c):l=-1,c.length&&d())}function d(){if(!p){var e=a(g);p=!0;for(var t=c.length;t;){for(s=c,c=[];++l<t;)s&&s[l].run();l=-1,t=c.length}s=null,p=!1,function(t){if(i===clearTimeout)return clearTimeout(t);if((i===r||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(t);try{i(t)}catch(e){try{return i.call(null,t)}catch(e){return i.call(this,t)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function u(){}e.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var o=1;o<arguments.length;o++)t[o-1]=arguments[o];c.push(new f(e,t)),1!==c.length||p||a(d)},f.prototype.run=function(){this.fun.apply(null,this.array)},e.title="browser",e.browser=!0,e.env={},e.argv=[],e.version="",e.versions={},e.on=u,e.addListener=u,e.once=u,e.off=u,e.removeListener=u,e.removeAllListeners=u,e.emit=u,e.prependListener=u,e.prependOnceListener=u,e.listeners=function(e){return[]},e.binding=function(e){throw new Error("process.binding is not supported")},e.cwd=function(){return"/"},e.chdir=function(e){throw new Error("process.chdir is not supported")},e.umask=function(){return 0}},function(e,t){var o=function(){return this}();try{o=o||new Function("return this")()}catch(e){"object"==typeof window&&(o=window)}e.exports=o},function(e,t){},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=(n.isLocalStorageSupport=function(){return"localStorage"in window&&null!==window.localStorage},n.setLocalStorage=function(e,t){localStorage.setItem(e,t)},n.getLocalStorage=function(e){return localStorage.getItem(e)},n.removeLocalStorage=function(e){e&&localStorage.removeItem(e)},n);function n(){}t.LocalStorage=i},function(e,t,o){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var g=o(2),d=o(0),f=o(1),o=(u.getAdNetworkParam=function(e){void 0===e&&(e=!1),u.forceSyncAdNetwork=0;var t={},o="",i=g.Storage.getStorage("_ga"),n=g.Storage.getStorage("taboola global:user-id"),r=g.Storage.getStorage("OB-USER-TOKEN"),a=g.Storage.getStorage("mgMuidn"),s=g.Storage.getConfigLocal("gac"),c=g.Storage.getConfigLocal("tbc"),p=g.Storage.getConfigLocal("obc"),l=g.Storage.getConfigLocal("mgc");return n&&(t.tbc=n),r&&(t.obc=r),a&&(t.mgc=a),i&&1==d.Config.ga.syncCid&&(t.gac=i),(t.gac&&s!=i||n&&c!=n||r&&p!=r||a&&l!=a)&&(u.forceSyncAdNetwork=1),e?t:(0<Object.keys(t).length&&(o+="&"+f.Helper.objToParam(t)),o)},u.forceSyncAdNetwork=0,u);function u(){}t.AdNetwork=o}]);